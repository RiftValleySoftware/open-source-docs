<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BAOBAB: CO_Security_DB Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BAOBAB
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00327.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="a00324.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CO_Security_DB Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for CO_Security_DB:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00326.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Collaboration diagram for CO_Security_DB:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00325.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a865e6eb15a2c269d7d124be37c75e3a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a865e6eb15a2c269d7d124be37c75e3a4">__construct</a> ( $in_pdo_object, $in_access_object=NULL)</td></tr>
<tr class="separator:a865e6eb15a2c269d7d124be37c75e3a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a178b936fc390b03173e55cb28d0362f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a178b936fc390b03173e55cb28d0362f7">get_security_ids_for_id</a> ( $in_id)</td></tr>
<tr class="separator:a178b936fc390b03173e55cb28d0362f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3cd67075c3669e321c903e1b935d37a4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a3cd67075c3669e321c903e1b935d37a4">i_have_all_ids</a> ( $in_id)</td></tr>
<tr class="separator:a3cd67075c3669e321c903e1b935d37a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a89e505e3f61a75590a72969b16e97bea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a89e505e3f61a75590a72969b16e97bea">get_all_tokens</a> ()</td></tr>
<tr class="separator:a89e505e3f61a75590a72969b16e97bea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d73fc994a204fe7362e8ca77df1b344"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a5d73fc994a204fe7362e8ca77df1b344">get_initial_record_by_login_id</a> ( $in_login_id)</td></tr>
<tr class="separator:a5d73fc994a204fe7362e8ca77df1b344"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e2e3180a3be3bbe410fa3066572a8a0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a4e2e3180a3be3bbe410fa3066572a8a0">get_credentials_by_api_key</a> ( $in_api_key)</td></tr>
<tr class="separator:a4e2e3180a3be3bbe410fa3066572a8a0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7c6d41fc8b4b571f313be2c8b03b17d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#ab7c6d41fc8b4b571f313be2c8b03b17d">get_initial_record_by_id</a> ( $in_id)</td></tr>
<tr class="separator:ab7c6d41fc8b4b571f313be2c8b03b17d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab01692597b11329b0d63096b10e1f473"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#ab01692597b11329b0d63096b10e1f473">get_single_record_by_login_id</a> ( $in_login_id, $and_write=false)</td></tr>
<tr class="separator:ab01692597b11329b0d63096b10e1f473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af7f9180938518c8325b3d4ba52112e02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#af7f9180938518c8325b3d4ba52112e02">get_multiple_records_by_login_id</a> ( $in_login_id_array, $and_write=false)</td></tr>
<tr class="separator:af7f9180938518c8325b3d4ba52112e02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad75f2ed511a4eae172f9f2acd73f2de9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#ad75f2ed511a4eae172f9f2acd73f2de9">get_all_login_objects</a> ( $and_write=false)</td></tr>
<tr class="separator:ad75f2ed511a4eae172f9f2acd73f2de9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af39966b2bf3f43bc640b013ec5a472be"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#af39966b2bf3f43bc640b013ec5a472be">get_all_login_objects_with_access</a> ( $in_security_token, $and_write=false)</td></tr>
<tr class="separator:af39966b2bf3f43bc640b013ec5a472be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a744a82a9eac23300f9e55127859d4ead"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a744a82a9eac23300f9e55127859d4ead">count_all_login_objects_with_access</a> ($in_security_token)</td></tr>
<tr class="separator:a744a82a9eac23300f9e55127859d4ead"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8c467296937e33f1d083ae9b68141108"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00327.html#a8c467296937e33f1d083ae9b68141108">get_all_user_objects_with_access</a> ($in_security_token)</td></tr>
<tr class="separator:a8c467296937e33f1d083ae9b68141108"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_a00307"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_a00307')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="a00307.html">A_CO_DB</a></td></tr>
<tr class="memitem:a523e2f40174a0bca0fc873d6286b3ae9 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">_instantiate_record</a> ( $in_db_result)</td></tr>
<tr class="separator:a523e2f40174a0bca0fc873d6286b3ae9 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2396849660aa4ff018ab7509a4badeb5 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a> ( $in_sql, $in_parameters=NULL, $exec_only=false)</td></tr>
<tr class="separator:a2396849660aa4ff018ab7509a4badeb5 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b86c0613b521ffdbbd62f8928ad07f8 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a4b86c0613b521ffdbbd62f8928ad07f8">get_db_backup</a> ()</td></tr>
<tr class="separator:a4b86c0613b521ffdbbd62f8928ad07f8 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a707e7cfdbea32a3713320dbca46dac64 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a707e7cfdbea32a3713320dbca46dac64">get_access_class_by_id</a> ( $in_id)</td></tr>
<tr class="separator:a707e7cfdbea32a3713320dbca46dac64 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6baed01812f38acbc19df4b00f443b2 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#af6baed01812f38acbc19df4b00f443b2">can_i_see_this_record</a> ( $in_id)</td></tr>
<tr class="separator:af6baed01812f38acbc19df4b00f443b2 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af62a0d273b69bdf1f5012f88e619cec7 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#af62a0d273b69bdf1f5012f88e619cec7">get_single_raw_row_by_id</a> ( $in_id, $and_write=false)</td></tr>
<tr class="separator:af62a0d273b69bdf1f5012f88e619cec7 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a631d8d027d72c940a7cec689cbb4e568 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a631d8d027d72c940a7cec689cbb4e568">get_single_record_by_id</a> ( $in_id, $and_write=false)</td></tr>
<tr class="separator:a631d8d027d72c940a7cec689cbb4e568 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaca8bf49257aa5ade3c354ef76119fa4 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#aaca8bf49257aa5ade3c354ef76119fa4">get_multiple_records_by_id</a> ( $in_id_array, $and_write=false)</td></tr>
<tr class="separator:aaca8bf49257aa5ade3c354ef76119fa4 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ccca3e1b18f58a3d4a4ad6018f067b1 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a6ccca3e1b18f58a3d4a4ad6018f067b1">get_all_readable_records</a> ( $open_only=false, $in_this_id=NULL)</td></tr>
<tr class="separator:a6ccca3e1b18f58a3d4a4ad6018f067b1 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b39eabcd72a9d79267e51a5f2b16648 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a2b39eabcd72a9d79267e51a5f2b16648">get_all_writeable_records</a> ( $in_this_id=NULL)</td></tr>
<tr class="separator:a2b39eabcd72a9d79267e51a5f2b16648 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afacdcd578ddc750ca33d2418b54ab6b9 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#afacdcd578ddc750ca33d2418b54ab6b9">lock_record</a> ( $in_record_id)</td></tr>
<tr class="separator:afacdcd578ddc750ca33d2418b54ab6b9 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acac7eadbd231d714f3eed150eec35838 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#acac7eadbd231d714f3eed150eec35838">write_record</a> ( $params_associative_array)</td></tr>
<tr class="separator:acac7eadbd231d714f3eed150eec35838 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9794f1140b379f8d09c4265a089fcea0 inherit pub_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a9794f1140b379f8d09c4265a089fcea0">delete_record</a> ( $id)</td></tr>
<tr class="separator:a9794f1140b379f8d09c4265a089fcea0 inherit pub_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_attribs_a00307"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_a00307')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="a00307.html">A_CO_DB</a></td></tr>
<tr class="memitem:a83fd5822487fa194ff0b617d90d747fc inherit pub_attribs_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a83fd5822487fa194ff0b617d90d747fc">$access_object</a></td></tr>
<tr class="separator:a83fd5822487fa194ff0b617d90d747fc inherit pub_attribs_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad57301d61a2e22a1e3f843fc8d71b690 inherit pub_attribs_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#ad57301d61a2e22a1e3f843fc8d71b690">$class_description</a></td></tr>
<tr class="separator:ad57301d61a2e22a1e3f843fc8d71b690 inherit pub_attribs_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0195e339191feef610d1cdf09af95d84 inherit pub_attribs_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a0195e339191feef610d1cdf09af95d84">$error</a></td></tr>
<tr class="separator:a0195e339191feef610d1cdf09af95d84 inherit pub_attribs_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a256ce7dee5ecb0146b3974a762f02795 inherit pub_attribs_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a256ce7dee5ecb0146b3974a762f02795">$table_name</a></td></tr>
<tr class="separator:a256ce7dee5ecb0146b3974a762f02795 inherit pub_attribs_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_a00307"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_a00307')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="a00307.html">A_CO_DB</a></td></tr>
<tr class="memitem:a176b2c663fa7768e95e4fbe93281adc6 inherit pro_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a176b2c663fa7768e95e4fbe93281adc6">_create_read_security_predicate</a> ()</td></tr>
<tr class="separator:a176b2c663fa7768e95e4fbe93281adc6 inherit pro_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4bc3d416f085818935b32a814313202 inherit pro_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#ad4bc3d416f085818935b32a814313202">_create_write_security_predicate</a> ()</td></tr>
<tr class="separator:ad4bc3d416f085818935b32a814313202 inherit pro_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2356dbed1b38898d8c17bcd8eb405ef inherit pro_methods_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#ad2356dbed1b38898d8c17bcd8eb405ef">_create_security_predicate</a> ( $write=false)</td></tr>
<tr class="separator:ad2356dbed1b38898d8c17bcd8eb405ef inherit pro_methods_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_a00307"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_a00307')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="a00307.html">A_CO_DB</a></td></tr>
<tr class="memitem:a6ff3c27bf8ac1bf1370aeeb6b7835d3c inherit pro_attribs_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#a6ff3c27bf8ac1bf1370aeeb6b7835d3c">$_pdo_object</a></td></tr>
<tr class="separator:a6ff3c27bf8ac1bf1370aeeb6b7835d3c inherit pro_attribs_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aabeac345c845e7b7f481149b234641bb inherit pro_attribs_a00307"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00307.html#aabeac345c845e7b7f481149b234641bb">$_existing_record_objects</a></td></tr>
<tr class="separator:aabeac345c845e7b7f481149b234641bb inherit pro_attribs_a00307"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the base class for the security database. It assumes that it will have logins and Security ID table rows. </p>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00039">39</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a865e6eb15a2c269d7d124be37c75e3a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a865e6eb15a2c269d7d124be37c75e3a4">&#9670;&nbsp;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::__construct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_pdo_object</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_access_object</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the initializer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_pdo_object</td><td>The PDO instance for this database. </td></tr>
    <tr><td class="paramname">$in_access_object</td><td>The access object (if any) for this login. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="a00307.html#aca49137c323f216a6704087ad30b01f1">A_CO_DB</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00045">45</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;                                  {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;        parent::__construct($in_pdo_object, $in_access_object);</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;        </div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        $this-&gt;table_name = <span class="stringliteral">&#39;co_security_nodes&#39;</span>;    <span class="comment">// This is the name of the SQL table we will query.</span></div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        $this-&gt;class_description = <span class="stringliteral">&#39;The security database class.&#39;</span>;  <span class="comment">// A simple explanation of what this class is.</span></div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a744a82a9eac23300f9e55127859d4ead"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a744a82a9eac23300f9e55127859d4ead">&#9670;&nbsp;</a></span>count_all_login_objects_with_access()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::count_all_login_objects_with_access </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_security_token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>You give a security ID, and you will get a count of all login objects that have that token in their list (or are of that ID).</p>
<p>This is not restricted, and will count logins that we don't otherwise know about.</p>
<p>It does not count the "God" admin, which always has access.</p>
<dl class="section return"><dt>Returns</dt><dd>an integer, with the total count of logins with access to the ID. -1, if we are not allowed to see the token. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_security_token</td><td>An integer, with the requested security token. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00445">445</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;                                                          {</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        $ret = -1;</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        $in_security_token = intval($in_security_token);</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        <span class="comment">// No security predicate, but we do have to &quot;own&quot; the given token.</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;access_object-&gt;god_mode() &amp;&amp; $in_security_token) || in_array($in_security_token, $this-&gt;access_object-&gt;get_security_ids())) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE (login_id IS NOT NULL) AND (login_id&lt;&gt;\&#39;\&#39;) AND (id&lt;&gt;&#39;</span>.intval(CO_Config::god_mode_id()).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());    <span class="comment">// We just get everything.</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                $ret = 0;</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                </div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;                <span class="keywordflow">foreach</span> ($temp as $result) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    $id = intval($result[<span class="stringliteral">&#39;id&#39;</span>]);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                    $ids = explode(<span class="charliteral">&#39;,&#39;</span>, $result[<span class="stringliteral">&#39;ids&#39;</span>]);</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                    <span class="keywordflow">if</span> (isset($ids) &amp;&amp; is_array($ids) &amp;&amp; count($ids)) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                        $ids = array_map(<span class="stringliteral">&#39;trim&#39;</span>, $ids);</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                        $ids = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $ids);</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        array_push($ids, $id);</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                        $ids = array_unique($ids);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        <span class="keywordflow">foreach</span> ($ids as $single_id) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                            <span class="keywordflow">if</span> ($single_id == $in_security_token) {</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                                $ret += 1;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                            }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;                        }</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                    }</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                }</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;            }</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_a744a82a9eac23300f9e55127859d4ead_cgraph.svg" width="623" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad75f2ed511a4eae172f9f2acd73f2de9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad75f2ed511a4eae172f9f2acd73f2de9">&#9670;&nbsp;</a></span>get_all_login_objects()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_all_login_objects </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$and_write</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a security-vetted search for all login objects (visible to the current user).</p>
<dl class="section return"><dt>Returns</dt><dd>an array of instances. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$and_write</td><td>If true, then we only want ones we have write access to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00320">320</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                              {</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        $ret = Array();</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;        </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="comment">// Can only look for tokens we can see.</span></div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        $predicate = $this-&gt;<a class="code" href="a00307.html#ad2356dbed1b38898d8c17bcd8eb405ef">_create_security_predicate</a>($and_write);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;        </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;        <span class="keywordflow">if</span> ($predicate) {   <span class="comment">// If we got a predicate, then we AND it with the rest of the statement.</span></div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            $predicate .= <span class="stringliteral">&#39; AND &#39;</span>;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        }</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        </div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE &#39;</span>.$predicate. <span class="stringliteral">&#39;(login_id IS NOT NULL) AND (login_id&lt;&gt;\&#39;\&#39;)&#39;</span>;</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;        $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());    <span class="comment">// We just get everything.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;            <span class="keywordflow">foreach</span> ($temp as $result) {</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                $result = $this-&gt;<a class="code" href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">_instantiate_record</a>($result);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="keywordflow">if</span> ($result) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    array_push($ret, $result);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;            }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;        <span class="comment">// At this point, only managers (or the login object, itself) can see logins. God, too, of course.</span></div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        $my_id = $this-&gt;access_object-&gt;get_login_id();</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        $my_login_instance_is_manager = $this-&gt;access_object-&gt;god_mode() || ($this-&gt;access_object-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        $temp_ret = Array();</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">foreach</span> ($ret as $instance) {</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;            <span class="keywordflow">if</span> (($instance-&gt;id() == $my_id) || $my_login_instance_is_manager) {</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                array_push($temp_ret, $instance);</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;            }</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        }</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">return</span> $temp_ret;</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00162">A_CO_DB\_create_security_predicate()</a>, <a class="el" href="a00149_source.html#l00176">A_CO_DB\_instantiate_record()</a>, and <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_ad75f2ed511a4eae172f9f2acd73f2de9_cgraph.svg" width="619" height="192"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af39966b2bf3f43bc640b013ec5a472be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af39966b2bf3f43bc640b013ec5a472be">&#9670;&nbsp;</a></span>get_all_login_objects_with_access()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_all_login_objects_with_access </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_security_token</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$and_write</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>You give a security ID, and you will get all login objects that have that token in their list (or are of that ID).</p>
<p>This is restricted to use security vetting, so only logins visible to the current login.</p>
<dl class="section return"><dt>Returns</dt><dd>an array of instances. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_security_token</td><td>An integer, with the requested security token. </td></tr>
    <tr><td class="paramname">$and_write</td><td>If true, then we only want ones we have write access to. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00365">365</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                                                          {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        $ret = Array();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        $in_security_token = intval($in_security_token);</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        </div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        $access_ids = $this-&gt;access_object-&gt;get_security_ids();</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <span class="comment">// Can only look for tokens we can see.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">if</span> (($this-&gt;access_object-&gt;god_mode() &amp;&amp; $in_security_token) || in_array($in_security_token, $access_ids)) {</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            $predicate = $this-&gt;<a class="code" href="a00307.html#ad2356dbed1b38898d8c17bcd8eb405ef">_create_security_predicate</a>($and_write);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        </div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;            <span class="keywordflow">if</span> ($predicate) {   <span class="comment">// If we got a predicate, then we AND it with the rest of the statement.</span></div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                $predicate .= <span class="stringliteral">&#39; AND &#39;</span>;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            </div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;            $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE &#39;</span>.$predicate.<span class="stringliteral">&#39;(login_id IS NOT NULL) AND (login_id&lt;&gt;\&#39;\&#39;)&#39;</span>;</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;            $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());    <span class="comment">// We just get everything.</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;            <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                $ret = Array();</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                <span class="keywordflow">foreach</span> ($temp as $result) {</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                    $id = intval($result[<span class="stringliteral">&#39;id&#39;</span>]);</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    $id_array = Array($id);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                    $ids = explode(<span class="charliteral">&#39;,&#39;</span>, $result[<span class="stringliteral">&#39;ids&#39;</span>]);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                    <span class="keywordflow">if</span> (isset($ids) &amp;&amp; is_array($ids) &amp;&amp; count($ids)) {</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                        $ids = array_map(<span class="stringliteral">&#39;trim&#39;</span>, $ids);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                        $ids = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $ids);</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                        </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                        <span class="keywordflow">foreach</span> ($ids as $single_id) {</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                            array_push($id_array, $single_id);</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                        }</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                    }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;                    </div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                    $found = (2 &gt; $in_security_token);</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                    </div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                    <span class="keywordflow">if</span> (!$found) {</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                        <span class="keywordflow">foreach</span> ($id_array as $test_id) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                            <span class="keywordflow">if</span> ($test_id == $in_security_token) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                                $found = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                            }</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                    }</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                    </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    <span class="keywordflow">if</span> ($found) {</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                        $result = $this-&gt;<a class="code" href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">_instantiate_record</a>($result);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                        <span class="keywordflow">if</span> ($result) {</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                            array_push($ret, $result);</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                        }</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                    }</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                }</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;            }</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;        }</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;        </div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;        <span class="comment">// At this point, only managers (or the login object, itself) can see logins. God, too, of course.</span></div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;        $my_id = $this-&gt;access_object-&gt;get_login_id();</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;        $my_login_instance_is_manager = $this-&gt;access_object-&gt;god_mode() || ($this-&gt;access_object-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        $temp_ret = Array();</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;        </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;        <span class="keywordflow">foreach</span> ($ret as $instance) {</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            <span class="keywordflow">if</span> (($instance-&gt;id() == $my_id) || $my_login_instance_is_manager) {</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;                array_push($temp_ret, $instance);</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            }</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        }</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        </div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">return</span> $temp_ret;</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00162">A_CO_DB\_create_security_predicate()</a>, <a class="el" href="a00149_source.html#l00176">A_CO_DB\_instantiate_record()</a>, and <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_af39966b2bf3f43bc640b013ec5a472be_cgraph.svg" width="632" height="192"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a89e505e3f61a75590a72969b16e97bea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a89e505e3f61a75590a72969b16e97bea">&#9670;&nbsp;</a></span>get_all_tokens()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_all_tokens </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This returns the entire list of IDs in the Security Database.</p>
<p>It should only ever be called by the "God" admin.</p>
<dl class="section return"><dt>Returns</dt><dd>an array of integers, each, a security ID for the given login, and the first element is always the login ID itself. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00133">133</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                                     {</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        </div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;access_object-&gt;god_mode()) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            $sql = <span class="stringliteral">&#39;SELECT id FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE true ORDER BY id&#39;</span>;</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;            $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                $ret = [];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                <span class="keywordflow">foreach</span>($temp as $row) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                    $ret[] = intval($row[<span class="stringliteral">&#39;id&#39;</span>]);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                }</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;            }</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_a89e505e3f61a75590a72969b16e97bea_cgraph.svg" width="610" height="50"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8c467296937e33f1d083ae9b68141108"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8c467296937e33f1d083ae9b68141108">&#9670;&nbsp;</a></span>get_all_user_objects_with_access()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_all_user_objects_with_access </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_security_token</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>You give a security ID, and you will get an array, with the user objects, associated with login objects that have that token in their list (or are of that ID).</p>
<p>This is security restricted, and will not return users that we don't otherwise know about.</p>
<dl class="section return"><dt>Returns</dt><dd>an array, with the user objects, associated with login objects that have that token in their list (or are of that ID). </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_security_token</td><td>An integer, with the requested security token. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00488">488</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;                                                          {</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        $ret = array();</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        $in_security_token = intval($in_security_token);</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        $access_instance = <a class="code" href="a00307.html#a83fd5822487fa194ff0b617d90d747fc">$this-&gt;access_object</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        </div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="comment">// No security predicate, but we do have to &quot;own&quot; the given token.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;        <span class="keywordflow">if</span> (($access_instance-&gt;god_mode() &amp;&amp; $in_security_token) || in_array($in_security_token, $access_instance-&gt;get_security_ids())) {</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE (login_id IS NOT NULL) AND (login_id&lt;&gt;\&#39;\&#39;) AND (id&lt;&gt;&#39;</span>.intval(CO_Config::god_mode_id()).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());    <span class="comment">// We just get everything.</span></div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                <span class="keywordflow">foreach</span> ($temp as $result) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;                    $id = intval($result[<span class="stringliteral">&#39;id&#39;</span>]);</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                    $ids = explode(<span class="charliteral">&#39;,&#39;</span>, $result[<span class="stringliteral">&#39;ids&#39;</span>]);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;                    <span class="keywordflow">if</span> (isset($ids) &amp;&amp; is_array($ids) &amp;&amp; count($ids)) {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                        $ids = array_map(<span class="stringliteral">&#39;trim&#39;</span>, $ids);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                        $ids = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $ids);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                        array_push($ids, $id);</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                        $ids = array_unique($ids);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                        <span class="keywordflow">foreach</span> ($ids as $single_id) {</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                            <span class="keywordflow">if</span> ($single_id == $in_security_token) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;                                array_push($ret, $id);</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;                                <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;                            }</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;                        }</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;                    }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;                }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;            }</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160; </div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        $returnVar = array();</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <span class="keywordflow">foreach</span> ($ret as $id) {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;            $temp2 = $access_instance-&gt;get_user_from_login($id);</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;            <span class="keywordflow">if</span> (isset($temp2) &amp;&amp; $temp2) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                array_push($returnVar, $temp2);</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        <span class="keywordflow">return</span> $returnVar;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00053">A_CO_DB\$access_object</a>, and <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_a8c467296937e33f1d083ae9b68141108_cgraph.svg" width="620" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a4e2e3180a3be3bbe410fa3066572a8a0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e2e3180a3be3bbe410fa3066572a8a0">&#9670;&nbsp;</a></span>get_credentials_by_api_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_credentials_by_api_key </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_api_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a special "raw" function for getting login credentials from an API key.</p>
<dl class="section return"><dt>Returns</dt><dd>an associative array, with the login ID and hashed password that correspond to the API key. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_api_key</td><td>The API Key of the element. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00183">183</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                                                  {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        </div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE api_key LIKE ?&#39;</span>;</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        $params = Array(trim($in_api_key).<span class="stringliteral">&#39; - %&#39;</span>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, $params);</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;            $result = $this-&gt;<a class="code" href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">_instantiate_record</a>($temp[0]);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            <span class="keywordflow">if</span> (isset($result) &amp;&amp; ($result instanceof <a class="code" href="a00343.html">CO_Security_Login</a>) &amp;&amp; $result &amp;&amp; $result-&gt;is_api_key_valid($in_api_key)) {</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                $ret = Array(<span class="stringliteral">&#39;login_id&#39;</span> =&gt; $result-&gt;login_id, <span class="stringliteral">&#39;hashed_password&#39;</span> =&gt; $result-&gt;get_crypted_password());</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                <span class="keywordflow">if</span> ($result-&gt;id() == CO_Config::god_mode_id()) {</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    $ret[<span class="stringliteral">&#39;hashed_password&#39;</span>] = $in_api_key;</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                }</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            } elseif (isset($result) &amp;&amp; ($result instanceof <a class="code" href="a00343.html">CO_Security_Login</a>)) {</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                $this-&gt;error = $result-&gt;error;</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            }</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00176">A_CO_DB\_instantiate_record()</a>, and <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_a4e2e3180a3be3bbe410fa3066572a8a0_cgraph.svg" width="632" height="99"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab7c6d41fc8b4b571f313be2c8b03b17d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7c6d41fc8b4b571f313be2c8b03b17d">&#9670;&nbsp;</a></span>get_initial_record_by_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_initial_record_by_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a very "raw" function that should ONLY be called from a special check from the access class.</p>
<p>It has no security screening, as this is just for checking.</p>
<dl class="section return"><dt>Returns</dt><dd>a newly-instantiated record. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_id</td><td>The ID of the element. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00214">214</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                                              {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE id=&#39;</span>.intval($in_id);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        </div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;            $result = $this-&gt;<a class="code" href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">_instantiate_record</a>($temp[0]);</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;            <span class="keywordflow">if</span> ($result) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                $ret = $result;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;            }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        }</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        </div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00176">A_CO_DB\_instantiate_record()</a>, and <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_ab7c6d41fc8b4b571f313be2c8b03b17d_cgraph.svg" width="610" height="99"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5d73fc994a204fe7362e8ca77df1b344"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d73fc994a204fe7362e8ca77df1b344">&#9670;&nbsp;</a></span>get_initial_record_by_login_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_initial_record_by_login_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a very "raw" function that should ONLY be called from the access instance <a class="el" href="a00327.html#a865e6eb15a2c269d7d124be37c75e3a4">__construct()</a> method (or a special check from the access class).</p>
<p>It is designed to fetch the current login object from its string login ID, so we can extract the id.</p>
<p>It has no security screening, as it needs to be called before the security screens can be put into place.</p>
<dl class="section return"><dt>Returns</dt><dd>a newly-instantiated record. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID of the element. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00159">159</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                                                      {</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        </div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE login_id=?&#39;</span>;</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        $params = Array(trim($in_login_id));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, $params);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;            $result = $this-&gt;<a class="code" href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">_instantiate_record</a>($temp[0]);</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            <span class="keywordflow">if</span> ($result) {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;                $ret = $result;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            }</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00176">A_CO_DB\_instantiate_record()</a>, and <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_a5d73fc994a204fe7362e8ca77df1b344_cgraph.svg" width="643" height="99"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="af7f9180938518c8325b3d4ba52112e02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af7f9180938518c8325b3d4ba52112e02">&#9670;&nbsp;</a></span>get_multiple_records_by_login_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_multiple_records_by_login_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id_array</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$and_write</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a security-screened multiple login fetcher.</p>
<dl class="section return"><dt>Returns</dt><dd>an array of newly-instantiated objects. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00257">257</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                                                      {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        $predicate = $this-&gt;<a class="code" href="a00307.html#ad2356dbed1b38898d8c17bcd8eb405ef">_create_security_predicate</a>($and_write);</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">if</span> ($predicate) {   <span class="comment">// If we got a predicate, then we AND it with the rest of the statement.</span></div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;            $predicate .= <span class="stringliteral">&#39; AND &#39;</span>;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        $sql = <span class="stringliteral">&#39;SELECT * FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE &#39;</span>.$predicate. <span class="charliteral">&#39;(&#39;</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        $params = Array();</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">foreach</span> ($in_login_id_array as $id) {</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            <span class="keywordflow">if</span> (trim($id)) {                </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                <span class="keywordflow">if</span> (0 &lt; count($params)) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                    $sql .= <span class="stringliteral">&#39;) OR (&#39;</span>;</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                }</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                $sql.= <span class="stringliteral">&#39;login_id=?&#39;</span>;</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                array_push($params, $id);</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            }</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;        }</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        $sql  .= <span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">if</span> (0 &lt; count($params)) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, $params);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                $ret = Array();</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                <span class="keywordflow">foreach</span> ($temp as $result) {</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                    $result = $this-&gt;<a class="code" href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">_instantiate_record</a>($result);</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                    <span class="keywordflow">if</span> ($result) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                        array_push($ret, $result);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    }</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                }</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                usort($ret, <span class="keyword">function</span>($a, $b){<span class="keywordflow">return</span> ($a-&gt;id() &gt; $b-&gt;id());});</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;            }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="comment">// At this point, only managers (or the login object, itself) can see logins. God, too, of course.</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        $my_id = $this-&gt;access_object-&gt;get_login_id();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;        $my_login_instance_is_manager = $this-&gt;access_object-&gt;god_mode() || ($this-&gt;access_object-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>);</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        $temp_ret = Array();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        </div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">if</span> (isset($ret) &amp;&amp; is_array($ret) &amp;&amp; count($ret)) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;            <span class="keywordflow">foreach</span> ($ret as $instance) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                <span class="keywordflow">if</span> (($instance-&gt;id() == $my_id) || $my_login_instance_is_manager) {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    array_push($temp_ret, $instance);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                }</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;            }</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;        }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;        </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;        <span class="keywordflow">return</span> $temp_ret;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00162">A_CO_DB\_create_security_predicate()</a>, <a class="el" href="a00149_source.html#l00176">A_CO_DB\_instantiate_record()</a>, and <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00164_source.html#l00237">get_single_record_by_login_id()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_af7f9180938518c8325b3d4ba52112e02_cgraph.svg" width="623" height="192"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_af7f9180938518c8325b3d4ba52112e02_icgraph.svg" width="391" height="63"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a178b936fc390b03173e55cb28d0362f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a178b936fc390b03173e55cb28d0362f7">&#9670;&nbsp;</a></span>get_security_ids_for_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_security_ids_for_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This returns just the security IDs (including the item ID, itself) for the given ID.</p>
<p>This should only be called from the ID fetcher in the access class, as it does not do a security predicate.</p>
<dl class="section return"><dt>Returns</dt><dd>an array of integers, each, a security ID for the given login, and the first element is always the login ID itself. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_id</td><td>The integer ID of the row. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00063">63</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;                                              {</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        $sql = <span class="stringliteral">&#39;SELECT ids FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE (login_id IS NOT NULL) AND (id=&#39;</span>.intval($in_id).<span class="charliteral">&#39;)&#39;</span>;</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        $temp = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            $ret = explode(<span class="charliteral">&#39;,&#39;</span>, $temp[0][<span class="stringliteral">&#39;ids&#39;</span>]);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;            <span class="keywordflow">if</span> (isset($ret) &amp;&amp; is_array($ret) &amp;&amp; count($ret)) {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                array_unshift($ret, $in_id);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                $ret = array_unique(array_map(<span class="stringliteral">&#39;intval&#39;</span>, $ret));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                $ret_temp = Array();</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="keywordflow">foreach</span> ( $ret as $i) {</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                    <span class="keywordflow">if</span> (0 &lt; $i) {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                        array_push($ret_temp, $i);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                    }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                }</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                $ret = $ret_temp;</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            $ret = Array($in_id);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_a178b936fc390b03173e55cb28d0362f7_cgraph.svg" width="610" height="50"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab01692597b11329b0d63096b10e1f473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab01692597b11329b0d63096b10e1f473">&#9670;&nbsp;</a></span>get_single_record_by_login_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::get_single_record_by_login_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$and_write</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a security-screened method to fetch a single instance of a record object, based on its ID.</p>
<dl class="section return"><dt>Returns</dt><dd>a single, newly-instantiated object. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID of the requested login object. </td></tr>
    <tr><td class="paramname">$and_write</td><td>If this is true, then we need the item to be modifiable. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00237">237</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                                      {</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        </div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        $temp = $this-&gt;<a class="code" href="a00327.html#af7f9180938518c8325b3d4ba52112e02">get_multiple_records_by_login_id</a>(Array($in_login_id), $and_write);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        </div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">if</span> (isset($temp) &amp;&amp; $temp &amp;&amp; is_array($temp) &amp;&amp; count($temp) ) {</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            $ret = $temp[0];</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00164_source.html#l00257">get_multiple_records_by_login_id()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00327_ab01692597b11329b0d63096b10e1f473_cgraph.svg" width="100%" height="444"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a3cd67075c3669e321c903e1b935d37a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3cd67075c3669e321c903e1b935d37a4">&#9670;&nbsp;</a></span>i_have_all_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_DB::i_have_all_ids </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This method will check a given security record (indicated by its ID), and make sure that we have COMPLETE access to it. This means that we check ALL the ids, as well as the record's write (not read) token.</p>
<p>This is not "security-vetted," in order to make sure that we are looking at the complete record.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if we completely match. False, otherwise. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_id</td><td>This is the ID of the record to check. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00164_source.html#l00099">99</a> of file <a class="el" href="a00164_source.html">co_security_db.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                                      {</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        </div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">if</span> (intval($in_id)) {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;            $sql = <span class="stringliteral">&#39;SELECT write_security_id, ids FROM &#39;</span>.$this-&gt;table_name.<span class="stringliteral">&#39; WHERE id=&#39;</span>.intval($in_id);</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160; </div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;            $result = $this-&gt;<a class="code" href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">execute_query</a>($sql, Array());</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;            <span class="keywordflow">if</span> (isset($result) &amp;&amp; is_array($result) &amp;&amp; (1 == count($result))) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;                $access_ids = $this-&gt;access_object-&gt;get_security_ids();</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                $write_security_id = intval($result[0][<span class="stringliteral">&#39;write_security_id&#39;</span>]);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                $ids = (isset($result[0][<span class="stringliteral">&#39;ids&#39;</span>]) &amp;&amp; trim($result[0][<span class="stringliteral">&#39;ids&#39;</span>])) ? array_map(<span class="stringliteral">&#39;intval&#39;</span>, explode(<span class="charliteral">&#39;,&#39;</span>, trim($result[0][<span class="stringliteral">&#39;ids&#39;</span>]))) : [];</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                $ids[] = $write_security_id;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;                sort($ids);</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                sort($access_ids);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                $diff = array_diff($ids, $access_ids);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keywordflow">if</span> (is_array($diff) &amp;&amp; !count($diff)) { <span class="comment">// We only go true if there are no outliers. We have to have ALL of them.</span></div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    $ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                }</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            }</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00287">A_CO_DB\execute_query()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00327_a3cd67075c3669e321c903e1b935d37a4_cgraph.svg" width="630" height="50"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aa00307_html_a523e2f40174a0bca0fc873d6286b3ae9"><div class="ttname"><a href="a00307.html#a523e2f40174a0bca0fc873d6286b3ae9">A_CO_DB\_instantiate_record</a></div><div class="ttdeci">_instantiate_record( $in_db_result)</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00176">a_co_db.class.php:176</a></div></div>
<div class="ttc" id="aa00327_html_af7f9180938518c8325b3d4ba52112e02"><div class="ttname"><a href="a00327.html#af7f9180938518c8325b3d4ba52112e02">CO_Security_DB\get_multiple_records_by_login_id</a></div><div class="ttdeci">get_multiple_records_by_login_id( $in_login_id_array, $and_write=false)</div><div class="ttdef"><b>Definition:</b> <a href="a00164_source.html#l00257">co_security_db.class.php:257</a></div></div>
<div class="ttc" id="aa00307_html_a2396849660aa4ff018ab7509a4badeb5"><div class="ttname"><a href="a00307.html#a2396849660aa4ff018ab7509a4badeb5">A_CO_DB\execute_query</a></div><div class="ttdeci">execute_query( $in_sql, $in_parameters=NULL, $exec_only=false)</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00287">a_co_db.class.php:287</a></div></div>
<div class="ttc" id="aa00307_html_a83fd5822487fa194ff0b617d90d747fc"><div class="ttname"><a href="a00307.html#a83fd5822487fa194ff0b617d90d747fc">A_CO_DB\$access_object</a></div><div class="ttdeci">$access_object</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00053">a_co_db.class.php:53</a></div></div>
<div class="ttc" id="aa00235_html"><div class="ttname"><a href="a00235.html">CO_Login_Manager</a></div><div class="ttdef"><b>Definition:</b> <a href="a00107_source.html#l00033">co_login_manager.class.php:33</a></div></div>
<div class="ttc" id="aa00343_html"><div class="ttname"><a href="a00343.html">CO_Security_Login</a></div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00038">co_security_login.class.php:38</a></div></div>
<div class="ttc" id="aa00307_html_ad2356dbed1b38898d8c17bcd8eb405ef"><div class="ttname"><a href="a00307.html#ad2356dbed1b38898d8c17bcd8eb405ef">A_CO_DB\_create_security_predicate</a></div><div class="ttdeci">_create_security_predicate( $write=false)</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00162">a_co_db.class.php:162</a></div></div>
