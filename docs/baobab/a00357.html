<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BAOBAB: BASELINE</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BAOBAB
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00357.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">BASELINE </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><img src="BASALT-PLUGIN.png" alt="" class="inline" title="BASELINE PLUGIN"/></p>
<h1>BASALT BASELINE REST PLUGIN </h1>
<h2>Part of the BASALT Extension Layer, Which is Part of the BAOBAB Server, which is part of the Rift Valley Platform </h2>
<p><img src="BothLogos.png" alt="" class="inline" title="BAOBAB Server and The Rift Valley Platform"/></p>
<h1>INTRODUCTION </h1>
<p>The Baseline Plugin is a basic <a class="el" href="a00361.html">BASALT</a> <a href="https://restfulapi.net">REST</a> Plugin; part of the "standard" set.</p>
<p>You use this plugin to view and manage security tokens, list plugins, and do "non-denominational" searches on the BAOBAB server.</p>
<h1>USAGE </h1>
<p>This plugin is accessed by setting <code>"baseline"</code> as the Command in the <a href="https://restfulapi.net">REST</a> URI. There are a number of other aspects to the URI that will be explained: </p><pre class="fragment">{GET|POST} http[s]://{SERVER URL}/{json|xml|xsd|csv}/baseline/[{version|tokens|serverinfo|search[/?[search_radius= &amp; search_longitude= &amp; search_latitude=]|search_name=|search_tag0=|...|search_tag9=]|handlers/{IDS OF RESOURCES}]
</pre> <h2>SERVER URL </h2>
<pre class="fragment">http[s]://{SERVER URL}/
</pre><p> This is the base URL to the BAOBAB executable (which will eventually end up calling <code><a class="el" href="a00182.html">entrypoint.php</a></code>).</p>
<h2>RESPONSE TYPE </h2>
<p>This is the requested response type. It is required, and will generally be either <code>"json"</code> or <code>"xml"</code>, depending on what type of response you want.</p>
<p>It can also be <code>"xsd"</code>, but be aware that specifying this will ignore all other parameters, and simply return the XML for the plugin's schema.</p>
<p><code>"csv"</code> is a special case. It can only be specified for the "God Mode" <code>"backup"</code> command.</p>
<h2>TYPES OF RECORDS </h2>
<p>The plugin will return the following information:</p>
<ul>
<li><p class="startli">plugins</p>
<p class="startli">A simple list of available plugins (usually "baseline", "people", "places", and "things"). The response will be an array of string.</p>
</li>
<li><p class="startli">tokens</p>
<p class="startli">These are the actual security tokens visible to the currently logged-in user. The response will be an array of integers.</p>
</li>
<li><p class="startli">search/handler results</p>
<p class="startli">These are resource IDs of data objects that fit within the search criteria given (and are visible to the current user). These will be delivered in an assocative array of integer arrays. The top-level keys will indicate which plugin to use to examine the search results in the contained array of integers.</p>
</li>
<li><p class="startli">visibility results</p>
<p class="startli">These will be records with an ID (either a token or record ID), and lists of associated login IDs.</p>
</li>
<li><p class="startli">CSV Backup Data.</p>
<p class="startli">This will only be returned by the "God Mode" <code>"backup"</code> command. It is a large string of CSV data that represents all the data in both databases of the server. It will be in a format suitable for the <code>"bulk-loader"</code> command.</p>
</li>
</ul>
<h2>GET CALLS </h2>
<h2>No Command </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/{json|xml|xsd}/baseline
</pre><p> When called with <code>"xml"</code> or <code>"json"</code> as response types, this will simply return a list of the available plugins (usually "baseline," "people," "places," and "things").</p>
<p>When called with <code>"xsd"</code> as the response type, this will return the XML XSD document for this plugin. The schema is comprehensive, specifying all possible response types.</p>
<h2>version </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/{json|xml}/baseline/version
</pre><p> This will return a string, with a simple <a href="https://semver.org">semantic version</a> in it. The format will be: </p><pre class="fragment">MAJOR . MINOR . PATCH . BUILD
</pre><p> The <code>"BUILD"</code> number will be a 4-digit (leading zeroes) number, that has the following format, to indicate the stage of the server:</p>
<ul>
<li><code>0000</code>...<code>0999</code> This is a "development" release. It should be considered unstable and incomplete.</li>
<li><code>1000</code>...<code>1999</code> This is an "alpha" release. It should be considered stable, untested but complete.</li>
<li><code>2000</code>...<code>2999</code> This is a "beta" release. It should be considered stable, tested, complete, but not yet approved for final release. This is usually when non-developers are asked to test the system.</li>
<li><code>3000</code> or greater This is "release." It is considered tested, stable, and ready for release.</li>
</ul>
<h2>tokens </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/{json|xml}/baseline/tokens
</pre><p> This will return a simple array of integers, listing the security tokens available to the current logged-in user. Calling this when not logged in will result in a 403 (FORBIDDEN) error.</p>
<p>The login ID of the current user is always the first element of the array.</p>
<h2>search </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/{json|xml}/baseline/search[?[search_radius= &amp; search_longitude= &amp; search_latitude=]|search_name=|search_tag0=|...|search_tag9=]
</pre><p> This allows for specialization, using the URI search specification modifiers. Calling it without these modifiers will return the entire visible database.</p>
<p>The response is an associative array (the keys are the plugin names), containing simple arrays of integers. Each integer is the resource ID of a resource visible to the current user.</p>
<p>The available search specifiers are:</p>
<ul>
<li><code>search_name=</code></li>
<li><code>search_tag0=</code>, <code>search_tag1=</code>, <code>search_tag2=</code>, <code>search_tag3=</code>, <code>search_tag4=</code>, <code>search_tag5=</code>, <code>search_tag6=</code>, <code>search_tag7=</code>, <code>search_tag8=</code>, <code>search_tag9=</code></li>
</ul>
<p>These are all text specifiers, and should have the <code>=</code> followed by text. Leaving this blank specifies that you want only records that have that field blank. If you use more than one of the <code>search_tag</code> specifiers, they act in an AND fashion, with each one narrowing the search.</p>
<p>It should be noted that the various tags have different default functions, based upon the plugin. For example, in the <code>people</code> plugin, the first seven tags are used for names and connection to the user's login, and in the <code>places</code> plugin, the first eight tags are used for address information. In the <code>things</code> plugin, <code>tag0</code> is used to hold the key to look up the resource.</p>
<ul>
<li><code>search_radius=</code></li>
<li><code>search_longitude=</code></li>
<li><code>search_latitude=</code></li>
</ul>
<p>These must all be specified together in order for location searches to work. This can be used in conjunction with the above string searches.</p>
<p>Every resource type in the BAOBAB server can (but is not required to) have a location, denoted by a long/lat pair. If there is a location, it can be found, using this search. Resources without a long/lat pair will not be returned in location/radius searches.</p>
<p>These should all be followed by floating point numbers. <code>search_radius</code> is the <em>radius</em> (not diameter) of a circle, with the location specified by the <code>search_longitude</code> and <code>search_latitude</code> query arguments, which are a long/lat location (in degrees).</p>
<h2>serverinfo </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/{json|xml}/baseline/serverinfo
</pre><p> This will return a structure, containing various server settings and information, such as versions and enabled features.</p>
<p>It is only accessible if you are logged in with the "God" admin.</p>
<h2>handlers </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/{json|xml}/baseline/handlers/{LIST OF INTEGER IDS}
</pre><p> This command returns the ids provided, sorted into "handlers" (the plugins that handle those resources), in the same format as the <code>search</code> command. this is a good way to figure out how to interpret a resource ID.</p>
<h2>visibility </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/{json|xml}/baseline/visibility/[{SINGLE INTEGER}|token/{SINGLE INTEGER}]
</pre><p> This command allows you to get the login IDs that can see (and write) individual records (<code>SIMPLE INTEGER</code>), or that have a security token (<code>token/INTEGER</code>). You can only test one record or token at a time. Note that if you do not have access to some logins, their IDs will not be included in the response; meaning that the response may be incomplete. This is only available if logged in, and you must have the token, or have at least read access to the record indicated by the ID.</p>
<h2>backup </h2>
<pre class="fragment">{GET} http[s]://{SERVER URL}/csv/baseline/backup
</pre><p> This command can ONLY be called if you are logged in as the "God" admin (main admin). Calling this will return a large CSV string, with the entire contents of the server (both databases). The format will be the same as the <code>"bulk-loader"</code> command.</p>
<h2>POST CALLS </h2>
<h2>tokens </h2>
<p>The <code>"tokens"</code> command must be called when logged in as at least a manager.</p>
<p>Calling this with the <code>"tokens"</code> resource identifier will create one single new token, and will return it in the response. It will also add it to the current logged-in user login. </p><pre class="fragment">{POST} http[s]://{SERVER URL}/{json|xml}/baseline/tokens
</pre> <h2>bulk-loader </h2>
<p>The <code>"bulk-loader"</code> command requires that the login be the "God" admin, and that a variable in the configuration be set to allow upload. You must set the <code>$enable_bulk_upload</code> variable in the configuration file to <code>true</code> in order for this command to work. </p><pre class="fragment">{POST} http[s]://{SERVER URL}/{json|xml}/baseline/bulk-loader (You must also attach a CSV file as the multipart-form variable in "payload")
</pre><p> This is a way to upload bulk data to a BAOBAB server. It requires that a CSV file be attached in the POST multipart-form variable (labeled as "payload"). The format of this CSV file is exactly the same as that returned from the <code>"backup"</code> command: </p><pre class="fragment">id, api_key, login_id, access_class, last_access, read_security_id, write_security_id, object_name, access_class_context, owner, longitude, latitude, tag0, tag1, tag2, tag3, tag4, tag5, tag6, tag7, tag8, tag9, ids, payload
</pre><p> Depending on the class in the 'access_class' column, either the security or data database will be affected by a given row. Note that columns correspond to BOTH databases, so some columns will be ignored.</p>
<p>The columns are (empty columns should be filled with 'NULL'):</p>
<ul>
<li><p class="startli"><code>id</code></p>
<p class="startli">This is the integer ID of the resource. It will likely be changed to one relevant to the server, but it must be valid for the CSV file (for example, if this resource is a "child" of another resource, or is a login associated with a user, then they must be the same ID). Upon successful upload, the ID translation will be returned in the response.</p>
</li>
<li><p class="startli"><code>api_key</code></p>
<p class="startli">This is always NULL, and will be ignored, if supplied. It is a security database-only column.</p>
</li>
<li><p class="startli"><code>login_id</code></p>
<p class="startli">This is a security database string login ID, and should be set to NULL for data database resources. If there is a duplicate login ID on the system already, the Login ID will have ' - copy' appended to it when stored in the database. If there is still a duplicate, you will get a 500 (Internal Server Error) response.</p>
</li>
<li><p class="startli"><code>access_class</code></p>
<p class="startli">This is the class of the resource. This will also be used to determin which database the resource will be entered into.</p>
</li>
<li><p class="startli"><code>last_access</code></p>
<p class="startli">This is the date of the last access, it is a string, in <code>YYYY-MM-DD HH:MM:SS</code> format.</p>
</li>
<li><p class="startli"><code>read_security_id</code></p>
<p class="startli">This is the integer security token (in CSV ID terms) to be applied to the record's read permission. As noted in the <code>id</code> description, this will be translated by the upload process, and should be in the scope/context of the CSV file, not the destination server.</p>
</li>
<li><p class="startli"><code>write_security_id</code></p>
<p class="startli">This is the integer security token (in CSV ID terms) to be applied to the record's write permission. As noted in the <code>id</code> description, this will be translated by the upload process, and should be in the scope/context of the CSV file, not the destination server.</p>
</li>
<li><p class="startli"><code>object_name</code></p>
<p class="startli">This is a string, with the name of the object.</p>
</li>
<li><p class="startli"><code>access_class_context</code></p>
<p class="startli">This is a string, containing the serialized <code>comtext</code> property of the class instance for this record.</p>
</li>
<li><p class="startli"><code>owner</code></p>
<p class="startli">This is the integer ID of another record that is designated an "owner" of this record (data database only). As noted in the <code>id</code> description, this will be translated by the upload process, and should be in the scope/context of the CSV file, not the destination server.</p>
</li>
<li><p class="startli"><code>longitude</code></p>
<p class="startli">This is the data database floating-point longitude of the record. It is in degrees longitude.</p>
</li>
<li><p class="startli"><code>latitude</code></p>
<p class="startli">This is the data database floating-point latitude of the record. It is in degrees latitude.</p>
</li>
<li><p class="startli"><code>tag0</code> - <code>tag9</code></p>
<p class="startli">These are string values for tags (data database only).</p>
</li>
<li><p class="startli"><code>ids</code></p>
<p class="startli">This is a string, containing comma-delimited integers that represent security database tokens, to be applied to a login, as its "token pool." This is a security database column. As noted in the <code>id</code> description, this will be translated by the upload process, and should be in the scope/context of the CSV file, not the destination server.</p>
</li>
</ul>
<p>Strings that contain spaces or other whitespace, commas (,) or double-quotes (") should be enclosed in double-quotes.</p>
<p>Double-quotes (") and single-quotes (') should be escaped by doubling ("" or '').</p>
<p>If you put 'NULL' in as a column value, that will be translated to NULL in the database.</p>
<p><img src="RiftValleySimpleCorpLogo.png" alt="" class="inline" title="The Great Rift Valley Software Company"/></p>
<h1>LICENSE </h1>
<p>© Copyright 2018, The Great Rift Valley Software Company</p>
<p>LICENSE:</p>
<p>MIT License</p>
<p>Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:</p>
<p>The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</p>
<p>THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</p>
<p>The Great Rift Valley Software Company: <a href="https://riftvalleysoftware.com">https://riftvalleysoftware.com</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
