<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.14"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BAOBAB: /Users/cmarshall/webroot/baobab-test-harness/basalt/andisol/README.md Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BAOBAB
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.14 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00457.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">/Users/cmarshall/webroot/baobab-test-harness/basalt/andisol/README.md</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00457.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;\page ANDISOL ANDISOL</div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;</div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;![ANDISOL](images/ANDISOL.png)</div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;</div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;ANDISOL</div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;=======</div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;</div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;Part of the BAOBAB Server, which is part of the Rift Valley Platform</div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;--------------------------------------------------------------------</div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;![BAOBAB Server and The Rift Valley Platform](images/BothLogos.png)</div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;</div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;INTRODUCTION</div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;============</div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;ANDISOL is the &quot;public face&quot; of the lowest levels of the Rift Valley Platform. It encapsulates the model (database or server connections), and provides an object-based, functional model to the implementation layers.</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;</div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;![ANDISOL Diagram](images/ANDISOLLayers.png)</div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;</div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;SUBPROJECTS</div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;===========</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;ANDISOL is one of four main projects that comprise the foundation of the Rift Valley Platform.</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;\ref COBRA is the security administration toolbox for the Rift Valley Platform. It is only available to logged-in users that are &quot;manager&quot; users; capable of editing other users.</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;\ref CHAMELEON is the &quot;First Layer Abstraction&quot; from the data storage and retrieval. It implements a few higher-level capabilities, such as collections, users and places.</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;\ref BADGER is the &quot;First Layer Connection&quot; to the data storage subsystem. It uses [PHP PDO](http://php.net/manual/en/book.pdo.php) to abstract from the databases, and provide SQL-injection protection through the use of [PHP PDO Prepared Statements](http://php.net/manual/en/pdo.prepared-statements.php).</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;SECURITY</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;========</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;ANDISOL enforces a strict security regimen.</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;TWO DATABASES</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;-------------</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;The first layer of security is that secure login information, and security tokens (more on that later) are all stored in an isolated security database, while the main data items are stored in a data database.</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;LOGINS</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;------</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;There are logins, and one &quot;God&quot; login, that has full rights to anything. The &quot;God&quot; login is defined via the configuration file, as opposed to the database. The login is defined in the security database, but the assigned ID and password are in the config file. This means that even if someone gets into the database, they won&#39;t necessarily be able to get &quot;God&quot; permissions.</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;For &quot;regular&quot; logins, you have two login types:</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;- &quot;Basic&quot; logins, which can have security tokens assigned.</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;- &quot;Manager&quot; logins, which can create and edit other logins.</div><div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;Logins are generally &quot;twinned&quot; with &quot;user&quot; records in the data database. The login, itself, is kept in the security database, but additional user information is kept in the data database. This is not required. Logins (or users) can be standalone.</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;SECURITY TOKENS VS SECURITY LEVELS</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;----------------------------------</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;Security is done via integer &quot;tokens.&quot; Tokens are record IDs in the Security database. These can be login IDs, or standalone &quot;security token&quot; IDs. These integers are then referenced as read or write tokens for individual data items.</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;Security is not a &quot;level-based&quot; system. There are no &quot;higher&quot; tokens than other tokens; only &quot;different&quot; tokens. The only &quot;higher&quot; security level is the &quot;God&quot; login; which has access to all elements.</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;In order to have read or write access to a given item, a login has to have the token for that record&#39;s read and/or write permission.</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;There are three special tokens:</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;- -1, which means only the &quot;God&quot; login has access.</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;- 0, which means that anyone can read (non-logged-in visitors can never modify),</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;- 1, which means that any logged-in visitor can read (or write, if this is in the write slot).</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;Integers over 1 are security tokens, and define access on a fairly granular level.</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;Every record in the Rift Valley Platform dataset has two single tokens: read and write. Each login can have a list of tokens, in addition to the ID of the login (remember, all security database item IDs double as security tokens). If one of the tokens in a login matches the read or write token of a record, then the user has access to that record; either read or write (which includes read).</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;If a login does not have an access token for a record, then that record will not be accessible. It will be &quot;invisible&quot; to the user, at a very low level (won&#39;t even be accessed at the database level). The security tokens are enforced at the SQL level.</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;NO CASCADE</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;----------</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;Security tokens are &quot;atomic.&quot; They apply ONLY to a given record. They do not propagate to other records. For example, a collection record, which aggregates other records, can have a different (not &quot;lower&quot; -&quot;different&quot;) security level than some of the records that it aggregates.</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;&quot;Manager&quot; logins have a &quot;pool&quot; of tokens, and can only assign tokens to logins they manage from that &quot;pool.&quot; It is impossible for a manager to assign a security token that they, themselves, do not have. This should be remembered when creating other managers.</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;IMPLEMENTATION</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;==============</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;You use ANDISOL by instantiating an instance of the CO_Andisol class, after setting up a valid database configuration.</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;All interaction with the data layers needs to go through ANDISOL. You can interact with individual data objects, once they have been retrieved by ANDISOL.</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;LICENSE</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;=======</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;![The Great Rift Valley Software Company](images/RiftValleySimpleCorpLogo.png)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;Â© Copyright 2018, The Great Rift Valley Software Company</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;LICENSE:</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;MIT License</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;files (the &quot;Software&quot;), to deal in the Software without restriction, including without limitation the rights to use, copy,</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;Software is furnished to do so, subject to the following conditions:</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;THE SOFTWARE IS PROVIDED &quot;AS IS&quot;, WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT.</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;The Great Rift Valley Software Company: https://riftvalleysoftware.com</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;The Great Rift Valley Software Company: https://riftvalleysoftware.com</div></div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
