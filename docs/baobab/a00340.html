<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BAOBAB: CO_Security_Login Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BAOBAB
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search','.html');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00340.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-static-methods">Static Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="a00337.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CO_Security_Login Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for CO_Security_Login:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00339.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Collaboration diagram for CO_Security_Login:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00338.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aec38ba179d137a9ceaa02fd26e63ec8b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#aec38ba179d137a9ceaa02fd26e63ec8b">__construct</a> ( $in_db_object=NULL, $in_db_result=NULL, $in_login_id=NULL, $in_ids=NULL, $in_personal_ids=NULL)</td></tr>
<tr class="separator:aec38ba179d137a9ceaa02fd26e63ec8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76130de7d78c5feb68800f447dad441c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a76130de7d78c5feb68800f447dad441c">load_from_db</a> ($in_db_result)</td></tr>
<tr class="separator:a76130de7d78c5feb68800f447dad441c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a141bb2d1d8b67737119e0729c7d159"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a1a141bb2d1d8b67737119e0729c7d159">set_ids</a> ( $in_ids_array)</td></tr>
<tr class="separator:a1a141bb2d1d8b67737119e0729c7d159"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d11bc2cb9f23f091615dd5918dd2abb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a0d11bc2cb9f23f091615dd5918dd2abb">add_id</a> ( $in_id)</td></tr>
<tr class="separator:a0d11bc2cb9f23f091615dd5918dd2abb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a985325996e8392412a6782569b294176"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a985325996e8392412a6782569b294176">remove_id</a> ( $in_id)</td></tr>
<tr class="separator:a985325996e8392412a6782569b294176"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb0183db5cc330e1ef04ecb2f3b0beb4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#adb0183db5cc330e1ef04ecb2f3b0beb4">ids</a> ()</td></tr>
<tr class="separator:adb0183db5cc330e1ef04ecb2f3b0beb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a946d1fc04964f6f0b55c8cc018bf2c70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a946d1fc04964f6f0b55c8cc018bf2c70">user_can_edit_ids</a> ()</td></tr>
<tr class="separator:a946d1fc04964f6f0b55c8cc018bf2c70"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d18fed2a089c920e67802253be3cd68"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a8d18fed2a089c920e67802253be3cd68">set_personal_ids</a> ( $in_personal_ids=[])</td></tr>
<tr class="separator:a8d18fed2a089c920e67802253be3cd68"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ce61998ae204ed97737b0508848ea51"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a8ce61998ae204ed97737b0508848ea51">personal_ids</a> ()</td></tr>
<tr class="separator:a8ce61998ae204ed97737b0508848ea51"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a615bc63ad75ff08982eeb0c1a2da7243"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a615bc63ad75ff08982eeb0c1a2da7243">get_crypted_password</a> ( $in_password_to_crypt=NULL)</td></tr>
<tr class="separator:a615bc63ad75ff08982eeb0c1a2da7243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ec502fbeb3620816dbcf4868da637e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a5ec502fbeb3620816dbcf4868da637e8">is_login_valid</a> ( $in_login_id, $in_hashed_password=NULL, $in_raw_password=NULL, $in_dont_create_new_api_key=false)</td></tr>
<tr class="separator:a5ec502fbeb3620816dbcf4868da637e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03304936652c2c606c411c7c6a0f0c7f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a03304936652c2c606c411c7c6a0f0c7f">i_am_a_god</a> ()</td></tr>
<tr class="separator:a03304936652c2c606c411c7c6a0f0c7f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac538e52310a1c332914682a9c2ec8d2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#aac538e52310a1c332914682a9c2ec8d2">is_god</a> ()</td></tr>
<tr class="separator:aac538e52310a1c332914682a9c2ec8d2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1e788b0d2d7b7e807083d7333f2596e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#aa1e788b0d2d7b7e807083d7333f2596e">is_manager</a> ()</td></tr>
<tr class="separator:aa1e788b0d2d7b7e807083d7333f2596e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b65591a454789d226538ffce4ddc4e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a23b65591a454789d226538ffce4ddc4e">get_lang</a> ()</td></tr>
<tr class="separator:a23b65591a454789d226538ffce4ddc4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a061f896c69dc8a8dd3d9ee793b91ddc7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a061f896c69dc8a8dd3d9ee793b91ddc7">set_lang</a> ( $in_lang_id=NULL)</td></tr>
<tr class="separator:a061f896c69dc8a8dd3d9ee793b91ddc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30db2d11dd81390f5a671bcd32835544"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a30db2d11dd81390f5a671bcd32835544">get_user_object</a> ()</td></tr>
<tr class="separator:a30db2d11dd81390f5a671bcd32835544"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4f0c16cb8cf1e2151451bf4d5cb2238"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#ac4f0c16cb8cf1e2151451bf4d5cb2238">set_password_from_cleartext</a> ( $in_cleartext_password)</td></tr>
<tr class="separator:ac4f0c16cb8cf1e2151451bf4d5cb2238"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5c815210d09779bd16fc72ddd0fce59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#aa5c815210d09779bd16fc72ddd0fce59">is_api_key_valid</a> ( $in_api_key)</td></tr>
<tr class="separator:aa5c815210d09779bd16fc72ddd0fce59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecb158735e3a185c0857c44bf60f45f0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#aecb158735e3a185c0857c44bf60f45f0">get_api_key</a> ()</td></tr>
<tr class="separator:aecb158735e3a185c0857c44bf60f45f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad151766c8149ddda3b23f6f1ac4ac6c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#ad151766c8149ddda3b23f6f1ac4ac6c2">get_api_key_age_in_seconds</a> ()</td></tr>
<tr class="separator:ad151766c8149ddda3b23f6f1ac4ac6c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59e2e5be376349924698305603bfb51f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a59e2e5be376349924698305603bfb51f">clear_api_key</a> ()</td></tr>
<tr class="separator:a59e2e5be376349924698305603bfb51f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64b021e6e339891ad10a60c6a45e7b06"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a64b021e6e339891ad10a60c6a45e7b06">add_personal_token_from_current_login</a> ( $in_id)</td></tr>
<tr class="separator:a64b021e6e339891ad10a60c6a45e7b06"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6d1a5f62b1742349eb0cc8ba921fa5cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a6d1a5f62b1742349eb0cc8ba921fa5cf">remove_personal_token_from_this_login</a> ( $in_id)</td></tr>
<tr class="separator:a6d1a5f62b1742349eb0cc8ba921fa5cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac22dec6e0f6635875be19b61902c0a29"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#ac22dec6e0f6635875be19b61902c0a29">get_logins_that_have_any_of_my_ids</a> ()</td></tr>
<tr class="separator:ac22dec6e0f6635875be19b61902c0a29"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba256552040dd8af7196f0fea2a58609"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#aba256552040dd8af7196f0fea2a58609">user_can_write</a> ()</td></tr>
<tr class="separator:aba256552040dd8af7196f0fea2a58609"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae927630811dae37fddc34b16878c63fd"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#ae927630811dae37fddc34b16878c63fd">delete_from_db</a> ()</td></tr>
<tr class="separator:ae927630811dae37fddc34b16878c63fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_a00328"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_a00328')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="a00328.html">CO_Security_Node</a></td></tr>
<tr class="memitem:a29675e4b6a5fcb752a4d5f27fd2bc641 inherit pub_methods_a00328"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00328.html#a29675e4b6a5fcb752a4d5f27fd2bc641">__construct</a> ( $in_db_object=NULL, $in_db_result=NULL)</td></tr>
<tr class="separator:a29675e4b6a5fcb752a4d5f27fd2bc641 inherit pub_methods_a00328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_a00308"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_a00308')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="a00308.html">A_CO_DB_Table_Base</a></td></tr>
<tr class="memitem:a6d0115026b7324659dfda0c124de1475 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a6d0115026b7324659dfda0c124de1475">set_batch_mode</a> ()</td></tr>
<tr class="separator:a6d0115026b7324659dfda0c124de1475 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab976e4ab55890095fc60406326b5de80 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#ab976e4ab55890095fc60406326b5de80">clear_batch_mode</a> ()</td></tr>
<tr class="separator:ab976e4ab55890095fc60406326b5de80 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a78affe18a811930d4012fd265e95cdca inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a78affe18a811930d4012fd265e95cdca">id</a> ()</td></tr>
<tr class="separator:a78affe18a811930d4012fd265e95cdca inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a00a360580b830cc0147351a0ef1457 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a2a00a360580b830cc0147351a0ef1457">lock</a> ()</td></tr>
<tr class="separator:a2a00a360580b830cc0147351a0ef1457 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a210b15b6d0dc4b715ec0ad5c2bd16b8e inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a210b15b6d0dc4b715ec0ad5c2bd16b8e">locked</a> ()</td></tr>
<tr class="separator:a210b15b6d0dc4b715ec0ad5c2bd16b8e inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0806680f097aacc08c6b70f6a6b74aff inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a0806680f097aacc08c6b70f6a6b74aff">danger_will_robinson_danger_clear_id</a> ()</td></tr>
<tr class="separator:a0806680f097aacc08c6b70f6a6b74aff inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f9f0358c619f898fa092e02341bbcbb inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a1f9f0358c619f898fa092e02341bbcbb">user_can_read</a> ()</td></tr>
<tr class="separator:a1f9f0358c619f898fa092e02341bbcbb inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d4d1ab7910b9ccfdf8654d767e01d9b inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a3d4d1ab7910b9ccfdf8654d767e01d9b">set_read_security_id</a> ($in_new_id)</td></tr>
<tr class="separator:a3d4d1ab7910b9ccfdf8654d767e01d9b inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55eae92ef3e2f47689019e174f29daf1 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a55eae92ef3e2f47689019e174f29daf1">set_write_security_id</a> ($in_new_id)</td></tr>
<tr class="separator:a55eae92ef3e2f47689019e174f29daf1 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92a9b9a122e9471b82dd79432bf3c929 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a92a9b9a122e9471b82dd79432bf3c929">set_name</a> ($in_new_value)</td></tr>
<tr class="separator:a92a9b9a122e9471b82dd79432bf3c929 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7487697640051c6661b8cdca6f109959 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a7487697640051c6661b8cdca6f109959">update_db</a> ()</td></tr>
<tr class="separator:a7487697640051c6661b8cdca6f109959 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa5e1bc5570c817cfe3ddeb67003d4f45 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#aa5e1bc5570c817cfe3ddeb67003d4f45">reload_from_db</a> ()</td></tr>
<tr class="separator:aa5e1bc5570c817cfe3ddeb67003d4f45 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8780b40e55827b90bb441671faec2a05 inherit pub_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a> ()</td></tr>
<tr class="separator:a8780b40e55827b90bb441671faec2a05 inherit pub_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ac80d3225f3c0bd99a16088a62ed83c6c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#ac80d3225f3c0bd99a16088a62ed83c6c">$login_id</a></td></tr>
<tr class="separator:ac80d3225f3c0bd99a16088a62ed83c6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_a00308"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_a00308')"><img src="closed.png" alt="-"/>&#160;Public Attributes inherited from <a class="el" href="a00308.html">A_CO_DB_Table_Base</a></td></tr>
<tr class="memitem:a6ece5f2d9845de60db6bca357ee721da inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a6ece5f2d9845de60db6bca357ee721da">$class_description</a></td></tr>
<tr class="memdesc:a6ece5f2d9845de60db6bca357ee721da inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a description of the class (not the instance).  <a href="a00308.html#a6ece5f2d9845de60db6bca357ee721da">More...</a><br /></td></tr>
<tr class="separator:a6ece5f2d9845de60db6bca357ee721da inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f89ccdda3c66d9bc3f2bca4e70cdbd1 inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a1f89ccdda3c66d9bc3f2bca4e70cdbd1">$instance_description</a></td></tr>
<tr class="memdesc:a1f89ccdda3c66d9bc3f2bca4e70cdbd1 inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a description that describes the instance.  <a href="a00308.html#a1f89ccdda3c66d9bc3f2bca4e70cdbd1">More...</a><br /></td></tr>
<tr class="separator:a1f89ccdda3c66d9bc3f2bca4e70cdbd1 inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08ff6bd8e792bf85666926f5c82425dc inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a08ff6bd8e792bf85666926f5c82425dc">$last_access</a></td></tr>
<tr class="memdesc:a08ff6bd8e792bf85666926f5c82425dc inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a UNIX epoch date that describes the last modification. The default is UNIX Day Two (in case of UTC timezone issues).  <a href="a00308.html#a08ff6bd8e792bf85666926f5c82425dc">More...</a><br /></td></tr>
<tr class="separator:a08ff6bd8e792bf85666926f5c82425dc inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0869958bc9014dc95b392d7e3acd4f02 inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a0869958bc9014dc95b392d7e3acd4f02">$name</a></td></tr>
<tr class="memdesc:a0869958bc9014dc95b392d7e3acd4f02 inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the "object_name" string field.  <a href="a00308.html#a0869958bc9014dc95b392d7e3acd4f02">More...</a><br /></td></tr>
<tr class="separator:a0869958bc9014dc95b392d7e3acd4f02 inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af40f85e946497aae9f51bb5b779b9422 inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#af40f85e946497aae9f51bb5b779b9422">$read_security_id</a></td></tr>
<tr class="memdesc:af40f85e946497aae9f51bb5b779b9422 inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a single integer, defining the security ID required to view the record. If it is 0, then it is "open.".  <a href="a00308.html#af40f85e946497aae9f51bb5b779b9422">More...</a><br /></td></tr>
<tr class="separator:af40f85e946497aae9f51bb5b779b9422 inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa95295c52b1b366be03e590a2b4034fe inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#aa95295c52b1b366be03e590a2b4034fe">$write_security_id</a></td></tr>
<tr class="memdesc:aa95295c52b1b366be03e590a2b4034fe inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a single integer, defining the required security token to modify the record. If it is 0, then any logged-in user can modify.  <a href="a00308.html#aa95295c52b1b366be03e590a2b4034fe">More...</a><br /></td></tr>
<tr class="separator:aa95295c52b1b366be03e590a2b4034fe inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abfd26e45a152e94349e76304dda71302 inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#abfd26e45a152e94349e76304dda71302">$context</a></td></tr>
<tr class="memdesc:abfd26e45a152e94349e76304dda71302 inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a mixed associative array, containing fields for the object.  <a href="a00308.html#abfd26e45a152e94349e76304dda71302">More...</a><br /></td></tr>
<tr class="separator:abfd26e45a152e94349e76304dda71302 inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae747125d6be456403e269a62ebda6cfb inherit pub_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#ae747125d6be456403e269a62ebda6cfb">$error</a></td></tr>
<tr class="memdesc:ae747125d6be456403e269a62ebda6cfb inherit pub_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">If there is an error, it is contained here, in a <a class="el" href="a00356.html" title="This class provides a general error report, with file, method and error information.">LGV_Error</a> instance.  <a href="a00308.html#ae747125d6be456403e269a62ebda6cfb">More...</a><br /></td></tr>
<tr class="separator:ae747125d6be456403e269a62ebda6cfb inherit pub_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a5f57991e29b7602070594328676cfbb8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a5f57991e29b7602070594328676cfbb8">_set_up_api_key</a> ( $key_length)</td></tr>
<tr class="separator:a5f57991e29b7602070594328676cfbb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ad071273d740467a7a856420f83d7d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a9ad071273d740467a7a856420f83d7d8">_default_setup</a> ()</td></tr>
<tr class="separator:a9ad071273d740467a7a856420f83d7d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a6f7a3e0e32bf04f6e4c1d51ac92479"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a9a6f7a3e0e32bf04f6e4c1d51ac92479">_build_parameter_array</a> ()</td></tr>
<tr class="separator:a9a6f7a3e0e32bf04f6e4c1d51ac92479"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_methods_a00308"><td colspan="2" onclick="javascript:toggleInherit('pro_methods_a00308')"><img src="closed.png" alt="-"/>&#160;Protected Member Functions inherited from <a class="el" href="a00308.html">A_CO_DB_Table_Base</a></td></tr>
<tr class="memitem:afb32d1e32b8e1c1de2e008c9b88f7846 inherit pro_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#afb32d1e32b8e1c1de2e008c9b88f7846">_badger_serialize</a> ( $in_data)</td></tr>
<tr class="separator:afb32d1e32b8e1c1de2e008c9b88f7846 inherit pro_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aecf243af90c7a16d03c7e4630ccc4e8e inherit pro_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#aecf243af90c7a16d03c7e4630ccc4e8e">_badger_unserialize</a> ( $in_data)</td></tr>
<tr class="separator:aecf243af90c7a16d03c7e4630ccc4e8e inherit pro_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adda14b544e11934db3bf8130aeea0610 inherit pro_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#adda14b544e11934db3bf8130aeea0610">_write_to_db</a> ()</td></tr>
<tr class="separator:adda14b544e11934db3bf8130aeea0610 inherit pro_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d6e21b94d1abeca9e47be0d9c681e55 inherit pro_methods_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a5d6e21b94d1abeca9e47be0d9c681e55">_seppuku</a> ()</td></tr>
<tr class="separator:a5d6e21b94d1abeca9e47be0d9c681e55 inherit pro_methods_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-methods"></a>
Static Protected Member Functions</h2></td></tr>
<tr class="memitem:af0f76c1ede1e466e91739fada248c0f2"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#af0f76c1ede1e466e91739fada248c0f2">_random_str</a> ($length, $keyspace='0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ')</td></tr>
<tr class="separator:af0f76c1ede1e466e91739fada248c0f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a3dd81bbb72c853dfb7368c730b9175c2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a3dd81bbb72c853dfb7368c730b9175c2">$_api_key</a></td></tr>
<tr class="memdesc:a3dd81bbb72c853dfb7368c730b9175c2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is an API key for REST.  <a href="a00340.html#a3dd81bbb72c853dfb7368c730b9175c2">More...</a><br /></td></tr>
<tr class="separator:a3dd81bbb72c853dfb7368c730b9175c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a519e8486953a1264821df5ead2696850"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a519e8486953a1264821df5ead2696850">$_personal_ids</a></td></tr>
<tr class="memdesc:a519e8486953a1264821df5ead2696850"><td class="mdescLeft">&#160;</td><td class="mdescRight">These are personal IDs (special IDs, unique to the login).  <a href="a00340.html#a519e8486953a1264821df5ead2696850">More...</a><br /></td></tr>
<tr class="separator:a519e8486953a1264821df5ead2696850"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6313fc451a0d2feb3049e274bb90e471"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#a6313fc451a0d2feb3049e274bb90e471">$_ids</a></td></tr>
<tr class="memdesc:a6313fc451a0d2feb3049e274bb90e471"><td class="mdescLeft">&#160;</td><td class="mdescRight">These are security tokens, available to this ID.  <a href="a00340.html#a6313fc451a0d2feb3049e274bb90e471">More...</a><br /></td></tr>
<tr class="separator:a6313fc451a0d2feb3049e274bb90e471"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_a00328"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_a00328')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="a00328.html">CO_Security_Node</a></td></tr>
<tr class="memitem:a450e6650f37fb065f905dd93cf0dd865 inherit pro_attribs_a00328"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00328.html#a450e6650f37fb065f905dd93cf0dd865">$_ids</a></td></tr>
<tr class="separator:a450e6650f37fb065f905dd93cf0dd865 inherit pro_attribs_a00328"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pro_attribs_a00308"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_a00308')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="a00308.html">A_CO_DB_Table_Base</a></td></tr>
<tr class="memitem:a5d8900fe06daaf3bfc45fdec0e1cdb17 inherit pro_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a5d8900fe06daaf3bfc45fdec0e1cdb17">$_db_object</a></td></tr>
<tr class="memdesc:a5d8900fe06daaf3bfc45fdec0e1cdb17 inherit pro_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the actual database object that "owns" this instance. It should not be exposed beyond this class or subclasses, thereof.  <a href="a00308.html#a5d8900fe06daaf3bfc45fdec0e1cdb17">More...</a><br /></td></tr>
<tr class="separator:a5d8900fe06daaf3bfc45fdec0e1cdb17 inherit pro_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a80c6183fb5e62296058cc4310096e844 inherit pro_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#a80c6183fb5e62296058cc4310096e844">$_id</a></td></tr>
<tr class="memdesc:a80c6183fb5e62296058cc4310096e844 inherit pro_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the within-table unique ID of this record.  <a href="a00308.html#a80c6183fb5e62296058cc4310096e844">More...</a><br /></td></tr>
<tr class="separator:a80c6183fb5e62296058cc4310096e844 inherit pro_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7e6ee0cc95b7db97eac829d9dea4916 inherit pro_attribs_a00308"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00308.html#ae7e6ee0cc95b7db97eac829d9dea4916">$_batch_mode</a></td></tr>
<tr class="memdesc:ae7e6ee0cc95b7db97eac829d9dea4916 inherit pro_attribs_a00308"><td class="mdescLeft">&#160;</td><td class="mdescRight">If this is true, then the write_record call will not be made in update_db. It will be done when <a class="el" href="a00308.html#ab976e4ab55890095fc60406326b5de80">clear_batch_mode()</a> is called, instead.  <a href="a00308.html#ae7e6ee0cc95b7db97eac829d9dea4916">More...</a><br /></td></tr>
<tr class="separator:ae7e6ee0cc95b7db97eac829d9dea4916 inherit pro_attribs_a00308"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:abb9e732125cad8a02e6f95220328c942"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00340.html#abb9e732125cad8a02e6f95220328c942">$_override_access_class</a></td></tr>
<tr class="memdesc:abb9e732125cad8a02e6f95220328c942"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is a special "one-shot" semaphore telling the save to override the access class.  <a href="a00340.html#abb9e732125cad8a02e6f95220328c942">More...</a><br /></td></tr>
<tr class="separator:abb9e732125cad8a02e6f95220328c942"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This is the specializing class for the login ID record type. </p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00038">38</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aec38ba179d137a9ceaa02fd26e63ec8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec38ba179d137a9ceaa02fd26e63ec8b">&#9670;&nbsp;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::__construct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_db_object</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_db_result</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_ids</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_personal_ids</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Constructor </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_db_object</td><td>This is the database instance that "owns" this record. </td></tr>
    <tr><td class="paramname">$in_db_result</td><td>This is a database-format associative array that is used to initialize this instance. </td></tr>
    <tr><td class="paramname">$in_login_id</td><td>The login ID </td></tr>
    <tr><td class="paramname">$in_ids</td><td>An array of integers, representing the permissions this ID has. </td></tr>
    <tr><td class="paramname">$in_personal_ids</td><td>This is a preset array of integers, containing personal security IDs for the row. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00164">164</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                                  {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        $this-&gt;login_id = $in_login_id;</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;        $this-&gt;_override_access_class = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        parent::__construct($in_db_object, $in_db_result, $in_ids);</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        $this-&gt;class_description = <span class="stringliteral">&#39;This is a security class for individual logins.&#39;</span>;</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="comment">// If explicit IDs are passed in, then that overrides the DB.</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">if</span> (isset($in_ids) &amp;&amp; is_array($in_ids) &amp;&amp; count($in_ids)) {</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;            $in_db_result[<span class="stringliteral">&#39;ids&#39;</span>] = implode(<span class="charliteral">&#39;,&#39;</span>, $in_ids);</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;        }</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">if</span> (CO_Config::use_personal_tokens() &amp;&amp; isset($in_personal_ids) &amp;&amp; is_array($in_personal_ids) &amp;&amp; count($in_personal_ids)) {</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;            $in_db_result[<span class="stringliteral">&#39;personal_ids&#39;</span>] = implode(<span class="charliteral">&#39;,&#39;</span>, $in_ids);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        }</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        </div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;context)) {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;            $this-&gt;context = Array();</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        }</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">if</span> (!isset($this-&gt;context[<span class="stringliteral">&#39;lang&#39;</span>])) {</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            $this-&gt;context[<span class="stringliteral">&#39;lang&#39;</span>] = <a class="code" href="a00131.html#a7714b111b644017933931ec69a154102">CO_Config::$lang</a>;</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        }</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;            </div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        <span class="keywordflow">if</span> (isset($in_db_result[<span class="stringliteral">&#39;api_key&#39;</span>])) {</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;            $this-&gt;_api_key = $in_db_result[<span class="stringliteral">&#39;api_key&#39;</span>];</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        }</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        <span class="keywordflow">if</span> (intval($this-&gt;<span class="keywordtype">id</span>()) == intval(CO_Config::god_mode_id())) {</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;            <span class="comment">// God Mode is always forced to use the config password.</span></div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;            $this-&gt;instance_description = <span class="stringliteral">&#39;GOD MODE: &#39;</span>.(isset($this-&gt;name) &amp;&amp; $this-&gt;name ? <span class="stringliteral">&quot;$this-&gt;name (&quot;</span>.$this-&gt;login_id.<span class="stringliteral">&quot;)&quot;</span> : <span class="stringliteral">&quot;Unnamed Login Node (&quot;</span>.$this-&gt;login_id.<span class="stringliteral">&quot;)&quot;</span>);</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;            $this-&gt;instance_description = isset($this-&gt;name) &amp;&amp; $this-&gt;name ? <span class="stringliteral">&quot;$this-&gt;name (&quot;</span>.$this-&gt;login_id.<span class="stringliteral">&quot;)&quot;</span> : <span class="stringliteral">&quot;Unnamed Login Node (&quot;</span>.$this-&gt;login_id.<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        }</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        </div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        $access_object = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>();</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;        <span class="comment">// By now, we have enough read, so we know if cogito ergo sum, so we can see if we can look at the IDs.</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        <span class="keywordflow">if</span> (isset($access_object) &amp;&amp; ($access_object-&gt;god_mode() || ($access_object-&gt;get_login_id() == $this-&gt;_id))) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;            $this-&gt;_ids = Array($this-&gt;<span class="keywordtype">id</span>());</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">if</span> (isset($in_db_result[<span class="stringliteral">&#39;ids&#39;</span>]) &amp;&amp; $in_db_result[<span class="stringliteral">&#39;ids&#39;</span>]) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                $temp = $in_db_result[<span class="stringliteral">&#39;ids&#39;</span>];</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                <span class="keywordflow">if</span> (isset ($temp) &amp;&amp; $temp) {</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                    $tempAr = explode(<span class="charliteral">&#39;,&#39;</span>, $temp);</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    <span class="keywordflow">if</span> (is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                        $tempAr = array_unique(array_map(<span class="stringliteral">&#39;intval&#39;</span>, $tempAr));</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                        $tempAr = array_merge($this-&gt;_ids, $tempAr);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                        sort($tempAr);</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                        <span class="comment">// Our original login just gets all the IDs. However, subsequent access requires that only &quot;known&quot; IDs are read.</span></div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        <span class="keywordflow">if</span> (isset($tempAr) &amp;&amp; is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                            $access_ids = $access_object-&gt;get_security_ids();</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                            <span class="keywordflow">if</span> ($access_object-&gt;god_mode() || (isset($access_ids) &amp;&amp; is_array($access_ids) &amp;&amp; count($access_ids))) {</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                <span class="keywordflow">foreach</span>($tempAr as $id) {</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                    <span class="keywordflow">if</span> (($access_object-&gt;god_mode() || (in_array($id, $access_ids))) &amp;&amp; !in_array($id, $this-&gt;_ids)) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                        $this-&gt;_ids[] = $id;</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                    }</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                }</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                $this-&gt;_ids = $tempAr;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                            }</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                        }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    }</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                }</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            }</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160; </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            $this-&gt;_personal_ids = NULL;</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;            </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            <span class="keywordflow">if</span> (CO_Config::use_personal_tokens() &amp;&amp; isset($in_db_result[<span class="stringliteral">&#39;personal_ids&#39;</span>]) &amp;&amp; $in_db_result[<span class="stringliteral">&#39;personal_ids&#39;</span>]) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                $temp = $in_db_result[<span class="stringliteral">&#39;personal_ids&#39;</span>];</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                <span class="keywordflow">if</span> (isset ($temp) &amp;&amp; $temp) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                    $tempAr = explode(<span class="charliteral">&#39;,&#39;</span>, $temp);</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                    <span class="keywordflow">if</span> (is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                        $tempAr = array_unique(array_map(<span class="stringliteral">&#39;intval&#39;</span>, $tempAr));</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        sort($tempAr);</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        <span class="keywordflow">if</span> (isset($tempAr) &amp;&amp; is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                            $this-&gt;_personal_ids = $tempAr;</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                        }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                    }</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            }</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        }</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    }</div>
<div class="ttc" id="aa00131_html_a7714b111b644017933931ec69a154102"><div class="ttname"><a href="a00131.html#a7714b111b644017933931ec69a154102">$lang</a></div><div class="ttdeci">$lang</div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00031">co_user_collection.class.php:31</a></div></div>
<div class="ttc" id="aa00308_html_a8780b40e55827b90bb441671faec2a05"><div class="ttname"><a href="a00308.html#a8780b40e55827b90bb441671faec2a05">A_CO_DB_Table_Base\get_access_object</a></div><div class="ttdeci">get_access_object()</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00494">a_co_db_table_base.class.php:494</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00131_source.html#l00031">$lang</a>, and <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aec38ba179d137a9ceaa02fd26e63ec8b_cgraph.svg" width="356" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9a6f7a3e0e32bf04f6e4c1d51ac92479"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a6f7a3e0e32bf04f6e4c1d51ac92479">&#9670;&nbsp;</a></span>_build_parameter_array()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::_build_parameter_array </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This builds up the basic section of the instance database record. It should be overloaded, and the parent called before adding new fields.</p>
<p>This method overloads (and calls) the base class method.</p>
<dl class="section return"><dt>Returns</dt><dd>an associative array, in database record form. </dd></dl>

<p>Reimplemented from <a class="el" href="a00328.html#a92050b02b7a523a409a69148de4b1579">CO_Security_Node</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00110">110</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;                                                {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        $ret = parent::_build_parameter_array();</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        </div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (NULL == $this-&gt;_personal_ids) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;            $this-&gt;_personal_ids = [];</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;        $ret[<span class="stringliteral">&#39;api_key&#39;</span>] = <a class="code" href="a00340.html#a3dd81bbb72c853dfb7368c730b9175c2">$this-&gt;_api_key</a>;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        $ret[<span class="stringliteral">&#39;login_id&#39;</span>] = <a class="code" href="a00340.html#ac80d3225f3c0bd99a16088a62ed83c6c">$this-&gt;login_id</a>;</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        $personal_ids_as_string_array = Array();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">if</span> (CO_Config::use_personal_tokens()) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;            $personal_ids_as_int = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $this-&gt;_personal_ids);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;            sort($personal_ids_as_int);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;_personal_ids as $id) {</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                array_push($personal_ids_as_string_array, strval($id));</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            }</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160; </div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;            $personal_id_list_string = trim(implode(<span class="charliteral">&#39;,&#39;</span>, $personal_ids_as_string_array));</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            $ret[<span class="stringliteral">&#39;personal_ids&#39;</span>] = $personal_id_list_string ? $personal_id_list_string : NULL;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        }</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        $ids_as_int = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $this-&gt;_ids);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        sort($ids_as_int);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        $ids_as_string_array = Array();</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        <span class="keywordflow">foreach</span> ($this-&gt;_ids as $id) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            <span class="keywordflow">if</span> ($id != $this-&gt;<span class="keywordtype">id</span>() &amp;&amp; (isset($personal_ids_as_int) &amp;&amp; !in_array($id, $personal_ids_as_int))) {</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                array_push($ids_as_string_array, strval($id));</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;            } elseif ($id != $this-&gt;<span class="keywordtype">id</span>()) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                array_push($ids_as_string_array, strval($id));</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;            }</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        }</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        $id_list_string = trim(implode(<span class="charliteral">&#39;,&#39;</span>, $ids_as_string_array));</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        </div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        $ret[<span class="stringliteral">&#39;ids&#39;</span>] = $id_list_string ? $id_list_string : NULL;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;_override_access_class) {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;            $ret[<span class="stringliteral">&#39;access_class&#39;</span>] = <span class="stringliteral">&#39;CO_Security_ID&#39;</span>;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            $ret[<span class="stringliteral">&#39;object_name&#39;</span>] = NULL;</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            $ret[<span class="stringliteral">&#39;ids&#39;</span>] = NULL;</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            $this-&gt;context = NULL;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            $this-&gt;_override_access_class = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;        }</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_a3dd81bbb72c853dfb7368c730b9175c2"><div class="ttname"><a href="a00340.html#a3dd81bbb72c853dfb7368c730b9175c2">CO_Security_Login\$_api_key</a></div><div class="ttdeci">$_api_key</div><div class="ttdoc">This is an API key for REST.</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00040">co_security_login.class.php:40</a></div></div>
<div class="ttc" id="aa00340_html_ac80d3225f3c0bd99a16088a62ed83c6c"><div class="ttname"><a href="a00340.html#ac80d3225f3c0bd99a16088a62ed83c6c">CO_Security_Login\$login_id</a></div><div class="ttdeci">$login_id</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00044">co_security_login.class.php:44</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00040">$_api_key</a>, and <a class="el" href="a00173_source.html#l00044">$login_id</a>.</p>

</div>
</div>
<a id="a9ad071273d740467a7a856420f83d7d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ad071273d740467a7a856420f83d7d8">&#9670;&nbsp;</a></span>_default_setup()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::_default_setup </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is called to populate the object fields for this class with default values. These use the SQL table tags.</p>
<p>This should be subclassed, and the parent should be called before applying specific instance properties.</p>
<p>This method overloads (and calls) the base class method.</p>
<dl class="section return"><dt>Returns</dt><dd>An associative array, simulating a database read. </dd></dl>

<p>Reimplemented from <a class="el" href="a00328.html#a47450e98147d121997e00edc1bacf5d3">CO_Security_Node</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00091">91</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;                                        {</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;        $default_setup = parent::_default_setup();</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;        $default_setup[<span class="stringliteral">&#39;login_id&#39;</span>] = <a class="code" href="a00340.html#ac80d3225f3c0bd99a16088a62ed83c6c">$this-&gt;login_id</a>;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        $default_setup[<span class="stringliteral">&#39;object_name&#39;</span>] = <a class="code" href="a00340.html#ac80d3225f3c0bd99a16088a62ed83c6c">$this-&gt;login_id</a>;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        $default_setup[<span class="stringliteral">&#39;api_key&#39;</span>] = <a class="code" href="a00340.html#a3dd81bbb72c853dfb7368c730b9175c2">$this-&gt;_api_key</a>;</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;        $default_setup[<span class="stringliteral">&#39;personal_ids&#39;</span>] = (CO_Config::use_personal_tokens() &amp;&amp; (NULL != <a class="code" href="a00340.html#a519e8486953a1264821df5ead2696850">$this-&gt;_personal_ids</a>)) ? $this-&gt;_personal_ids : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        $default_setup[<span class="stringliteral">&#39;ids&#39;</span>] = (NULL != <a class="code" href="a00340.html#a6313fc451a0d2feb3049e274bb90e471">$this-&gt;_ids</a>) ? $this-&gt;_ids : <span class="stringliteral">&#39;&#39;</span>;</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        </div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;        <span class="keywordflow">return</span> $default_setup;</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_a519e8486953a1264821df5ead2696850"><div class="ttname"><a href="a00340.html#a519e8486953a1264821df5ead2696850">CO_Security_Login\$_personal_ids</a></div><div class="ttdeci">$_personal_ids</div><div class="ttdoc">These are personal IDs (special IDs, unique to the login).</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00041">co_security_login.class.php:41</a></div></div>
<div class="ttc" id="aa00340_html_a6313fc451a0d2feb3049e274bb90e471"><div class="ttname"><a href="a00340.html#a6313fc451a0d2feb3049e274bb90e471">CO_Security_Login\$_ids</a></div><div class="ttdeci">$_ids</div><div class="ttdoc">These are security tokens, available to this ID.</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00042">co_security_login.class.php:42</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00040">$_api_key</a>, <a class="el" href="a00173_source.html#l00042">$_ids</a>, <a class="el" href="a00173_source.html#l00041">$_personal_ids</a>, and <a class="el" href="a00173_source.html#l00044">$login_id</a>.</p>

</div>
</div>
<a id="af0f76c1ede1e466e91739fada248c0f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0f76c1ede1e466e91739fada248c0f2">&#9670;&nbsp;</a></span>_random_str()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static CO_Security_Login::_random_str </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$length</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$keyspace</em> = <code>'0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Generates a cryptographically secure string.</p>
<dl class="section return"><dt>Returns</dt><dd>a randome string. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00052">52</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        $pieces = [];</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;        $max = mb_strlen($keyspace, <span class="stringliteral">&#39;8bit&#39;</span>) - 1;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;        <span class="keywordflow">for</span> ($i = 0; $i &lt; $length; ++$i) {</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;            $pieces []= $keyspace[random_int(0, $max)];</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordflow">return</span> implode(<span class="stringliteral">&#39;&#39;</span>, $pieces);</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00066">_set_up_api_key()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_af0f76c1ede1e466e91739fada248c0f2_icgraph.svg" width="534" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5f57991e29b7602070594328676cfbb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f57991e29b7602070594328676cfbb8">&#9670;&nbsp;</a></span>_set_up_api_key()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::_set_up_api_key </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$key_length</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This sets up a new API key after the login has been successfully verified. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$key_length</td><td>The length (in bytes) of the key. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00066">66</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;                                          {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        $temp_api_key = <a class="code" href="a00340.html#af0f76c1ede1e466e91739fada248c0f2">self::_random_str</a>($key_length);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        $temp_api_key .= <span class="stringliteral">&#39; - &#39;</span>.strval(microtime(<span class="keyword">true</span>)); <span class="comment">// Add the current generation microtime, for key timeout.</span></div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="comment">// If we are taking the IP address into consideration, then we store that, as well.</span></div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <span class="keywordflow">if</span> (isset(CO_Config::$api_key_includes_ip_address) &amp;&amp; CO_Config::$api_key_includes_ip_address) {</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;            $temp_api_key .= <span class="stringliteral">&#39; - &#39;</span>.strtolower(strval($_SERVER[<span class="stringliteral">&#39;REMOTE_ADDR&#39;</span>]));</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        $this-&gt;_api_key = strval($temp_api_key);</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_af0f76c1ede1e466e91739fada248c0f2"><div class="ttname"><a href="a00340.html#af0f76c1ede1e466e91739fada248c0f2">CO_Security_Login\_random_str</a></div><div class="ttdeci">static _random_str($length, $keyspace='0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ')</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00052">co_security_login.class.php:52</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00052">_random_str()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00621">is_login_valid()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a5f57991e29b7602070594328676cfbb8_cgraph.svg" width="336" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a5f57991e29b7602070594328676cfbb8_icgraph.svg" width="347" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0d11bc2cb9f23f091615dd5918dd2abb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0d11bc2cb9f23f091615dd5918dd2abb">&#9670;&nbsp;</a></span>add_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::add_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a setter, allowing you to add an ID.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if successful. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_id</td><td>A single integer. The new ID to add. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00396">396</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                              {</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;        $in_id = intval($in_id);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00340.html#a946d1fc04964f6f0b55c8cc018bf2c70">user_can_edit_ids</a>() || ($this-&gt;_added_new_id == $in_id)) {</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;            $id_pool = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_security_ids(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;            </div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() || (isset($id_pool) &amp;&amp; is_array($id_pool) &amp;&amp; count($id_pool))) {</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;                <span class="comment">// We can add an ID to the user, as long as it is one we own. We don&#39;t have to have full access to all user IDs.</span></div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;                <span class="keywordflow">if</span> (($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() || (in_array($in_id, $id_pool)) || ($this-&gt;_added_new_id == $in_id)) &amp;&amp; ($in_id != $this-&gt;<span class="keywordtype">id</span>())) {</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                    <span class="keywordflow">if</span> (!isset($this-&gt;_ids) || !is_array($this-&gt;_ids) || !count($this-&gt;_ids)) {</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                        $this-&gt;_ids = Array(intval($in_id));</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;                        $this-&gt;_ids[] = $in_id;</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;                        $this-&gt;_ids = array_unique($this-&gt;_ids);</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;                    }</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                    sort($this-&gt;_ids);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;                    $ret = $this-&gt;<a class="code" href="a00308.html#a7487697640051c6661b8cdca6f109959">update_db</a>();</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;                    <span class="keywordflow">if</span> ($in_id != $this-&gt;<span class="keywordtype">id</span>()) {</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                        $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common::$db_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                                        <a class="code" href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang::$db_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                                        <a class="code" href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang::$db_error_desc_user_not_authorized</a>,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                                        __LINE__,</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;                                                        __FILE__,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                                        __METHOD__</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                                    );</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                    } <span class="keywordflow">else</span> {    <span class="comment">// If we tried to add our own ID, then we don&#39;t add it, but it&#39;s not an error.</span></div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;                        $ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;                    }</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                }</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;            }</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common::$db_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                                            <a class="code" href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang::$db_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;                                            <a class="code" href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang::$db_error_desc_user_not_authorized</a>,</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;                                            __LINE__,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;                                            __FILE__,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;                                            __METHOD__</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                                        );</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;        }</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        </div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
<div class="ttc" id="aa00308_html_a7487697640051c6661b8cdca6f109959"><div class="ttname"><a href="a00308.html#a7487697640051c6661b8cdca6f109959">A_CO_DB_Table_Base\update_db</a></div><div class="ttdeci">update_db()</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00460">a_co_db_table_base.class.php:460</a></div></div>
<div class="ttc" id="aa00340_html_a946d1fc04964f6f0b55c8cc018bf2c70"><div class="ttname"><a href="a00340.html#a946d1fc04964f6f0b55c8cc018bf2c70">CO_Security_Login\user_can_edit_ids</a></div><div class="ttdeci">user_can_edit_ids()</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00522">co_security_login.class.php:522</a></div></div>
<div class="ttc" id="aa00344_html_ab23b25f81da3f81c8e379e2b8d39ed21"><div class="ttname"><a href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common\$db_error_code_user_not_authorized</a></div><div class="ttdeci">static $db_error_code_user_not_authorized</div><div class="ttdef"><b>Definition:</b> <a href="a00367_source.html#l00051">common.inc.php:51</a></div></div>
<div class="ttc" id="aa00348_html_a0c76414ee625f67403ed2560dc5576b8"><div class="ttname"><a href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang\$db_error_name_user_not_authorized</a></div><div class="ttdeci">static $db_error_name_user_not_authorized</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00055">en.php:55</a></div></div>
<div class="ttc" id="aa00348_html_a1ccdf30da841532c591e5a3dd9a0651a"><div class="ttname"><a href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang\$db_error_desc_user_not_authorized</a></div><div class="ttdeci">static $db_error_desc_user_not_authorized</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00056">en.php:56</a></div></div>
<div class="ttc" id="aa00356_html"><div class="ttname"><a href="a00356.html">LGV_Error</a></div><div class="ttdoc">This class provides a general error report, with file, method and error information.</div><div class="ttdef"><b>Definition:</b> <a href="a00179_source.html#l00032">error.class.php:32</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00367_source.html#l00051">CO_Lang_Common\$db_error_code_user_not_authorized</a>, <a class="el" href="a00382_source.html#l00056">CO_Lang\$db_error_desc_user_not_authorized</a>, <a class="el" href="a00382_source.html#l00055">CO_Lang\$db_error_name_user_not_authorized</a>, <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>, <a class="el" href="a00149_source.html#l00460">A_CO_DB_Table_Base\update_db()</a>, and <a class="el" href="a00173_source.html#l00522">user_can_edit_ids()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a0d11bc2cb9f23f091615dd5918dd2abb_cgraph.svg" width="100%" height="495"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a64b021e6e339891ad10a60c6a45e7b06"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64b021e6e339891ad10a60c6a45e7b06">&#9670;&nbsp;</a></span>add_personal_token_from_current_login()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::add_personal_token_from_current_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This adds a personal token from the current logged-in ID's pool, to the regular ID pool of another ID.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the operation was successful. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_id</td><td>The ID (personal token) to be added. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00845">845</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                                                              {</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        $ret = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;add_personal_token_from_current_login($this-&gt;_id, $in_id);</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160; </div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;error) {</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            $this-&gt;error = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;error;</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            $this-&gt;<a class="code" href="a00308.html#aa5e1bc5570c817cfe3ddeb67003d4f45">reload_from_db</a>();</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;        }</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    }</div>
<div class="ttc" id="aa00308_html_aa5e1bc5570c817cfe3ddeb67003d4f45"><div class="ttname"><a href="a00308.html#aa5e1bc5570c817cfe3ddeb67003d4f45">A_CO_DB_Table_Base\reload_from_db</a></div><div class="ttdeci">reload_from_db()</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00479">a_co_db_table_base.class.php:479</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>, and <a class="el" href="a00149_source.html#l00479">A_CO_DB_Table_Base\reload_from_db()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a64b021e6e339891ad10a60c6a45e7b06_cgraph.svg" width="100%" height="405"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a59e2e5be376349924698305603bfb51f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59e2e5be376349924698305603bfb51f">&#9670;&nbsp;</a></span>clear_api_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::clear_api_key </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Removes the API Key.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the operation was successful (even if there was no previous key). </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00833">833</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                                    {</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        $this-&gt;_api_key = NULL;</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        </div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00308.html#a7487697640051c6661b8cdca6f109959">update_db</a>();</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00460">A_CO_DB_Table_Base\update_db()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a59e2e5be376349924698305603bfb51f_cgraph.svg" width="100%" height="430"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ae927630811dae37fddc34b16878c63fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae927630811dae37fddc34b16878c63fd">&#9670;&nbsp;</a></span>delete_from_db()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::delete_from_db </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We override this, because logins never die. They just become security placeholders.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the conversion was successful. </dd></dl>

<p>Reimplemented from <a class="el" href="a00308.html#a6fa77e9fd744981d4a9d7cac37ddf1bf">A_CO_DB_Table_Base</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00924">924</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;                                     {</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">id</span>() != CO_Config::god_mode_id()) {</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00340.html#aba256552040dd8af7196f0fea2a58609">user_can_write</a>()) {</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;                $user_object = $this-&gt;<a class="code" href="a00340.html#a30db2d11dd81390f5a671bcd32835544">get_user_object</a>();</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            </div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                <span class="keywordflow">if</span> (isset($user_object) &amp;&amp; ($user_object instanceof <a class="code" href="a00276.html">CO_User_Collection</a>)) {</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;                    $user_object-&gt;set_login(NULL);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                }</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;            </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;                $this-&gt;read_security_id = 0;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;                $this-&gt;write_security_id = -1;</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                $this-&gt;api_key = NULL;</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;                $this-&gt;context = NULL;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;                $this-&gt;name = NULL;</div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;                $this-&gt;login_id = NULL;</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                $this-&gt;_ids = Array();</div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                $this-&gt;_override_access_class = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                $ret = $this-&gt;<a class="code" href="a00308.html#adda14b544e11934db3bf8130aeea0610">_write_to_db</a>();</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;                <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            }</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#a179b17f25bfaeb7201ba815d8621544e">CO_Lang_Common::$login_error_code_attempt_to_delete_god</a>,</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;                                            <a class="code" href="a00348.html#a263c4158e158788853c18e0b2ae3c512">CO_Lang::$login_error_name_attempt_to_delete_god</a>,</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                                            <a class="code" href="a00348.html#a343f9339d29c64e191892e5da9d6c619">CO_Lang::$login_error_desc_attempt_to_delete_god</a></div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;                                        );</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        }</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    }</div>
<div class="ttc" id="aa00276_html"><div class="ttname"><a href="a00276.html">CO_User_Collection</a></div><div class="ttdef"><b>Definition:</b> <a href="a00131_source.html#l00068">co_user_collection.class.php:68</a></div></div>
<div class="ttc" id="aa00308_html_adda14b544e11934db3bf8130aeea0610"><div class="ttname"><a href="a00308.html#adda14b544e11934db3bf8130aeea0610">A_CO_DB_Table_Base\_write_to_db</a></div><div class="ttdeci">_write_to_db()</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00133">a_co_db_table_base.class.php:133</a></div></div>
<div class="ttc" id="aa00340_html_a30db2d11dd81390f5a671bcd32835544"><div class="ttname"><a href="a00340.html#a30db2d11dd81390f5a671bcd32835544">CO_Security_Login\get_user_object</a></div><div class="ttdeci">get_user_object()</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00715">co_security_login.class.php:715</a></div></div>
<div class="ttc" id="aa00340_html_aba256552040dd8af7196f0fea2a58609"><div class="ttname"><a href="a00340.html#aba256552040dd8af7196f0fea2a58609">CO_Security_Login\user_can_write</a></div><div class="ttdeci">user_can_write()</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00895">co_security_login.class.php:895</a></div></div>
<div class="ttc" id="aa00344_html_a179b17f25bfaeb7201ba815d8621544e"><div class="ttname"><a href="a00344.html#a179b17f25bfaeb7201ba815d8621544e">CO_Lang_Common\$login_error_code_attempt_to_delete_god</a></div><div class="ttdeci">static $login_error_code_attempt_to_delete_god</div><div class="ttdef"><b>Definition:</b> <a href="a00367_source.html#l00060">common.inc.php:60</a></div></div>
<div class="ttc" id="aa00348_html_a263c4158e158788853c18e0b2ae3c512"><div class="ttname"><a href="a00348.html#a263c4158e158788853c18e0b2ae3c512">CO_Lang\$login_error_name_attempt_to_delete_god</a></div><div class="ttdeci">static $login_error_name_attempt_to_delete_god</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00070">en.php:70</a></div></div>
<div class="ttc" id="aa00348_html_a343f9339d29c64e191892e5da9d6c619"><div class="ttname"><a href="a00348.html#a343f9339d29c64e191892e5da9d6c619">CO_Lang\$login_error_desc_attempt_to_delete_god</a></div><div class="ttdeci">static $login_error_desc_attempt_to_delete_god</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00071">en.php:71</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00367_source.html#l00060">CO_Lang_Common\$login_error_code_attempt_to_delete_god</a>, <a class="el" href="a00382_source.html#l00071">CO_Lang\$login_error_desc_attempt_to_delete_god</a>, <a class="el" href="a00382_source.html#l00070">CO_Lang\$login_error_name_attempt_to_delete_god</a>, <a class="el" href="a00149_source.html#l00133">A_CO_DB_Table_Base\_write_to_db()</a>, <a class="el" href="a00173_source.html#l00715">get_user_object()</a>, and <a class="el" href="a00173_source.html#l00895">user_can_write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_ae927630811dae37fddc34b16878c63fd_cgraph.svg" width="100%" height="478"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="aecb158735e3a185c0857c44bf60f45f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aecb158735e3a185c0857c44bf60f45f0">&#9670;&nbsp;</a></span>get_api_key()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::get_api_key </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>a string, with the API key, if the key is still valid. NULL, otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00769">769</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;                                  {</div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    </div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;_api_key) &amp;&amp; $this-&gt;_api_key) {</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;            $api_expl = explode(<span class="stringliteral">&#39; - &#39;</span>, trim($this-&gt;_api_key));</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            $my_ip = NULL;</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="comment">// God Mode gets a different timeout.</span></div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            $timeout = floatval($this-&gt;<a class="code" href="a00340.html#a03304936652c2c606c411c7c6a0f0c7f">i_am_a_god</a>() ? CO_Config::$god_session_timeout_in_seconds : CO_Config::$session_timeout_in_seconds);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="comment">// We first check to make sure that we are still within the time window. If not, then all bets are off.</span></div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            <span class="keywordflow">if</span> (isset($api_expl[1]) &amp;&amp; ((microtime(<span class="keyword">true</span>) - floatval($api_expl[1])) &lt;= $timeout)) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                <span class="keywordflow">if</span> (isset(CO_Config::$api_key_includes_ip_address) &amp;&amp; CO_Config::$api_key_includes_ip_address) {    <span class="comment">// See if we are also checking the IP address.</span></div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                    $my_ip = strtolower(strval($_SERVER[<span class="stringliteral">&#39;REMOTE_ADDR&#39;</span>]));</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;                    <span class="keywordflow">if</span> (isset($api_expl[2])) {</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;                        <span class="keywordflow">if</span> ($api_expl[2] == $my_ip) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                            $ret = $api_expl[0];</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ae8830e1780a165fdc775f5700251aab7">CO_Lang_Common::$login_error_code_api_key_invalid</a>,</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;                                                            <a class="code" href="a00348.html#ac0f5c1755c58292d1d0e2e3386e32057">CO_Lang::$login_error_name_api_key_invalid</a>,</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                                            <a class="code" href="a00348.html#af6e4bf8ab7f4ee4dfd1f52fb82276b4d">CO_Lang::$login_error_desc_api_key_invalid</a></div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;                                                        );</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;                        }</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;                        $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ae8830e1780a165fdc775f5700251aab7">CO_Lang_Common::$login_error_code_api_key_invalid</a>,</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;                                                        <a class="code" href="a00348.html#ac0f5c1755c58292d1d0e2e3386e32057">CO_Lang::$login_error_name_api_key_invalid</a>,</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;                                                        <a class="code" href="a00348.html#af6e4bf8ab7f4ee4dfd1f52fb82276b4d">CO_Lang::$login_error_desc_api_key_invalid</a></div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                                                    );</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                    $ret = $api_expl[0];</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;                }</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;            } elseif ($api_expl[0]) {</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ae8830e1780a165fdc775f5700251aab7">CO_Lang_Common::$login_error_code_api_key_invalid</a>,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                <a class="code" href="a00348.html#ac0f5c1755c58292d1d0e2e3386e32057">CO_Lang::$login_error_name_api_key_invalid</a>,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                <a class="code" href="a00348.html#af6e4bf8ab7f4ee4dfd1f52fb82276b4d">CO_Lang::$login_error_desc_api_key_invalid</a></div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;                                            );</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;            }</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;        }</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;        </div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_a03304936652c2c606c411c7c6a0f0c7f"><div class="ttname"><a href="a00340.html#a03304936652c2c606c411c7c6a0f0c7f">CO_Security_Login\i_am_a_god</a></div><div class="ttdeci">i_am_a_god()</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00667">co_security_login.class.php:667</a></div></div>
<div class="ttc" id="aa00344_html_ae8830e1780a165fdc775f5700251aab7"><div class="ttname"><a href="a00344.html#ae8830e1780a165fdc775f5700251aab7">CO_Lang_Common\$login_error_code_api_key_invalid</a></div><div class="ttdeci">static $login_error_code_api_key_invalid</div><div class="ttdef"><b>Definition:</b> <a href="a00367_source.html#l00057">common.inc.php:57</a></div></div>
<div class="ttc" id="aa00348_html_ac0f5c1755c58292d1d0e2e3386e32057"><div class="ttname"><a href="a00348.html#ac0f5c1755c58292d1d0e2e3386e32057">CO_Lang\$login_error_name_api_key_invalid</a></div><div class="ttdeci">static $login_error_name_api_key_invalid</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00065">en.php:65</a></div></div>
<div class="ttc" id="aa00348_html_af6e4bf8ab7f4ee4dfd1f52fb82276b4d"><div class="ttname"><a href="a00348.html#af6e4bf8ab7f4ee4dfd1f52fb82276b4d">CO_Lang\$login_error_desc_api_key_invalid</a></div><div class="ttdeci">static $login_error_desc_api_key_invalid</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00066">en.php:66</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00367_source.html#l00057">CO_Lang_Common\$login_error_code_api_key_invalid</a>, <a class="el" href="a00382_source.html#l00066">CO_Lang\$login_error_desc_api_key_invalid</a>, <a class="el" href="a00382_source.html#l00065">CO_Lang\$login_error_name_api_key_invalid</a>, and <a class="el" href="a00173_source.html#l00667">i_am_a_god()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00751">is_api_key_valid()</a>, and <a class="el" href="a00173_source.html#l00621">is_login_valid()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aecb158735e3a185c0857c44bf60f45f0_cgraph.svg" width="359" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aecb158735e3a185c0857c44bf60f45f0_icgraph.svg" width="366" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad151766c8149ddda3b23f6f1ac4ac6c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad151766c8149ddda3b23f6f1ac4ac6c2">&#9670;&nbsp;</a></span>get_api_key_age_in_seconds()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::get_api_key_age_in_seconds </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>an integer, with the number of seconds since the API key was created. -1 if there is no API key. This will return a value, even if the API key is present, but expired. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00816">816</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                                          {</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        $ret = -1;</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        </div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;_api_key) &amp;&amp; $this-&gt;_api_key) {</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;            list($api_key, $api_time) = explode(<span class="stringliteral">&#39; - &#39;</span>, trim($this-&gt;_api_key));</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;            $ret = ceil(microtime(<span class="keyword">true</span>) - floatval($api_time));</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;        }</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;        </div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a615bc63ad75ff08982eeb0c1a2da7243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a615bc63ad75ff08982eeb0c1a2da7243">&#9670;&nbsp;</a></span>get_crypted_password()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::get_crypted_password </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_password_to_crypt</em> = <code>NULL</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the crypted password, as a string. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_password_to_crypt</td><td>If this is not-NULL, then, instead of returning the instance's crypted PW, the given password is crypted and returned. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00601">601</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                          {</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;        $ret = $this-&gt;context[<span class="stringliteral">&#39;hashed_password&#39;</span>];</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        </div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="keywordflow">if</span> ($in_password_to_crypt) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            <span class="keywordflow">if</span> (strlen($in_password_to_crypt) &gt;= CO_Config::$min_pw_len) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                $ret = password_hash($in_password_to_crypt, PASSWORD_DEFAULT);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;            }</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;        }</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;        </div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00621">is_login_valid()</a>, and <a class="el" href="a00173_source.html#l00733">set_password_from_cleartext()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a615bc63ad75ff08982eeb0c1a2da7243_icgraph.svg" width="391" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a23b65591a454789d226538ffce4ddc4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b65591a454789d226538ffce4ddc4e">&#9670;&nbsp;</a></span>get_lang()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::get_lang </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>a string, with the language ID for this login. </dd></dl>

<p>Reimplemented from <a class="el" href="a00308.html#aa479fe1b6b6ea9ce5f8ee983896af3ed">A_CO_DB_Table_Base</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00691">691</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;                               {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;        <span class="keywordflow">return</span> $this-&gt;context[<span class="stringliteral">&#39;lang&#39;</span>];</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac22dec6e0f6635875be19b61902c0a29"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac22dec6e0f6635875be19b61902c0a29">&#9670;&nbsp;</a></span>get_logins_that_have_any_of_my_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::get_logins_that_have_any_of_my_ids </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This returns IDs that have our personal IDs.</p>
<dl class="section return"><dt>Returns</dt><dd>an associative array of arrays of integer, keyed by integer. The key is the ID of the login, and the value is an array of integer, with the IDs that match. NULL, if an error. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00885">885</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;                                                         {</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_logins_that_have_any_of_my_ids();</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_ac22dec6e0f6635875be19b61902c0a29_cgraph.svg" width="375" height="67"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a30db2d11dd81390f5a671bcd32835544"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30db2d11dd81390f5a671bcd32835544">&#9670;&nbsp;</a></span>get_user_object()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::get_user_object </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>The associated User object, if it exists. NULL, otherwise. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00715">715</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;                                      {</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;        $access_instance = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>();</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        </div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        <span class="comment">// If we have a user, we also clear the user from knowing about us.</span></div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <span class="keywordflow">if</span> ($access_instance &amp;&amp; method_exists($access_instance, <span class="stringliteral">&#39;get_user_from_login&#39;</span>)) {</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;            $ret = $access_instance-&gt;get_user_from_login($this-&gt;<span class="keywordtype">id</span>());</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        }</div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        </div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00924">delete_from_db()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a30db2d11dd81390f5a671bcd32835544_cgraph.svg" width="375" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a30db2d11dd81390f5a671bcd32835544_icgraph.svg" width="391" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a03304936652c2c606c411c7c6a0f0c7f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03304936652c2c606c411c7c6a0f0c7f">&#9670;&nbsp;</a></span>i_am_a_god()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::i_am_a_god </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true, if this object represents the database "God" object. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00667">667</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                                 {</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;        <span class="keywordflow">return</span> intval(CO_Config::god_mode_id()) == intval($this-&gt;<span class="keywordtype">id</span>());</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00769">get_api_key()</a>, and <a class="el" href="a00173_source.html#l00895">user_can_write()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a03304936652c2c606c411c7c6a0f0c7f_icgraph.svg" width="602" height="300"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="adb0183db5cc330e1ef04ecb2f3b0beb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb0183db5cc330e1ef04ecb2f3b0beb4">&#9670;&nbsp;</a></span>ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::ids </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This does a security vetting. If logged in as God, then all IDs are returned. Otherwise, only IDs that our login can see are returned, whether or not they are in the object.</p>
<dl class="section return"><dt>Returns</dt><dd>The current IDs. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00499">499</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;                          {</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode()) {</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="a00340.html#a6313fc451a0d2feb3049e274bb90e471">$this-&gt;_ids</a>;</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            $my_ids = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_security_ids();</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;            $ret = Array();</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            <span class="keywordflow">foreach</span> ($this-&gt;_ids as $id) {</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                <span class="keywordflow">if</span> (in_array($id, $my_ids)) {</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;                    array_push($ret, $id);</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;            }</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        }</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00042">$_ids</a>, and <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_adb0183db5cc330e1ef04ecb2f3b0beb4_cgraph.svg" width="374" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa5c815210d09779bd16fc72ddd0fce59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5c815210d09779bd16fc72ddd0fce59">&#9670;&nbsp;</a></span>is_api_key_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::is_api_key_valid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_api_key</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This tests a given API key against the stored value. It also checks time elapsed, to ensure that we are still within the login window.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the API key is valid, and we are still within the allotted timespan for the key. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_api_key</td><td>The API key that we're testing. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00751">751</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                                      {</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        $ret = ($this-&gt;<a class="code" href="a00340.html#aecb158735e3a185c0857c44bf60f45f0">get_api_key</a>() == $in_api_key);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;        </div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        <span class="keywordflow">if</span> ($ret &amp;&amp; !$this-&gt;error) {</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#a4c5d1729e945cf9d1b79358abdd4f203">CO_Lang_Common::$login_error_code_api_key_mismatch</a>,</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                                            <a class="code" href="a00348.html#ac6e48bfc874371be6152ec1f268374bc">CO_Lang::$login_error_name_api_key_mismatch</a>,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;                                            <a class="code" href="a00348.html#abb977f5a1f492f2fcea97a165f14cf5e">CO_Lang::$login_error_desc_api_key_mismatch</a></div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                                        );</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        }</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        </div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_aecb158735e3a185c0857c44bf60f45f0"><div class="ttname"><a href="a00340.html#aecb158735e3a185c0857c44bf60f45f0">CO_Security_Login\get_api_key</a></div><div class="ttdeci">get_api_key()</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00769">co_security_login.class.php:769</a></div></div>
<div class="ttc" id="aa00344_html_a4c5d1729e945cf9d1b79358abdd4f203"><div class="ttname"><a href="a00344.html#a4c5d1729e945cf9d1b79358abdd4f203">CO_Lang_Common\$login_error_code_api_key_mismatch</a></div><div class="ttdeci">static $login_error_code_api_key_mismatch</div><div class="ttdef"><b>Definition:</b> <a href="a00367_source.html#l00058">common.inc.php:58</a></div></div>
<div class="ttc" id="aa00348_html_abb977f5a1f492f2fcea97a165f14cf5e"><div class="ttname"><a href="a00348.html#abb977f5a1f492f2fcea97a165f14cf5e">CO_Lang\$login_error_desc_api_key_mismatch</a></div><div class="ttdeci">static $login_error_desc_api_key_mismatch</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00068">en.php:68</a></div></div>
<div class="ttc" id="aa00348_html_ac6e48bfc874371be6152ec1f268374bc"><div class="ttname"><a href="a00348.html#ac6e48bfc874371be6152ec1f268374bc">CO_Lang\$login_error_name_api_key_mismatch</a></div><div class="ttdeci">static $login_error_name_api_key_mismatch</div><div class="ttdef"><b>Definition:</b> <a href="a00382_source.html#l00067">en.php:67</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00367_source.html#l00058">CO_Lang_Common\$login_error_code_api_key_mismatch</a>, <a class="el" href="a00382_source.html#l00068">CO_Lang\$login_error_desc_api_key_mismatch</a>, <a class="el" href="a00382_source.html#l00067">CO_Lang\$login_error_name_api_key_mismatch</a>, and <a class="el" href="a00173_source.html#l00769">get_api_key()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aa5c815210d09779bd16fc72ddd0fce59_cgraph.svg" width="556" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aac538e52310a1c332914682a9c2ec8d2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac538e52310a1c332914682a9c2ec8d2">&#9670;&nbsp;</a></span>is_god()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::is_god </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true, if we are the "God" login. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00675">675</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                             {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00308.html#a78affe18a811930d4012fd265e95cdca">id</a>() == CO_Config::god_mode_id();</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    }</div>
<div class="ttc" id="aa00308_html_a78affe18a811930d4012fd265e95cdca"><div class="ttname"><a href="a00308.html#a78affe18a811930d4012fd265e95cdca">A_CO_DB_Table_Base\id</a></div><div class="ttdeci">id()</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00299">a_co_db_table_base.class.php:299</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00299">A_CO_DB_Table_Base\id()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00107_source.html#l00153">CO_Cobra\_convert_login()</a>, <a class="el" href="a00107_source.html#l00226">CO_Cobra\_create_new_login()</a>, and <a class="el" href="a00173_source.html#l00683">is_manager()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aac538e52310a1c332914682a9c2ec8d2_cgraph.svg" width="410" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aac538e52310a1c332914682a9c2ec8d2_icgraph.svg" width="622" height="170"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a5ec502fbeb3620816dbcf4868da637e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ec502fbeb3620816dbcf4868da637e8">&#9670;&nbsp;</a></span>is_login_valid()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::is_login_valid </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_hashed_password</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_raw_password</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_dont_create_new_api_key</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true, if the presented credentials are good. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID </td></tr>
    <tr><td class="paramname">$in_hashed_password</td><td>The password, crypt-hashed </td></tr>
    <tr><td class="paramname">$in_raw_password</td><td>The password, cleartext. </td></tr>
    <tr><td class="paramname">$in_dont_create_new_api_key</td><td>If true, then we don't create a new API key. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00621">621</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;                                      {</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        <span class="keywordflow">if</span> (isset($this-&gt;login_id) &amp;&amp; $this-&gt;login_id &amp;&amp; ($this-&gt;login_id == $in_login_id)) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            $api_key = $this-&gt;<a class="code" href="a00340.html#aecb158735e3a185c0857c44bf60f45f0">get_api_key</a>();</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<span class="keywordtype">id</span>() == CO_Config::god_mode_id()) {</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                <span class="keywordflow">if</span> ((<span class="stringliteral">&quot;&quot;</span> != $in_hashed_password) &amp;&amp; ($in_hashed_password == $api_key)) { <span class="comment">// We have a special provision that allows the God hashed password to use the API key.</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                    $ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;                } <span class="keywordflow">else</span> {    <span class="comment">// God mode uses the cleartext password in the config file.</span></div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                    <span class="keywordflow">if</span> ($in_raw_password &amp;&amp; !$in_dont_create_new_api_key &amp;&amp; isset(CO_Config::$block_logins_for_valid_api_key) &amp;&amp; CO_Config::$block_logins_for_valid_api_key &amp;&amp; $api_key) {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                        $ret = ($in_raw_password == CO_Config::god_mode_password());</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    }</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                }</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="comment">// The server can be set up to prevent users from logging in while another login is still active.</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                <span class="keywordflow">if</span> ($in_raw_password &amp;&amp; !$in_dont_create_new_api_key &amp;&amp; isset(CO_Config::$block_logins_for_valid_api_key) &amp;&amp; CO_Config::$block_logins_for_valid_api_key &amp;&amp; $api_key) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                } elseif (isset($this-&gt;context[<span class="stringliteral">&#39;hashed_password&#39;</span>]) &amp;&amp; $this-&gt;context[<span class="stringliteral">&#39;hashed_password&#39;</span>]) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    <span class="comment">// First, see if this is in the hashed password.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    <span class="keywordflow">if</span> ($in_hashed_password) {</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                        $ret = hash_equals($this-&gt;<a class="code" href="a00340.html#a615bc63ad75ff08982eeb0c1a2da7243">get_crypted_password</a>(), $in_hashed_password);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    } <span class="keywordflow">else</span> { <span class="comment">// If not, see if it&#39;s the raw password.</span></div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                        $ret = password_verify($in_raw_password, $this-&gt;<a class="code" href="a00340.html#a615bc63ad75ff08982eeb0c1a2da7243">get_crypted_password</a>());</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    }</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;            }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        }</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;        </div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;        <span class="comment">// Generate an API key. We can&#39;t save it yet, as we&#39;re probably not actually logged in.</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;        <span class="keywordflow">if</span> ($ret &amp;&amp; !$in_dont_create_new_api_key) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <span class="comment">// God mode gets a longer key. It&#39;s not actually more secure, but we can use that to determine different treatment, later on.</span></div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            $this-&gt;<a class="code" href="a00340.html#a5f57991e29b7602070594328676cfbb8">_set_up_api_key</a>($this-&gt;<span class="keywordtype">id</span>() == CO_Config::god_mode_id() ? 40 : 32);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        </div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_a5f57991e29b7602070594328676cfbb8"><div class="ttname"><a href="a00340.html#a5f57991e29b7602070594328676cfbb8">CO_Security_Login\_set_up_api_key</a></div><div class="ttdeci">_set_up_api_key( $key_length)</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00066">co_security_login.class.php:66</a></div></div>
<div class="ttc" id="aa00340_html_a615bc63ad75ff08982eeb0c1a2da7243"><div class="ttname"><a href="a00340.html#a615bc63ad75ff08982eeb0c1a2da7243">CO_Security_Login\get_crypted_password</a></div><div class="ttdeci">get_crypted_password( $in_password_to_crypt=NULL)</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00601">co_security_login.class.php:601</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00066">_set_up_api_key()</a>, <a class="el" href="a00173_source.html#l00769">get_api_key()</a>, and <a class="el" href="a00173_source.html#l00601">get_crypted_password()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a5ec502fbeb3620816dbcf4868da637e8_cgraph.svg" width="556" height="183"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aa1e788b0d2d7b7e807083d7333f2596e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1e788b0d2d7b7e807083d7333f2596e">&#9670;&nbsp;</a></span>is_manager()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::is_manager </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>false, as we are not a manager. </dd></dl>

<p>Reimplemented in <a class="el" href="a00232.html#ae09a379d9de4490470c33816adaf36cf">CO_Login_Manager</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00683">683</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                 {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00340.html#aac538e52310a1c332914682a9c2ec8d2">is_god</a>();</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_aac538e52310a1c332914682a9c2ec8d2"><div class="ttname"><a href="a00340.html#aac538e52310a1c332914682a9c2ec8d2">CO_Security_Login\is_god</a></div><div class="ttdeci">is_god()</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00675">co_security_login.class.php:675</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00675">is_god()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aa1e788b0d2d7b7e807083d7333f2596e_cgraph.svg" width="607" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a76130de7d78c5feb68800f447dad441c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76130de7d78c5feb68800f447dad441c">&#9670;&nbsp;</a></span>load_from_db()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::load_from_db </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_db_result</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function sets up this instance, according to the DB-formatted associative array passed in.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the instance was able to set itself up to the provided array. </dd></dl>

<p>Reimplemented from <a class="el" href="a00308.html#a91b894b2b9aa29d47c43e519f5ad0bf6">A_CO_DB_Table_Base</a>.</p>

<p>Reimplemented in <a class="el" href="a00232.html#a5f69d302a81a15698bf5d9f532cf3e4c">CO_Login_Manager</a>, and <a class="el" href="a00228.html#ad45cbb4365051410dbad8a1ca040d5de">CO_Cobra_Login</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00258">258</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                                                {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        $ret = parent::load_from_db($in_db_result);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        $this-&gt;_personal_ids = NULL;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        $this-&gt;_ids = Array($this-&gt;<span class="keywordtype">id</span>());</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        <span class="keywordflow">if</span> ($ret) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;context)) {</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                $this-&gt;context = Array();</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;            }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">if</span> (!isset($this-&gt;context[<span class="stringliteral">&#39;lang&#39;</span>])) {</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                $this-&gt;context[<span class="stringliteral">&#39;lang&#39;</span>] = <a class="code" href="a00131.html#a7714b111b644017933931ec69a154102">CO_Config::$lang</a>;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            }</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;            $this-&gt;class_description = <span class="stringliteral">&#39;This is a security class for individual logins.&#39;</span>;</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;            </div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            <span class="keywordflow">if</span> (isset($in_db_result[<span class="stringliteral">&#39;login_id&#39;</span>])) {</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                $this-&gt;login_id = $in_db_result[<span class="stringliteral">&#39;login_id&#39;</span>];</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                $this-&gt;instance_description = isset($this-&gt;name) &amp;&amp; $this-&gt;name ? <span class="stringliteral">&quot;$this-&gt;name (&quot;</span>.$this-&gt;login_id.<span class="stringliteral">&quot;)&quot;</span> : <span class="stringliteral">&quot;Unnamed Login Node (&quot;</span>.$this-&gt;login_id.<span class="stringliteral">&quot;)&quot;</span>;</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;            }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;            </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            <span class="keywordflow">if</span> (isset($in_db_result[<span class="stringliteral">&#39;api_key&#39;</span>])) {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                $this-&gt;_api_key = $in_db_result[<span class="stringliteral">&#39;api_key&#39;</span>];</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            }</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">if</span> (isset($in_db_result[<span class="stringliteral">&#39;ids&#39;</span>]) &amp;&amp; $in_db_result[<span class="stringliteral">&#39;ids&#39;</span>]) {</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;_db_object) {</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                    <span class="keywordflow">if</span> (isset($in_db_result[<span class="stringliteral">&#39;ids&#39;</span>]) &amp;&amp; $in_db_result[<span class="stringliteral">&#39;ids&#39;</span>]) {</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                        $temp = $in_db_result[<span class="stringliteral">&#39;ids&#39;</span>];</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                        <span class="keywordflow">if</span> (isset ($temp) &amp;&amp; $temp) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                            $tempAr = explode(<span class="charliteral">&#39;,&#39;</span>, $temp);</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                            <span class="keywordflow">if</span> (is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                $tempAr = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $tempAr);</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                sort($tempAr);</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                $tempAr = array_unique(array_merge($this-&gt;_ids, $tempAr));</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                <span class="keywordflow">if</span> (isset($tempAr) &amp;&amp; is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                                    $this-&gt;_ids = $tempAr;</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                }</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                            }</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                        }</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            }</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                  </div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;            <span class="keywordflow">if</span> (CO_Config::use_personal_tokens() &amp;&amp; isset($in_db_result[<span class="stringliteral">&#39;personal_ids&#39;</span>]) || isset($in_db_result[<span class="stringliteral">&#39;personal_ids&#39;</span>])) {</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                $temp = $in_db_result[<span class="stringliteral">&#39;personal_ids&#39;</span>];</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                <span class="keywordflow">if</span> (isset ($temp) &amp;&amp; $temp) {</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    $tempAr = explode(<span class="charliteral">&#39;,&#39;</span>, $temp);</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <span class="keywordflow">if</span> (is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                        $tempAr = array_unique(array_map(<span class="stringliteral">&#39;intval&#39;</span>, $tempAr));</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                        sort($tempAr);</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                        <span class="keywordflow">if</span> (isset($tempAr) &amp;&amp; is_array($tempAr) &amp;&amp; count($tempAr)) {</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                            $this-&gt;_personal_ids = $tempAr;</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                        }</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    }</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                }</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        }</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;        </div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00131_source.html#l00031">$lang</a>.</p>

</div>
</div>
<a id="a8ce61998ae204ed97737b0508848ea51"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ce61998ae204ed97737b0508848ea51">&#9670;&nbsp;</a></span>personal_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::personal_ids </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This does a security vetting. If logged in as God, then all IDs are returned. Otherwise, only IDs that our login can see are returned, whether or not they are in the object.</p>
<dl class="section return"><dt>Returns</dt><dd>The current personal IDs. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00576">576</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                                   {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="keywordflow">if</span> (!CO_Config::use_personal_tokens()) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;            <span class="keywordflow">return</span> [];</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        }</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;        </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode()) {</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="a00340.html#a519e8486953a1264821df5ead2696850">$this-&gt;_personal_ids</a>;</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;            $my_ids = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_security_ids();</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            $ret = [];</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;            <span class="keywordflow">if</span> (isset($this-&gt;_personal_ids) &amp;&amp; is_array($this-&gt;_personal_ids) &amp;&amp; count($this-&gt;_personal_ids)) {</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                <span class="keywordflow">foreach</span> ($this-&gt;_personal_ids as $id) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                    <span class="keywordflow">if</span> (in_array($id, $my_ids)) {</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                        array_push($ret, $id);</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                    }</div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                }</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;            }</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        }</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00041">$_personal_ids</a>, and <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a8ce61998ae204ed97737b0508848ea51_cgraph.svg" width="430" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a985325996e8392412a6782569b294176"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a985325996e8392412a6782569b294176">&#9670;&nbsp;</a></span>remove_id()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::remove_id </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This allows you to remove a single ID. We can remove one of our IDs from a user that may have other IDs.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if successful. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_id</td><td>A single integer. The ID to remove. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00448">448</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;                              {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        </div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00340.html#a946d1fc04964f6f0b55c8cc018bf2c70">user_can_edit_ids</a>()) {</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;            $id_pool = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_security_ids();</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;            </div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() || (isset($id_pool) &amp;&amp; is_array($id_pool) &amp;&amp; count($id_pool) &amp;&amp; in_array($in_id, $id_pool))) {</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                <span class="keywordflow">if</span> (isset($this-&gt;_ids) &amp;&amp; is_array($this-&gt;_ids) &amp;&amp; count($this-&gt;_ids) &amp;&amp; $this-&gt;<a class="code" href="a00340.html#a946d1fc04964f6f0b55c8cc018bf2c70">user_can_edit_ids</a>()) {</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;                    $new_array = Array();</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;            </div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;                    <span class="keywordflow">foreach</span>($this-&gt;_ids as $id) {</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;                        <span class="keywordflow">if</span> ($id != $in_id) {</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                            array_push($new_array, $id);</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                            $ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                        }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                </div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;                        <span class="keywordflow">if</span> ($ret) {</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                            $ret = $this-&gt;<a class="code" href="a00340.html#a1a141bb2d1d8b67737119e0729c7d159">set_ids</a>($new_array);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;                        }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;                    }</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                }</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;                $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common::$db_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                                <a class="code" href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang::$db_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                                                <a class="code" href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang::$db_error_desc_user_not_authorized</a>,</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                                __LINE__,</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;                                                __FILE__,</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;                                                __METHOD__</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;                                            );</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            }</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common::$db_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;                                            <a class="code" href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang::$db_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;                                            <a class="code" href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang::$db_error_desc_user_not_authorized</a>,</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;                                            __LINE__,</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                            __FILE__,</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;                                            __METHOD__</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;                                        );</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        }</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        </div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    }</div>
<div class="ttc" id="aa00340_html_a1a141bb2d1d8b67737119e0729c7d159"><div class="ttname"><a href="a00340.html#a1a141bb2d1d8b67737119e0729c7d159">CO_Security_Login\set_ids</a></div><div class="ttdeci">set_ids( $in_ids_array)</div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00328">co_security_login.class.php:328</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00367_source.html#l00051">CO_Lang_Common\$db_error_code_user_not_authorized</a>, <a class="el" href="a00382_source.html#l00056">CO_Lang\$db_error_desc_user_not_authorized</a>, <a class="el" href="a00382_source.html#l00055">CO_Lang\$db_error_name_user_not_authorized</a>, <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>, <a class="el" href="a00173_source.html#l00328">set_ids()</a>, and <a class="el" href="a00173_source.html#l00522">user_can_edit_ids()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a985325996e8392412a6782569b294176_cgraph.svg" width="100%" height="531"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a6d1a5f62b1742349eb0cc8ba921fa5cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d1a5f62b1742349eb0cc8ba921fa5cf">&#9670;&nbsp;</a></span>remove_personal_token_from_this_login()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::remove_personal_token_from_this_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This removes a personal token from the current logged-in ID's pool, from the regular ID pool of another ID.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the operation was successful. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_id</td><td>The ID (personal token) to be added. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00865">865</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;                                                              {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        $ret = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;remove_personal_token_from_this_login($this-&gt;_id, $in_id);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160; </div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;error) {</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;            $this-&gt;error = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;error;</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;            $this-&gt;<a class="code" href="a00308.html#aa5e1bc5570c817cfe3ddeb67003d4f45">reload_from_db</a>();</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;            <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        }</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160; </div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>, and <a class="el" href="a00149_source.html#l00479">A_CO_DB_Table_Base\reload_from_db()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a6d1a5f62b1742349eb0cc8ba921fa5cf_cgraph.svg" width="100%" height="405"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a1a141bb2d1d8b67737119e0729c7d159"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a141bb2d1d8b67737119e0729c7d159">&#9670;&nbsp;</a></span>set_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::set_ids </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_ids_array</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is a setter for the ID array. It can delete the array by sending in NULL, or an empty array. No user can set IDs for which they do not have access. Since this is a "whole hog" operation, we need to be able to access every single ID in the current object before we can replace or delete them.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if successful. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_ids_array</td><td>This is a preset array of integers, containing security IDs for the row. NULL/Empty to delete all IDs. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00328">328</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                              {</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;        $in_ids_array = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $in_ids_array);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00340.html#a946d1fc04964f6f0b55c8cc018bf2c70">user_can_edit_ids</a>()) {</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;            $id_pool = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_security_ids(<span class="keyword">true</span>);  <span class="comment">// We get just our regular IDs. No personal ones.</span></div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;            <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() || (isset($id_pool) &amp;&amp; is_array($id_pool) &amp;&amp; count($id_pool))) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="comment">// First thing we do, is ensure that EVERY SINGLE ID in the current user are ones we have in our own set.</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="comment">// An empty set is fine.</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="keywordflow">foreach</span>($this-&gt;_ids as $id) {</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                    <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() &amp;&amp; (isset($id) &amp;&amp; (0 &lt; $id) &amp;&amp; !in_array($id, $id_pool))) {</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                        <span class="comment">// Even one failure scrags the operation.</span></div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                        $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common::$db_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                                                        <a class="code" href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang::$db_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                                        <a class="code" href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang::$db_error_desc_user_not_authorized</a>,</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                                                        __LINE__,</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                                                        __FILE__,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                                        __METHOD__</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                    );</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    }</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                }</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                <span class="comment">// Next, if there is an existing array, we check our input, and add only the IDs we own.</span></div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() || (isset($in_ids_array) &amp;&amp; is_array($in_ids_array) &amp;&amp; count($in_ids_array))) {</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    $temp_ids = array_map(<span class="stringliteral">&#39;intval&#39;</span>, $in_ids_array);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                    $new_ids = Array();</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                    <span class="keywordflow">foreach</span>($temp_ids as $in_id) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                        <span class="keywordflow">if</span> (($in_id != $this-&gt;<span class="keywordtype">id</span>()) &amp;&amp; ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() || in_array($in_id, $id_pool))) {</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                            $new_ids[] = $in_id;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                        }</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    }</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                </div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                    $this-&gt;_ids = $new_ids;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                <span class="comment">// Otherwise, we are clearing the array.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    $this-&gt;_ids = Array();</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                }</div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        </div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                $ret = $this-&gt;<a class="code" href="a00308.html#a7487697640051c6661b8cdca6f109959">update_db</a>();</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common::$db_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                                                <a class="code" href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang::$db_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                                <a class="code" href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang::$db_error_desc_user_not_authorized</a>,</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                                                __LINE__,</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                                __FILE__,</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                                __METHOD__</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                            );</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            }</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;             $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00356.html">LGV_Error</a>(   <a class="code" href="a00344.html#ab23b25f81da3f81c8e379e2b8d39ed21">CO_Lang_Common::$db_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                            <a class="code" href="a00348.html#a0c76414ee625f67403ed2560dc5576b8">CO_Lang::$db_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                            <a class="code" href="a00348.html#a1ccdf30da841532c591e5a3dd9a0651a">CO_Lang::$db_error_desc_user_not_authorized</a>,</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                            __LINE__,</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                            __FILE__,</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                                            __METHOD__</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                                        );</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;        }</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;        </div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00367_source.html#l00051">CO_Lang_Common\$db_error_code_user_not_authorized</a>, <a class="el" href="a00382_source.html#l00056">CO_Lang\$db_error_desc_user_not_authorized</a>, <a class="el" href="a00382_source.html#l00055">CO_Lang\$db_error_name_user_not_authorized</a>, <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>, <a class="el" href="a00149_source.html#l00460">A_CO_DB_Table_Base\update_db()</a>, and <a class="el" href="a00173_source.html#l00522">user_can_edit_ids()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00448">remove_id()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a1a141bb2d1d8b67737119e0729c7d159_cgraph.svg" width="100%" height="495"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a1a141bb2d1d8b67737119e0729c7d159_icgraph.svg" width="439" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a061f896c69dc8a8dd3d9ee793b91ddc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a061f896c69dc8a8dd3d9ee793b91ddc7">&#9670;&nbsp;</a></span>set_lang()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::set_lang </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_lang_id</em> = <code>NULL</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true, if the set was successful. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_lang_id</td><td>The lang ID. This is not used for the low-level error handlers (which use the server setting). It is used to determine higher-level strings. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented from <a class="el" href="a00308.html#a1ed093545fa1cbc3f63a672cdf424734">A_CO_DB_Table_Base</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00699">699</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                              {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        </div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00340.html#aba256552040dd8af7196f0fea2a58609">user_can_write</a>()) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;            $this-&gt;context[<span class="stringliteral">&#39;lang&#39;</span>] = strtolower(trim(strval($in_lang_id)));</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;            $ret = $this-&gt;<a class="code" href="a00308.html#a7487697640051c6661b8cdca6f109959">update_db</a>();</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        </div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00460">A_CO_DB_Table_Base\update_db()</a>, and <a class="el" href="a00173_source.html#l00895">user_can_write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a061f896c69dc8a8dd3d9ee793b91ddc7_cgraph.svg" width="100%" height="517"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ac4f0c16cb8cf1e2151451bf4d5cb2238"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4f0c16cb8cf1e2151451bf4d5cb2238">&#9670;&nbsp;</a></span>set_password_from_cleartext()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::set_password_from_cleartext </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_cleartext_password</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This encrypts a cleartext password, and sets it into the record.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the set was successful. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_cleartext_password</td><td>The cleartext password. It will not be saved. Instead, the hashed password will be saved. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00733">733</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;                                                  {</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;        </div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00340.html#aba256552040dd8af7196f0fea2a58609">user_can_write</a>()) {</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            $this-&gt;context[<span class="stringliteral">&#39;hashed_password&#39;</span>] = $this-&gt;<a class="code" href="a00340.html#a615bc63ad75ff08982eeb0c1a2da7243">get_crypted_password</a>($in_cleartext_password);</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            $ret = $this-&gt;<a class="code" href="a00308.html#a7487697640051c6661b8cdca6f109959">update_db</a>();</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;        }</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;        </div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00601">get_crypted_password()</a>, <a class="el" href="a00149_source.html#l00460">A_CO_DB_Table_Base\update_db()</a>, and <a class="el" href="a00173_source.html#l00895">user_can_write()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_ac4f0c16cb8cf1e2151451bf4d5cb2238_cgraph.svg" width="100%" height="517"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a8d18fed2a089c920e67802253be3cd68"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d18fed2a089c920e67802253be3cd68">&#9670;&nbsp;</a></span>set_personal_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::set_personal_ids </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_personal_ids</em> = <code>[]</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This sets just the "personal" IDs for the given ID.</p>
<p>This should only be called by the "God" admin, and will fail, otherwise (returns empty array).</p>
<p>This is not an atomic operation. If any of the given IDs are also in the regular ID list, they will be removed from the personal IDs.</p>
<dl class="section return"><dt>Returns</dt><dd>an array of integers, with the new personal security IDs (usually a copy of the input Array). It will be empty, if the procedure fails. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_personal_ids</td><td>An Array of Integers, with the new personal IDs. This replaces any previous ones. If empty, then the IDs are removed. </td></tr>
  </table>
  </dd>
</dl>

<p>Reimplemented in <a class="el" href="a00228.html#a4b0b7fb5b0279bbb2a24b0ed3f93eb74">CO_Cobra_Login</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00538">538</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                      {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        $personal_ids_temp = array_unique(array_map(<span class="stringliteral">&#39;intval&#39;</span>, $in_personal_ids));</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        $this-&gt;_personal_ids = [];</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        $access_object = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>();</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span> (CO_Config::use_personal_tokens() &amp;&amp; isset($access_object) &amp;&amp; $access_object-&gt;god_mode()) {</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            <span class="keywordflow">if</span> (0 &lt; count($personal_ids_temp)) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                $personal_ids = [];</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                $my_ids = <a class="code" href="a00340.html#a6313fc451a0d2feb3049e274bb90e471">$this-&gt;_ids</a>;</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                <span class="comment">// None of the ids can be in the regular IDs, and will be removed from the set, if so.</span></div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                <span class="comment">// They also cannot be anyone else&#39;s personal ID, or anyone&#39;s login ID. Personal IDs can ONLY be regular (non-login) security objects.</span></div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                <span class="keywordflow">foreach</span>($personal_ids_temp as $id) {</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                    <span class="comment">// Make sure that we don&#39;t have this personal token in our regular ID array.</span></div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;                    <span class="keywordflow">if</span> (($key = array_search($id, $my_ids)) !== <span class="keyword">false</span>) {</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;                        unset($my_ids[$key]);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;                    }</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                    <span class="keywordflow">if</span> (!$this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;is_this_a_login_id($id) || in_array($id, $this-&gt;_personal_ids)) {</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                        array_push($personal_ids, $id);</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                    }</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                }</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                $this-&gt;_ids = $my_ids;</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                sort($personal_ids);</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                $this-&gt;_personal_ids = $personal_ids;</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;            }</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        }</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;            </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        $this-&gt;<a class="code" href="a00308.html#a7487697640051c6661b8cdca6f109959">update_db</a>();</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;        </div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="a00340.html#a519e8486953a1264821df5ead2696850">$this-&gt;_personal_ids</a>;</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00173_source.html#l00042">$_ids</a>, <a class="el" href="a00173_source.html#l00041">$_personal_ids</a>, <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>, and <a class="el" href="a00149_source.html#l00460">A_CO_DB_Table_Base\update_db()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00340_a8d18fed2a089c920e67802253be3cd68_cgraph.svg" width="100%" height="449"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a946d1fc04964f6f0b55c8cc018bf2c70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a946d1fc04964f6f0b55c8cc018bf2c70">&#9670;&nbsp;</a></span>user_can_edit_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::user_can_edit_ids </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We check to see if we can edit the IDs for this record. We cannot edit our own IDs, and have to own all of the IDs in the object in order to be able to change them. Of course, God can do whatever God wants...</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the current logged-in user can edit IDs for this login. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00522">522</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                                        {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        $ret = ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_login_id() != <a class="code" href="a00308.html#a80c6183fb5e62296058cc4310096e844">$this-&gt;_id</a>) &amp;&amp; ($this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode() || $this-&gt;_db_object-&gt;i_have_all_ids($this-&gt;_id));</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        </div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    }</div>
<div class="ttc" id="aa00308_html_a80c6183fb5e62296058cc4310096e844"><div class="ttname"><a href="a00308.html#a80c6183fb5e62296058cc4310096e844">A_CO_DB_Table_Base\$_id</a></div><div class="ttdeci">$_id</div><div class="ttdoc">This is the within-table unique ID of this record.</div><div class="ttdef"><b>Definition:</b> <a href="a00149_source.html#l00045">a_co_db_table_base.class.php:45</a></div></div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00045">A_CO_DB_Table_Base\$_id</a>, and <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00396">add_id()</a>, <a class="el" href="a00173_source.html#l00448">remove_id()</a>, and <a class="el" href="a00173_source.html#l00328">set_ids()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a946d1fc04964f6f0b55c8cc018bf2c70_cgraph.svg" width="382" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_a946d1fc04964f6f0b55c8cc018bf2c70_icgraph.svg" width="651" height="139"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="aba256552040dd8af7196f0fea2a58609"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba256552040dd8af7196f0fea2a58609">&#9670;&nbsp;</a></span>user_can_write()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::user_can_write </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>We override this, because the God login can only be modified by itself. No one else.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the current logged-in user has write permission on this record. </dd></dl>

<p>Reimplemented from <a class="el" href="a00308.html#a7d2537d7675ca572ad78096784fe4fe4">A_CO_DB_Table_Base</a>.</p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00895">895</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;                                     {</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        </div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        <span class="comment">// Only God can edit God.</span></div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;<a class="code" href="a00340.html#a03304936652c2c606c411c7c6a0f0c7f">i_am_a_god</a>() &amp;&amp; !$this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode()) {</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;            <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;            $ids = $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;get_security_ids();</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;            $my_write_item = intval($this-&gt;write_security_id);</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;            <span class="keywordflow">if</span> ((0 == $my_write_item) || $this-&gt;<a class="code" href="a00308.html#a8780b40e55827b90bb441671faec2a05">get_access_object</a>()-&gt;god_mode()) {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;                $ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;                <span class="keywordflow">if</span> (isset($ids) &amp;&amp; is_array($ids) &amp;&amp; count($ids)) {</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;                    $ret = in_array($my_write_item, $ids);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;                }</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;            }</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        }</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00149_source.html#l00494">A_CO_DB_Table_Base\get_access_object()</a>, and <a class="el" href="a00173_source.html#l00667">i_am_a_god()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00924">delete_from_db()</a>, <a class="el" href="a00173_source.html#l00699">set_lang()</a>, and <a class="el" href="a00173_source.html#l00733">set_password_from_cleartext()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aba256552040dd8af7196f0fea2a58609_cgraph.svg" width="382" height="118"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00340_aba256552040dd8af7196f0fea2a58609_icgraph.svg" width="411" height="170"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3dd81bbb72c853dfb7368c730b9175c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3dd81bbb72c853dfb7368c730b9175c2">&#9670;&nbsp;</a></span>$_api_key</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::$_api_key</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is an API key for REST. </p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00040">40</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00110">_build_parameter_array()</a>, and <a class="el" href="a00173_source.html#l00091">_default_setup()</a>.</p>

</div>
</div>
<a id="a6313fc451a0d2feb3049e274bb90e471"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6313fc451a0d2feb3049e274bb90e471">&#9670;&nbsp;</a></span>$_ids</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::$_ids</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>These are security tokens, available to this ID. </p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00042">42</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00091">_default_setup()</a>, <a class="el" href="a00173_source.html#l00499">ids()</a>, and <a class="el" href="a00173_source.html#l00538">set_personal_ids()</a>.</p>

</div>
</div>
<a id="abb9e732125cad8a02e6f95220328c942"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb9e732125cad8a02e6f95220328c942">&#9670;&nbsp;</a></span>$_override_access_class</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::$_override_access_class</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is a special "one-shot" semaphore telling the save to override the access class. </p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00039">39</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>

</div>
</div>
<a id="a519e8486953a1264821df5ead2696850"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a519e8486953a1264821df5ead2696850">&#9670;&nbsp;</a></span>$_personal_ids</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::$_personal_ids</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>These are personal IDs (special IDs, unique to the login). </p>

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00041">41</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00091">_default_setup()</a>, <a class="el" href="a00173_source.html#l00576">personal_ids()</a>, and <a class="el" href="a00173_source.html#l00538">set_personal_ids()</a>.</p>

</div>
</div>
<a id="ac80d3225f3c0bd99a16088a62ed83c6c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac80d3225f3c0bd99a16088a62ed83c6c">&#9670;&nbsp;</a></span>$login_id</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Security_Login::$login_id</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="a00173_source.html#l00044">44</a> of file <a class="el" href="a00173_source.html">co_security_login.class.php</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00173_source.html#l00110">_build_parameter_array()</a>, and <a class="el" href="a00173_source.html#l00091">_default_setup()</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
