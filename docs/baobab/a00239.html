<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.20"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>BAOBAB: CO_Cobra Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(function() { init_search(); });
/* @license-end */
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">BAOBAB
   </div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.svg"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.svg" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.20 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('a00239.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="a00236.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">CO_Cobra Class Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for CO_Cobra:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00237.svg" width="191" height="324"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a0815b59b59c157227c283e260ab2576f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a0815b59b59c157227c283e260ab2576f">get_security_ids</a> ()</td></tr>
<tr class="separator:a0815b59b59c157227c283e260ab2576f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d6421cfa6abf3aa5885bfe694ee898d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a7d6421cfa6abf3aa5885bfe694ee898d">make_standalone_user</a> ()</td></tr>
<tr class="separator:a7d6421cfa6abf3aa5885bfe694ee898d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eaa5ad2b11d99851df8f298bdbd6e47"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a3eaa5ad2b11d99851df8f298bdbd6e47">get_login_instance</a> ( $in_login_id)</td></tr>
<tr class="separator:a3eaa5ad2b11d99851df8f298bdbd6e47"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5bb2d69d9ca618b755ceb4eaba247e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#ad5bb2d69d9ca618b755ceb4eaba247e8">get_user_from_login</a> ( $in_login_id=NULL, $in_make_user_if_necessary=false)</td></tr>
<tr class="separator:ad5bb2d69d9ca618b755ceb4eaba247e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a327fb6e4cfcaf6d32639123eed2ea412"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a327fb6e4cfcaf6d32639123eed2ea412">create_new_standard_login</a> ( $in_login_id, $in_cleartext_password, $in_security_token_ids=NULL)</td></tr>
<tr class="separator:a327fb6e4cfcaf6d32639123eed2ea412"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a3c537cc29c1d4cdb6df5f004ce6d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#ac8a3c537cc29c1d4cdb6df5f004ce6d0">create_new_manager_login</a> ( $in_login_id, $in_cleartext_password, $in_security_token_ids=NULL)</td></tr>
<tr class="separator:ac8a3c537cc29c1d4cdb6df5f004ce6d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f75d437e7a86f0ec0095b281c804397"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a8f75d437e7a86f0ec0095b281c804397">convert_login</a> ( $in_login_id, $in_is_login_manager=false)</td></tr>
<tr class="separator:a8f75d437e7a86f0ec0095b281c804397"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ef606d48b0551d23f9c4bd30d1c4110"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a6ef606d48b0551d23f9c4bd30d1c4110">delete_login</a> ( $in_login_id, $also_delete_user=false)</td></tr>
<tr class="separator:a6ef606d48b0551d23f9c4bd30d1c4110"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afe5d288794309d94a96295c85da7bbb6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#afe5d288794309d94a96295c85da7bbb6">get_all_logins</a> ( $and_write=false, $in_login_id=NULL, $in_login_integer_id=NULL)</td></tr>
<tr class="separator:afe5d288794309d94a96295c85da7bbb6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d512174babde0bbbc827a6167378a85"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a3d512174babde0bbbc827a6167378a85">who_can_see</a> ( $in_test_target)</td></tr>
<tr class="separator:a3d512174babde0bbbc827a6167378a85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b4266d8dd4770fb9f938bf31d78d36f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a2b4266d8dd4770fb9f938bf31d78d36f">who_can_modify</a> ( $in_test_target, $non_managers_only=false)</td></tr>
<tr class="separator:a2b4266d8dd4770fb9f938bf31d78d36f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a292ea4e61d5b75f30463995d8bc8a87d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a292ea4e61d5b75f30463995d8bc8a87d">make_security_token</a> ()</td></tr>
<tr class="separator:a292ea4e61d5b75f30463995d8bc8a87d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:ab5eb04ad3ad060aa178fda0221c2bcf5"><td class="memItemLeft" align="right" valign="top">static&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#ab5eb04ad3ad060aa178fda0221c2bcf5">make_cobra</a> ($in_chameleon_instance)</td></tr>
<tr class="separator:ab5eb04ad3ad060aa178fda0221c2bcf5"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a440e46a27d2996eced258104b5dba0a2"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a440e46a27d2996eced258104b5dba0a2">$version</a></td></tr>
<tr class="memdesc:a440e46a27d2996eced258104b5dba0a2"><td class="mdescLeft">&#160;</td><td class="mdescRight">The version indicator.  <a href="a00239.html#a440e46a27d2996eced258104b5dba0a2">More...</a><br /></td></tr>
<tr class="separator:a440e46a27d2996eced258104b5dba0a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a15371cf35e812615a00fc5f535320338"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a15371cf35e812615a00fc5f535320338">_convert_login</a> ( $in_login_id, $in_is_login_manager=false)</td></tr>
<tr class="separator:a15371cf35e812615a00fc5f535320338"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7710a3275a7b2dfdba8e00a8bd2c0f61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#a7710a3275a7b2dfdba8e00a8bd2c0f61">_create_new_login</a> ( $in_login_id, $in_cleartext_password, $in_security_token_ids=NULL, $in_is_login_manager=false)</td></tr>
<tr class="separator:a7710a3275a7b2dfdba8e00a8bd2c0f61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:ad4f1a959218caf7f3eb29b29f3fd4a70"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#ad4f1a959218caf7f3eb29b29f3fd4a70">__construct</a> ( $in_chameleon_instance=NULL)</td></tr>
<tr class="separator:ad4f1a959218caf7f3eb29b29f3fd4a70"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:afa3e1238e979c499e0a34a062aba723e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="a00239.html#afa3e1238e979c499e0a34a062aba723e">$_chameleon_instance</a> = NULL</td></tr>
<tr class="memdesc:afa3e1238e979c499e0a34a062aba723e"><td class="mdescLeft">&#160;</td><td class="mdescRight">This is the CHAMELEON instance that is associated with this COBRA instance.  <a href="a00239.html#afa3e1238e979c499e0a34a062aba723e">More...</a><br /></td></tr>
<tr class="separator:afa3e1238e979c499e0a34a062aba723e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class implements a "login manager" functionality to The Rift Valley Platform.</p>
<p>This class can only be instantiated by the "God" login, or a login that is a <a class="el" href="a00235.html">CO_Login_Manager</a>.</p>
<p>You use COBRA to manage other logins, or security tokens. </p>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00046">46</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad4f1a959218caf7f3eb29b29f3fd4a70"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f1a959218caf7f3eb29b29f3fd4a70">&#9670;&nbsp;</a></span>__construct()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::__construct </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_chameleon_instance</em> = <code>NULL</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>The constructor.</p>
<p>We declare it private to prevent it being instantiated outside the factory. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_chameleon_instance</td><td>The CHAMELEON instance associated with this COBRA instance. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00088">88</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;                                  {</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        $this-&gt;_chameleon_instance = $in_chameleon_instance;</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        $this-&gt;version = <a class="code" href="a00110.html#a276eb68c30701b62d24301edd4092fee">__COBRA_VERSION__</a>;</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00110_source.html#l00028">__COBRA_VERSION__</a>.</p>

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a15371cf35e812615a00fc5f535320338"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15371cf35e812615a00fc5f535320338">&#9670;&nbsp;</a></span>_convert_login()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::_convert_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_is_login_manager</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is the internal function used to convert a login to (or from) a manager, in the security database. This can only be called from a login manager.</p>
<dl class="section return"><dt>Returns</dt><dd>the converted instance. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID as text. This must be for a login that can be managed by the current manager. </td></tr>
    <tr><td class="paramname">$in_is_login_manager</td><td>If true, then this is a "promotion" to a a manager. If false (default), then this is a "demotion" to a standard user. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00101">101</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;                                          {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        $working_login = $this-&gt;_chameleon_instance-&gt;get_login_item_by_login_string($in_login_id);   <span class="comment">// This is the login we are changing.</span></div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        $manager = $this-&gt;_chameleon_instance-&gt;get_login_item();                                    <span class="comment">// This is our current login.</span></div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <span class="comment">// Make sure we are a login manager, first, and that we have write permission on the user.</span></div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">if</span> ($working_login &amp;&amp; $working_login-&gt;user_can_write() &amp;&amp; ($manager instanceof <a class="code" href="a00235.html">CO_Login_Manager</a> || $manager-&gt;<a class="code" href="a00343.html#aac538e52310a1c332914682a9c2ec8d2">is_god</a>())) {</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;            <span class="comment">// Now, make sure that we&#39;re actually making a change.</span></div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <span class="keywordflow">if</span> (($in_is_login_manager &amp;&amp; !$working_login-&gt;is_manager()) || (!$in_is_login_manager &amp;&amp; $working_login-&gt;is_manager())) {</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                $className = $in_is_login_manager ? <span class="stringliteral">&#39;CO_Login_Manager&#39;</span> : <span class="stringliteral">&#39;CO_Cobra_Login&#39;</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                $user_object = $this-&gt;<a class="code" href="a00239.html#ad5bb2d69d9ca618b755ceb4eaba247e8">get_user_from_login</a>($working_login-&gt;id());    <span class="comment">// Get this, so we can modify it.</span></div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;            </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                <span class="comment">// Create a new blank instance.</span></div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;                $new_login_object = $this-&gt;_chameleon_instance-&gt;make_new_blank_record($className);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;            </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                <span class="keywordflow">if</span> (isset($new_login_object) &amp;&amp; ($new_login_object instanceof <a class="code" href="a00231.html">CO_Cobra_Login</a>)) {</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                    $original_login_id = $working_login-&gt;id();</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                    $original_ids = $working_login-&gt;ids();</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                    <span class="keywordflow">if</span> (!isset($original_ids)) {</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        $original_ids = [];</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    }</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;                </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                    array_push($original_ids, $original_login_id);    <span class="comment">// We will add this to the new login&#39;s IDs.</span></div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                    $original_ids = array_unique($original_ids);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                </div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    asort($original_ids);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;                </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    $new_login_object-&gt;login_id = $working_login-&gt;login_id;</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;                    $new_login_object-&gt;name = $working_login-&gt;name;</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;                    $new_login_object-&gt;context = $working_login-&gt;context;</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;                    $new_login_object-&gt;set_ids($original_ids);</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                    <span class="comment">// OK. At this point, we have a new login that is of the type that we want. It is different from the previous one, and has all the relevant data.</span></div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    <span class="comment">// Now, we will delete the old one, and then replace it with the new one.</span></div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                    <span class="keywordflow">if</span> ($working_login-&gt;delete_from_db()) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                        <span class="keywordflow">if</span> ($new_login_object-&gt;update_db()) {</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                            $new_id = $new_login_object-&gt;id();</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                            <span class="keywordflow">if</span> (method_exists($manager, <span class="stringliteral">&#39;add_new_login_id&#39;</span>)) {  <span class="comment">// We only add the ID, if we are a manager object. God doesn&#39;t need this.</span></div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;                                $manager-&gt;add_new_login_id($new_id);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;                            }</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                            $new_login_object-&gt;read_security_id = $new_id;</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;                            $new_login_object-&gt;write_security_id = $new_id;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                            <span class="keywordflow">if</span> ($new_login_object-&gt;update_db()) {</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;                                $user_object-&gt;write_security_id = $new_id;</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                                $user_object-&gt;set_login($new_id);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;                                <span class="keywordflow">if</span> ($user_object-&gt;update_db()) {</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;                                    $ret = $new_login_object;   <span class="comment">// If everything went well, to this point, we update the return.</span></div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                                    $this-&gt;error = $user_object-&gt;error;</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                                }</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;                                $this-&gt;error = $new_login_object-&gt;error;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                            }</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                            $this-&gt;error = $new_login_object-&gt;error;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                        }</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;                        $this-&gt;error = $working_login-&gt;error;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;                    }</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                }</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            }</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        }</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        </div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00110_source.html#l00353">get_user_from_login()</a>, and <a class="el" href="a00176_source.html#l00268">CO_Security_Login\is_god()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00110_source.html#l00449">convert_login()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00239_a15371cf35e812615a00fc5f535320338_cgraph.svg" width="100%" height="374"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_a15371cf35e812615a00fc5f535320338_icgraph.svg" width="403" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a7710a3275a7b2dfdba8e00a8bd2c0f61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7710a3275a7b2dfdba8e00a8bd2c0f61">&#9670;&nbsp;</a></span>_create_new_login()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::_create_new_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_cleartext_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_security_token_ids</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_is_login_manager</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>This is the internal function used to create a new login in the security database. This can only be called from a login manager.</p>
<dl class="section return"><dt>Returns</dt><dd>the new <a class="el" href="a00231.html">CO_Cobra_Login</a> instance (or <a class="el" href="a00235.html">CO_Login_Manager</a> instance). </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID as text. It needs to be unique, within the Security database, and this will fail, if it is not. </td></tr>
    <tr><td class="paramname">$in_cleartext_password</td><td>The password to set (in cleartext). It will be stored as a hashed password. </td></tr>
    <tr><td class="paramname">$in_security_token_ids</td><td>An array of integers. These are security token IDs for the login (default is NULL). If NULL, then no IDs will be set. These IDs must be selected from those available to the currently logged-in manager. </td></tr>
    <tr><td class="paramname">$in_is_login_manager</td><td>true, if we want a <a class="el" href="a00235.html">CO_Login_Manager</a> instance, instead of a <a class="el" href="a00231.html">CO_Cobra_Login</a> instance. Default is false. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00174">174</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                                          {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordflow">if</span> (isset($in_login_id) &amp;&amp; !$this-&gt;_chameleon_instance-&gt;check_login_exists_by_login_string($in_login_id)) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;            $manager = $this-&gt;_chameleon_instance-&gt;get_login_item();</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;            <span class="keywordflow">if</span> ($manager instanceof <a class="code" href="a00235.html">CO_Login_Manager</a> || $manager-&gt;<a class="code" href="a00343.html#aac538e52310a1c332914682a9c2ec8d2">is_god</a>()) { <span class="comment">// Make sure we are a login manager, first.</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                $use_these_ids = Array();</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                <span class="comment">// Next, see if they provided IDs. If so, we remove any that we don&#39;t own.</span></div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                <span class="keywordflow">if</span> (isset($in_security_token_ids) &amp;&amp; is_array($in_security_token_ids) &amp;&amp; count($in_security_token_ids)) {</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                    $my_ids = $this-&gt;<a class="code" href="a00239.html#a0815b59b59c157227c283e260ab2576f">get_security_ids</a>();</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                </div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <span class="keywordflow">foreach</span> ($in_security_token_ids as $id) {</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                        <span class="keywordflow">if</span> (in_array($id, $my_ids)) {</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                            array_push($use_these_ids, $id);</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                        }</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    <span class="comment">// At this point, only IDs that we have available are in the array.</span></div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                }</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                </div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                $className = $in_is_login_manager ? <span class="stringliteral">&#39;CO_Login_Manager&#39;</span> : <span class="stringliteral">&#39;CO_Cobra_Login&#39;</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;                </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                $new_login_object = $this-&gt;_chameleon_instance-&gt;make_new_blank_record($className);</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                </div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                <span class="keywordflow">if</span> (isset($new_login_object) &amp;&amp; ($new_login_object instanceof <a class="code" href="a00231.html">CO_Cobra_Login</a>)) {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    $new_login_object-&gt;login_id = $in_login_id;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    <span class="keywordflow">if</span> (strlen($in_cleartext_password) &gt;= CO_Config::$min_pw_len) {</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                        $new_login_object-&gt;context[<span class="stringliteral">&#39;hashed_password&#39;</span>] = password_hash($in_cleartext_password, PASSWORD_DEFAULT);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;                        </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;                        <span class="keywordflow">if</span> (!$new_login_object-&gt;update_db()) {</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                            $this-&gt;error = $new_login_object-&gt;error;</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                            $new_login_object-&gt;delete_from_db();</div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;                            $new_login_object = NULL;</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                            $new_id = $new_login_object-&gt;id();</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;                            <span class="keywordflow">if</span> (method_exists($manager, <span class="stringliteral">&#39;add_new_login_id&#39;</span>)) {</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                $manager-&gt;add_new_login_id($new_id);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                            }</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                            <span class="keywordflow">if</span> ($new_login_object-&gt;set_read_security_id($new_id)) {</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                                <span class="keywordflow">if</span> ($new_login_object-&gt;set_write_security_id($new_id)) {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;                                    $new_ids = [];</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                                    <span class="keywordflow">foreach</span> ($use_these_ids as $id) {</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                        <span class="keywordflow">if</span> (in_array($id, $my_ids) &amp;&amp; ($id != $new_id)) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                                            array_push($new_ids, $id);</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                                        }</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                                    }</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                                    <span class="keywordflow">if</span> ($new_login_object-&gt;set_ids($new_ids)) {</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;                                        $ret = $new_login_object;</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                                        $this-&gt;error = $new_login_object-&gt;error;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;                                        $new_login_object-&gt;delete_from_db();</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;                                        $new_login_object = NULL;</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                                    }</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                                    $this-&gt;error = $new_login_object-&gt;error;</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                                    $new_login_object-&gt;delete_from_db();</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                                    $new_login_object = NULL;</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                                }</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                                $this-&gt;error = $new_login_object-&gt;error;</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                                $new_login_object-&gt;delete_from_db();</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                                $new_login_object = NULL;</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                            }</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                        }</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                        $new_login_object-&gt;delete_from_db();</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                        $new_login_object = NULL;</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                        $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ac7988855b4b3bb3030b091332324037e">CO_COBRA_Lang_Common::$cobra_error_code_password_too_short</a>,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                                        <a class="code" href="a00247.html#a67b324eaa2a58413c02abe83dba0bf3b">CO_COBRA_Lang::$cobra_error_name_password_too_short</a>,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                                        <a class="code" href="a00247.html#a86d692046e5d74ea8cd0cf4678b68691">CO_COBRA_Lang::$cobra_error_desc_password_too_short</a>);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    }</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    <span class="keywordflow">if</span> (isset($this-&gt;_chameleon_instance-&gt;error)) {</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                        $this-&gt;error = $this-&gt;_chameleon_instance-&gt;error;</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                        $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ac55f07f911e50b2699b60258d7e5ab92">CO_COBRA_Lang_Common::$cobra_error_code_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                                                        <a class="code" href="a00247.html#aa40a48df91f4802015c16f4f876ff2d4">CO_COBRA_Lang::$cobra_error_name_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                                                        <a class="code" href="a00247.html#a6d4da4171ccf950183f300b88432d11d">CO_COBRA_Lang::$cobra_error_desc_instance_failed_to_initialize</a>);</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                }</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ae1e7a56e3c7a62d1738c7f8cb4fed667">CO_COBRA_Lang_Common::$cobra_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                                <a class="code" href="a00247.html#a4d049cd2cad9b4281e57bc7d7a1a3796">CO_COBRA_Lang::$cobra_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                                                <a class="code" href="a00247.html#a088b07d412fa2fd21493e2155b659e08">CO_COBRA_Lang::$cobra_error_desc_user_not_authorized</a>);</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;            }</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        } elseif (isset($in_login_id)) {</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#a54e9c93b40655017fa83b08d35a418b8">CO_COBRA_Lang_Common::$cobra_error_code_user_already_exists</a>,</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                            <a class="code" href="a00247.html#a5d67fdf6a1f3dea95d6c1ecc17732f93">CO_COBRA_Lang::$cobra_error_name_user_already_exists</a>,</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                            <a class="code" href="a00247.html#aa7a75e5bd084382ea86f237af782156c">CO_COBRA_Lang::$cobra_error_desc_user_already_exists</a>);</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#a9c57b577094e5ab898a12bff9fbab562">CO_COBRA_Lang_Common::$cobra_error_code_login_error</a>,</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;                                            <a class="code" href="a00247.html#a2213b01219a25b8bb0ed0c8d69d80c4c">CO_COBRA_Lang::$cobra_error_name_login_error</a>,</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;                                            <a class="code" href="a00247.html#aa932d75f7f16afcc0ef046cf4d63035f">CO_COBRA_Lang::$cobra_error_desc_login_error</a>);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        }</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00376_source.html#l00048">CO_COBRA_Lang_Common\$cobra_error_code_instance_failed_to_initialize</a>, <a class="el" href="a00376_source.html#l00052">CO_COBRA_Lang_Common\$cobra_error_code_login_error</a>, <a class="el" href="a00376_source.html#l00055">CO_COBRA_Lang_Common\$cobra_error_code_password_too_short</a>, <a class="el" href="a00376_source.html#l00050">CO_COBRA_Lang_Common\$cobra_error_code_user_already_exists</a>, <a class="el" href="a00376_source.html#l00047">CO_COBRA_Lang_Common\$cobra_error_code_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00038">CO_COBRA_Lang\$cobra_error_desc_instance_failed_to_initialize</a>, <a class="el" href="a00391_source.html#l00044">CO_COBRA_Lang\$cobra_error_desc_login_error</a>, <a class="el" href="a00391_source.html#l00050">CO_COBRA_Lang\$cobra_error_desc_password_too_short</a>, <a class="el" href="a00391_source.html#l00040">CO_COBRA_Lang\$cobra_error_desc_user_already_exists</a>, <a class="el" href="a00391_source.html#l00036">CO_COBRA_Lang\$cobra_error_desc_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00037">CO_COBRA_Lang\$cobra_error_name_instance_failed_to_initialize</a>, <a class="el" href="a00391_source.html#l00043">CO_COBRA_Lang\$cobra_error_name_login_error</a>, <a class="el" href="a00391_source.html#l00049">CO_COBRA_Lang\$cobra_error_name_password_too_short</a>, <a class="el" href="a00391_source.html#l00039">CO_COBRA_Lang\$cobra_error_name_user_already_exists</a>, <a class="el" href="a00391_source.html#l00034">CO_COBRA_Lang\$cobra_error_name_user_not_authorized</a>, <a class="el" href="a00110_source.html#l00280">get_security_ids()</a>, and <a class="el" href="a00176_source.html#l00268">CO_Security_Login\is_god()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00110_source.html#l00434">create_new_manager_login()</a>, and <a class="el" href="a00110_source.html#l00420">create_new_standard_login()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_a7710a3275a7b2dfdba8e00a8bd2c0f61_cgraph.svg" width="632" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_a7710a3275a7b2dfdba8e00a8bd2c0f61_icgraph.svg" width="382" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a8f75d437e7a86f0ec0095b281c804397"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f75d437e7a86f0ec0095b281c804397">&#9670;&nbsp;</a></span>convert_login()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::convert_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_is_login_manager</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the public function used to convert a login to (or from) a manager, in the security database. This can only be called from a login manager. The user is not affected, and the login IDs (tokens) are also left "as is."</p>
<dl class="section return"><dt>Returns</dt><dd>the converted instance. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID as text. This must be for a login that can be managed by the current manager. </td></tr>
    <tr><td class="paramname">$in_is_login_manager</td><td>If true, then this is a "promotion" to a a manager. If false (default), then this is a "demotion" to a standard user. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00449">449</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;                                  {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00239.html#a15371cf35e812615a00fc5f535320338">_convert_login</a>($in_login_id, $in_is_login_manager);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00110_source.html#l00101">_convert_login()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00239_a8f75d437e7a86f0ec0095b281c804397_cgraph.svg" width="100%" height="374"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="ac8a3c537cc29c1d4cdb6df5f004ce6d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8a3c537cc29c1d4cdb6df5f004ce6d0">&#9670;&nbsp;</a></span>create_new_manager_login()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::create_new_manager_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_cleartext_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_security_token_ids</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the public function used to create a new login manager login in the security database. This can only be called from a login manager.</p>
<dl class="section return"><dt>Returns</dt><dd>the new <a class="el" href="a00235.html">CO_Login_Manager</a> instance. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID as text. It needs to be unique, within the Security database, and this will fail, if it is not. </td></tr>
    <tr><td class="paramname">$in_cleartext_password</td><td>The password to set (in cleartext). It will be stored as a hashed password. </td></tr>
    <tr><td class="paramname">$in_security_token_ids</td><td>An array of integers. These are security token IDs for the login (default is NULL). If NULL, then no IDs will be set. These IDs must be selected from those available to the currently logged-in manager. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00434">434</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                                              {</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00239.html#a7710a3275a7b2dfdba8e00a8bd2c0f61">_create_new_login</a>($in_login_id, $in_cleartext_password, $in_security_token_ids, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00110_source.html#l00174">_create_new_login()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00239_ac8a3c537cc29c1d4cdb6df5f004ce6d0_cgraph.svg" width="100%" height="364"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a327fb6e4cfcaf6d32639123eed2ea412"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a327fb6e4cfcaf6d32639123eed2ea412">&#9670;&nbsp;</a></span>create_new_standard_login()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::create_new_standard_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_cleartext_password</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_security_token_ids</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This is the public function used to create a new standard login in the security database. This can only be called from a login manager.</p>
<dl class="section return"><dt>Returns</dt><dd>the new <a class="el" href="a00231.html">CO_Cobra_Login</a> instance. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID as text. It needs to be unique, within the Security database, and this will fail, if it is not. </td></tr>
    <tr><td class="paramname">$in_cleartext_password</td><td>The password to set (in cleartext). It will be stored as a hashed password. </td></tr>
    <tr><td class="paramname">$in_security_token_ids</td><td>An array of integers. These are security token IDs for the login (default is NULL). If NULL, then no IDs will be set. These IDs must be selected from those available to the currently logged-in manager. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00420">420</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                              {</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;        <span class="keywordflow">return</span> $this-&gt;<a class="code" href="a00239.html#a7710a3275a7b2dfdba8e00a8bd2c0f61">_create_new_login</a>($in_login_id, $in_cleartext_password, $in_security_token_ids);</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00110_source.html#l00174">_create_new_login()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00239_a327fb6e4cfcaf6d32639123eed2ea412_cgraph.svg" width="100%" height="364"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a6ef606d48b0551d23f9c4bd30d1c4110"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6ef606d48b0551d23f9c4bd30d1c4110">&#9670;&nbsp;</a></span>delete_login()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::delete_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$also_delete_user</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This deletes a login, given the login ID. When we delete a login, it actually gets changed into a security ID instance (to reserve the ID slot), however, the user object is actually removed. It should be noted that deleting a (user) collection does not delete everything in the collection; only the collection object, itself.</p>
<dl class="section return"><dt>Returns</dt><dd>true, if the operation (or operations) succeeded. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The login ID as text. </td></tr>
    <tr><td class="paramname">$also_delete_user</td><td>If true (Default is false), then we will also delete the user record associated with this login. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00463">463</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                  {</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        </div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        $cobra_login_instance = $this-&gt;<a class="code" href="a00239.html#a3eaa5ad2b11d99851df8f298bdbd6e47">get_login_instance</a>($in_login_id);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;        <span class="keywordflow">if</span> ($cobra_login_instance) {</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;            $cobra_user_instance = NULL;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;            </div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;            <span class="keywordflow">if</span> ($also_delete_user) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;                $cobra_user_instance = $this-&gt;<a class="code" href="a00239.html#ad5bb2d69d9ca618b755ceb4eaba247e8">get_user_from_login</a>($cobra_login_instance-&gt;id());</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;            }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;            </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;            $ret = $cobra_login_instance-&gt;delete_from_db();</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;            </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;            <span class="keywordflow">if</span> ($ret &amp;&amp; $cobra_user_instance) {</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;                $ret = $cobra_user_instance-&gt;delete_from_db();</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;            }</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        }</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00110_source.html#l00332">get_login_instance()</a>, and <a class="el" href="a00110_source.html#l00353">get_user_from_login()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00239_a6ef606d48b0551d23f9c4bd30d1c4110_cgraph.svg" width="100%" height="384"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="afe5d288794309d94a96295c85da7bbb6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afe5d288794309d94a96295c85da7bbb6">&#9670;&nbsp;</a></span>get_all_logins()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::get_all_logins </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$and_write</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_integer_id</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>an array of instances of all the logins that are visible to the current user (or a supplied user, if in "God" mode). </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$and_write</td><td>If true, then we only want ones we have write access to. </td></tr>
    <tr><td class="paramname">$in_login_id</td><td>This is ignored, unless this is the God login. If We are logged in as God, then we can select a login via its string login ID, and see what logins are available to it. </td></tr>
    <tr><td class="paramname">$in_login_integer_id</td><td>This is ignored, unless this is the God login and $in_login_id is not specified. If We are logged in as God, then we can select a login via its integer login ID, and see what logins are available to it. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00491">491</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                                      {</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <span class="keywordflow">if</span> (!$this-&gt;_chameleon_instance-&gt;god_mode()) {  <span class="comment">// Definitely won&#39;t look at this unless we are God.</span></div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            $in_login_id = NULL;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            $in_login_integer_id = 0;</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;            $in_login_id = trim(strval($in_login_id));</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;        </div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            <span class="keywordflow">if</span> (!$in_login_id) {    <span class="comment">// String login ID trumps integer.</span></div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;                $in_login_integer_id = intval($in_login_integer_id);</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                $item = $this-&gt;_chameleon_instance-&gt;get_login_item_by_login_string($in_login_id);</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                $in_login_id = NULL;</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;                $in_login_integer_id = $item-&gt;id();</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;            }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        }</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        </div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;        <span class="comment">// If both $in_login_id and $in_login_integer_id are unspecified, then we&#39;ll find every login we can see.</span></div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="comment">// If they are specified (which means we&#39;re God), then we filter for only the </span></div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        $id_list = Array();</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        $results = $this-&gt;_chameleon_instance-&gt;get_all_login_objects($and_write);</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;        <span class="keywordflow">if</span> (isset($results) &amp;&amp; is_array($results) &amp;&amp; count($results)) {</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;            <span class="keywordflow">foreach</span> ($results as $result) {</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                <span class="keywordflow">if</span> (!$in_login_integer_id || ($in_login_integer_id == $result-&gt;id())) {</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                    $id_list[] = $result-&gt;id();</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;                    <span class="keywordflow">foreach</span> ($result-&gt;ids() as $id) {</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;                        <span class="keywordflow">if</span> (($id != CO_Config::god_mode_id()) || (($id == CO_Config::god_mode_id()) &amp;&amp; ($in_login_integer_id == CO_Config::god_mode_id()))) {</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;                            $id_list[] = $id;</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;                        }</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;                    }</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;                }</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;            }</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        }</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        </div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        $id_list = array_unique($id_list);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;        $ret = Array();</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">foreach</span> ($id_list as $id) {</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;            $object = $this-&gt;_chameleon_instance-&gt;get_single_security_record_by_id($id);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            <span class="keywordflow">if</span> ($object instanceof <a class="code" href="a00343.html">CO_Security_Login</a>) {</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;                $ret[] = $object;</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            }</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        }</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <span class="keywordflow">if</span> (1 &lt; count($ret)) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="comment">// Sort the results by ID.</span></div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            usort($ret, <span class="keyword">function</span> ($a, $b) {</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                                            <span class="keywordflow">if</span> ($a-&gt;id() == $b-&gt;id()) {</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                                                return 0;</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                                            }</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                                        </div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                                            <a class="code" href="a00110.html#a1dc9931250994a79280a8bd8b1ab5321">if</a> ($a-&gt;id() &lt; $b-&gt;id()) {</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;                                                return -1;</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;                                            }</div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;                                        </div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                                            <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                            });</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        }</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;        </div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00110_source.html#l00032">if</a>.</p>

</div>
</div>
<a id="a3eaa5ad2b11d99851df8f298bdbd6e47"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eaa5ad2b11d99851df8f298bdbd6e47">&#9670;&nbsp;</a></span>get_login_instance()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::get_login_instance </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This returns the login instance for the given ID string.</p>
<p>This is scurity-vetted. The current login needs to be able to see the item.</p>
<dl class="section return"><dt>Returns</dt><dd>the Login Item. NULL if unable to fetch the item. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The string login ID that we are referencing. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00332">332</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                          {</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        </div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">if</span> (isset($in_login_id) &amp;&amp; $in_login_id) {</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;            $ret = $this-&gt;_chameleon_instance-&gt;get_login_item_by_login_string($in_login_id);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;            </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;            $this-&gt;error = $this-&gt;_chameleon_instance-&gt;error;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        }</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;        </div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00110_source.html#l00463">delete_login()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_a3eaa5ad2b11d99851df8f298bdbd6e47_icgraph.svg" width="363" height="50"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a0815b59b59c157227c283e260ab2576f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0815b59b59c157227c283e260ab2576f">&#9670;&nbsp;</a></span>get_security_ids()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::get_security_ids </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>an array of integers, with each one representing a special security token for editing security items. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00280">280</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                       {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">return</span> $this-&gt;_chameleon_instance-&gt;get_security_ids();</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">Referenced by <a class="el" href="a00110_source.html#l00174">_create_new_login()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_a0815b59b59c157227c283e260ab2576f_icgraph.svg" width="615" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ad5bb2d69d9ca618b755ceb4eaba247e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5bb2d69d9ca618b755ceb4eaba247e8">&#9670;&nbsp;</a></span>get_user_from_login()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::get_user_from_login </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_login_id</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_make_user_if_necessary</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This fetches a user from a given login ID.</p>
<p>The user may be created, if the current login is a Login Manager, and the second parameter is set to true.</p>
<dl class="section return"><dt>Returns</dt><dd>an instance of a user collection. If new, it will be blank. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_login_id</td><td>The integer login ID that is associated with the user collection. If NULL, then the current login is used. </td></tr>
    <tr><td class="paramname">$in_make_user_if_necessary</td><td>If true (Default is false), then the user will be created if it does not already exist. Ignored, if we are not a Login Manager. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00353">353</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                                          {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        $user = $this-&gt;_chameleon_instance-&gt;get_user_from_login($in_login_id);   <span class="comment">// First, see if it&#39;s already a thing.</span></div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;        </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;        <span class="keywordflow">if</span> (!$user &amp;&amp; $in_make_user_if_necessary &amp;&amp; ($this-&gt;_chameleon_instance-&gt;god_mode() || ($this-&gt;_chameleon_instance-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>))) {   <span class="comment">// If not, we will create a new one, based on the given login. We must be a manager.</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;            <span class="keywordflow">if</span> (isset($in_login_id) &amp;&amp; (0 &lt; intval($in_login_id))) {    <span class="comment">// See if they seek a different login.</span></div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                $login_id = intval($in_login_id);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;            }</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="comment">// Assuming all is well, we need to create a new user. We have to be a login manager to do this.</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            <span class="keywordflow">if</span> (isset($in_login_id) &amp;&amp; (0 &lt; intval($in_login_id))) {</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                $login_item = $this-&gt;_chameleon_instance-&gt;get_login_item($in_login_id);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">if</span> (isset($login_item) &amp;&amp; ($login_item instanceof <a class="code" href="a00343.html">CO_Security_Login</a>)) {</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;                    <span class="keywordflow">if</span> (!$this-&gt;_chameleon_instance-&gt;check_user_exists($in_login_id)) {</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;                        $user = $this-&gt;<a class="code" href="a00239.html#a7d6421cfa6abf3aa5885bfe694ee898d">make_standalone_user</a>();</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                        <span class="keywordflow">if</span> ($user) {</div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                            $user-&gt;set_login($in_login_id); <span class="comment">// We set the user&#39;s login instance to the login instance we&#39;re using as the basis.</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                            <span class="keywordflow">if</span> (isset($user-&gt;error)) {</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                                $this-&gt;error = $user-&gt;error;</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                $user-&gt;delete_from_db();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                                $user = NULL;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                $user-&gt;set_write_security_id($in_login_id); <span class="comment">// Make sure the user can modify their own record.</span></div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                <span class="keywordflow">if</span> (isset($user-&gt;error)) {</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                    $this-&gt;error = $user-&gt;error;</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                                    $user-&gt;delete_from_db();</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                                    $user = NULL;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                                }</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                            }</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ac55f07f911e50b2699b60258d7e5ab92">CO_COBRA_Lang_Common::$cobra_error_code_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                                                            <a class="code" href="a00247.html#aa40a48df91f4802015c16f4f876ff2d4">CO_COBRA_Lang::$cobra_error_name_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                                                            <a class="code" href="a00247.html#a6d4da4171ccf950183f300b88432d11d">CO_COBRA_Lang::$cobra_error_desc_instance_failed_to_initialize</a>);</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                        }</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                        $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#a54e9c93b40655017fa83b08d35a418b8">CO_COBRA_Lang_Common::$cobra_error_code_user_already_exists</a>,</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                                                        <a class="code" href="a00247.html#a5d67fdf6a1f3dea95d6c1ecc17732f93">CO_COBRA_Lang::$cobra_error_name_user_already_exists</a>,</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                                                        <a class="code" href="a00247.html#aa7a75e5bd084382ea86f237af782156c">CO_COBRA_Lang::$cobra_error_desc_user_already_exists</a>);</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                    }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;                    $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#a928742e4e5adf5352f00970f61b0a93d">CO_COBRA_Lang_Common::$cobra_error_code_login_unavailable</a>,</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;                                                    <a class="code" href="a00247.html#a77119b96f9c1a92b4cf8dec631b5fe15">CO_COBRA_Lang::$cobra_error_name_login_unavailable</a>,</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;                                                    <a class="code" href="a00247.html#a7cba01e9c902162db9f2473c39141b2e">CO_COBRA_Lang::$cobra_error_desc_login_unavailable</a>);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;                }</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;                $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#a928742e4e5adf5352f00970f61b0a93d">CO_COBRA_Lang_Common::$cobra_error_code_login_unavailable</a>,</div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                                                <a class="code" href="a00247.html#a77119b96f9c1a92b4cf8dec631b5fe15">CO_COBRA_Lang::$cobra_error_name_login_unavailable</a>,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                                                <a class="code" href="a00247.html#a7cba01e9c902162db9f2473c39141b2e">CO_COBRA_Lang::$cobra_error_desc_login_unavailable</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;        } elseif (!($this-&gt;_chameleon_instance-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>)) {</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ae1e7a56e3c7a62d1738c7f8cb4fed667">CO_COBRA_Lang_Common::$cobra_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;                                            <a class="code" href="a00247.html#a4d049cd2cad9b4281e57bc7d7a1a3796">CO_COBRA_Lang::$cobra_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;                                            <a class="code" href="a00247.html#a088b07d412fa2fd21493e2155b659e08">CO_COBRA_Lang::$cobra_error_desc_user_not_authorized</a>);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        }</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        </div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        <span class="keywordflow">return</span> $user;</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00376_source.html#l00048">CO_COBRA_Lang_Common\$cobra_error_code_instance_failed_to_initialize</a>, <a class="el" href="a00376_source.html#l00051">CO_COBRA_Lang_Common\$cobra_error_code_login_unavailable</a>, <a class="el" href="a00376_source.html#l00050">CO_COBRA_Lang_Common\$cobra_error_code_user_already_exists</a>, <a class="el" href="a00376_source.html#l00047">CO_COBRA_Lang_Common\$cobra_error_code_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00038">CO_COBRA_Lang\$cobra_error_desc_instance_failed_to_initialize</a>, <a class="el" href="a00391_source.html#l00042">CO_COBRA_Lang\$cobra_error_desc_login_unavailable</a>, <a class="el" href="a00391_source.html#l00040">CO_COBRA_Lang\$cobra_error_desc_user_already_exists</a>, <a class="el" href="a00391_source.html#l00036">CO_COBRA_Lang\$cobra_error_desc_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00037">CO_COBRA_Lang\$cobra_error_name_instance_failed_to_initialize</a>, <a class="el" href="a00391_source.html#l00041">CO_COBRA_Lang\$cobra_error_name_login_unavailable</a>, <a class="el" href="a00391_source.html#l00039">CO_COBRA_Lang\$cobra_error_name_user_already_exists</a>, <a class="el" href="a00391_source.html#l00034">CO_COBRA_Lang\$cobra_error_name_user_not_authorized</a>, and <a class="el" href="a00110_source.html#l00290">make_standalone_user()</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00110_source.html#l00101">_convert_login()</a>, and <a class="el" href="a00110_source.html#l00463">delete_login()</a>.</p>
<div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_ad5bb2d69d9ca618b755ceb4eaba247e8_cgraph.svg" width="462" height="50"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_ad5bb2d69d9ca618b755ceb4eaba247e8_icgraph.svg" width="626" height="86"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="ab5eb04ad3ad060aa178fda0221c2bcf5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab5eb04ad3ad060aa178fda0221c2bcf5">&#9670;&nbsp;</a></span>make_cobra()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static CO_Cobra::make_cobra </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_chameleon_instance</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Factory Function.</p>
<p>This vets the CHAMELEON instance, and makes sure that it's valid before returning a constructed COBRA.</p>
<dl class="section return"><dt>Returns</dt><dd>an instance of <a class="el" href="a00239.html">CO_Cobra</a> upon success. If there was an error set by COBRA (or CHAMELEON), or the vetting failed, that is returned instead of a COBRA instance. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00059">59</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;                                                       {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        $ret = NULL;</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        </div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">// We must have a valid CHAMELEON instance that is logged in. The login user must be a COBRA Manager user (the standard logins cannot use COBRA).</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <span class="keywordflow">if</span> (isset($in_chameleon_instance)</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;            &amp;&amp; ($in_chameleon_instance instanceof <a class="code" href="a00299.html">CO_Chameleon</a>)</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;            &amp;&amp; $in_chameleon_instance-&gt;security_db_available()</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;            &amp;&amp; ($in_chameleon_instance-&gt;god_mode() || ($in_chameleon_instance-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>))) {</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;            $ret = <span class="keyword">new</span> <a class="code" href="a00239.html">CO_Cobra</a>($in_chameleon_instance);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        } elseif (isset($in_chameleon_instance) &amp;&amp; ($in_chameleon_instance instanceof <a class="code" href="a00299.html">CO_Chameleon</a>)) {</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            $ret = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ae1e7a56e3c7a62d1738c7f8cb4fed667">CO_COBRA_Lang_Common::$cobra_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                                    <a class="code" href="a00247.html#a4d049cd2cad9b4281e57bc7d7a1a3796">CO_COBRA_Lang::$cobra_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                                    <a class="code" href="a00247.html#ac186ae3d3ea528b936e86a19616d325a">CO_COBRA_Lang::$cobra_error_desc_user_not_authorized_instance</a>);</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;            $ret = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#a7ba5df9ae8f9bb34b7d7c57db5f8f094">CO_COBRA_Lang_Common::$cobra_error_code_invalid_chameleon</a>,</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                                    <a class="code" href="a00247.html#ada98be8653650cdc6148a8d50ba9e11d">CO_COBRA_Lang::$cobra_error_name_invalid_chameleon</a>,</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                                    <a class="code" href="a00247.html#a529fde78ff9700b8e06bb5d310907adc">CO_COBRA_Lang::$cobra_error_desc_invalid_chameleon</a>);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        }</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00376_source.html#l00049">CO_COBRA_Lang_Common\$cobra_error_code_invalid_chameleon</a>, <a class="el" href="a00376_source.html#l00047">CO_COBRA_Lang_Common\$cobra_error_code_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00033">CO_COBRA_Lang\$cobra_error_desc_invalid_chameleon</a>, <a class="el" href="a00391_source.html#l00035">CO_COBRA_Lang\$cobra_error_desc_user_not_authorized_instance</a>, <a class="el" href="a00391_source.html#l00032">CO_COBRA_Lang\$cobra_error_name_invalid_chameleon</a>, and <a class="el" href="a00391_source.html#l00034">CO_COBRA_Lang\$cobra_error_name_user_not_authorized</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00101_source.html#l00150">CO_Andisol\__construct()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="a00239_ab5eb04ad3ad060aa178fda0221c2bcf5_icgraph.svg" width="386" height="36"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</div>

</div>
</div>
<a id="a292ea4e61d5b75f30463995d8bc8a87d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a292ea4e61d5b75f30463995d8bc8a87d">&#9670;&nbsp;</a></span>make_security_token()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::make_security_token </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This simply generates a new security token instance.</p>
<p>Security tokens are "the gift that keeps on giving." Once created, they can't easily be deleted. Only the God admin can delete them. They are permanent placeholders.</p>
<dl class="section return"><dt>Returns</dt><dd>an integer, with the new ID, or 0, if the method failed (check error). </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00636">636</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                          {</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        $ret = 0;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        </div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;        $manager = $this-&gt;_chameleon_instance-&gt;get_login_item();</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;_chameleon_instance-&gt;god_mode() || ($manager instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>)) {</div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;            $new_token = $this-&gt;_chameleon_instance-&gt;make_new_blank_record(<span class="stringliteral">&#39;CO_Security_ID&#39;</span>);</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">if</span> (isset($new_token) &amp;&amp; ($new_token instanceof <a class="code" href="a00339.html">CO_Security_ID</a>)) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                $new_id = $new_token-&gt;id();</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                <span class="keywordflow">if</span> ($this-&gt;_chameleon_instance-&gt;god_mode() || $manager-&gt;add_new_login_id($new_id)) {  <span class="comment">// We need to do the &quot;special excemption&quot; add of the ID to the manager.</span></div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                    $ret = $new_id;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                } <span class="keywordflow">else</span> {    <span class="comment">// We were unable to set the new token ID to the manager.</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    $new_token-&gt;delete_from_db();</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#a7be4b228c27554b6a963a7b90b63795f">CO_COBRA_Lang_Common::$cobra_error_code_token_id_not_set</a>,</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                                                    <a class="code" href="a00247.html#a559c3c3a57a7458a70c35f4c84e16488">CO_COBRA_Lang::$cobra_error_name_token_id_not_set</a>,</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                                    <a class="code" href="a00247.html#ae0a11a0638aabf36798310fa0b21d7df">CO_COBRA_Lang::$cobra_error_desc_token_id_not_set</a>);</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                }</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            } <span class="keywordflow">else</span> {    <span class="comment">// Token object did not get instantiated.</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ad9d2e4bdef5048c20dd19c888520bb9e">CO_COBRA_Lang_Common::$cobra_error_code_token_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                                                <a class="code" href="a00247.html#a0d991fd802d6c792a783425bc12fb415">CO_COBRA_Lang::$cobra_error_name_token_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                                                <a class="code" href="a00247.html#ae859a6eaaadaa1bfd3bdfb0e31b746cd">CO_COBRA_Lang::$cobra_error_desc_token_instance_failed_to_initialize</a>);</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            }</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;        } <span class="keywordflow">else</span> {    <span class="comment">// Should never happen, but what the hell...</span></div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ae1e7a56e3c7a62d1738c7f8cb4fed667">CO_COBRA_Lang_Common::$cobra_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                                            <a class="code" href="a00247.html#a4d049cd2cad9b4281e57bc7d7a1a3796">CO_COBRA_Lang::$cobra_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                                            <a class="code" href="a00247.html#a088b07d412fa2fd21493e2155b659e08">CO_COBRA_Lang::$cobra_error_desc_user_not_authorized</a>);</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        }</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;        </div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00376_source.html#l00054">CO_COBRA_Lang_Common\$cobra_error_code_token_id_not_set</a>, <a class="el" href="a00376_source.html#l00053">CO_COBRA_Lang_Common\$cobra_error_code_token_instance_failed_to_initialize</a>, <a class="el" href="a00376_source.html#l00047">CO_COBRA_Lang_Common\$cobra_error_code_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00048">CO_COBRA_Lang\$cobra_error_desc_token_id_not_set</a>, <a class="el" href="a00391_source.html#l00046">CO_COBRA_Lang\$cobra_error_desc_token_instance_failed_to_initialize</a>, <a class="el" href="a00391_source.html#l00036">CO_COBRA_Lang\$cobra_error_desc_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00047">CO_COBRA_Lang\$cobra_error_name_token_id_not_set</a>, <a class="el" href="a00391_source.html#l00045">CO_COBRA_Lang\$cobra_error_name_token_instance_failed_to_initialize</a>, and <a class="el" href="a00391_source.html#l00034">CO_COBRA_Lang\$cobra_error_name_user_not_authorized</a>.</p>

</div>
</div>
<a id="a7d6421cfa6abf3aa5885bfe694ee898d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d6421cfa6abf3aa5885bfe694ee898d">&#9670;&nbsp;</a></span>make_standalone_user()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::make_standalone_user </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Creates a new "standalone" user that has no associated login instance.</p>
<dl class="section return"><dt>Returns</dt><dd>the new user record. </dd></dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00290">290</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                           {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        $user = NULL;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;        </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;        <span class="keywordflow">if</span> ($this-&gt;_chameleon_instance-&gt;god_mode() || ($this-&gt;_chameleon_instance-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>)) {     <span class="comment">// We have to be a manager to create a user.</span></div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            $user = $this-&gt;_chameleon_instance-&gt;make_new_blank_record(<span class="stringliteral">&#39;CO_User_Collection&#39;</span>);</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        </div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;            <span class="keywordflow">if</span> ($user) {</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keywordflow">if</span> (!isset($user-&gt;error)) {</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    $user-&gt;set_read_security_id(1); <span class="comment">// Users default to 1 (only logged-in users can see).</span></div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    $user-&gt;set_write_security_id($this-&gt;_chameleon_instance-&gt;get_login_item()-&gt;id()); <span class="comment">// Make sure that only we can modify this record.</span></div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                    <span class="keywordflow">if</span> (isset($user-&gt;error)) {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                        $this-&gt;error = $user-&gt;error;</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                        $user-&gt;delete_from_db();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                        $user = NULL;</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    }</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    $this-&gt;error = $user-&gt;error;</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    $user-&gt;delete_from_db();</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                    $user = NULL;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                }</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;            } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ac55f07f911e50b2699b60258d7e5ab92">CO_COBRA_Lang_Common::$cobra_error_code_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                                                <a class="code" href="a00247.html#aa40a48df91f4802015c16f4f876ff2d4">CO_COBRA_Lang::$cobra_error_name_instance_failed_to_initialize</a>,</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                                <a class="code" href="a00247.html#a6d4da4171ccf950183f300b88432d11d">CO_COBRA_Lang::$cobra_error_desc_instance_failed_to_initialize</a>);</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            }</div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        } elseif (!($this-&gt;_chameleon_instance-&gt;get_login_item() instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>)) {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            $this-&gt;error = <span class="keyword">new</span> <a class="code" href="a00359.html">LGV_Error</a>(   <a class="code" href="a00243.html#ae1e7a56e3c7a62d1738c7f8cb4fed667">CO_COBRA_Lang_Common::$cobra_error_code_user_not_authorized</a>,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                            <a class="code" href="a00247.html#a4d049cd2cad9b4281e57bc7d7a1a3796">CO_COBRA_Lang::$cobra_error_name_user_not_authorized</a>,</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                            <a class="code" href="a00247.html#a088b07d412fa2fd21493e2155b659e08">CO_COBRA_Lang::$cobra_error_desc_user_not_authorized</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;        }</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        </div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        <span class="keywordflow">return</span> $user;</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div>
</div><!-- fragment -->
<p class="reference">References <a class="el" href="a00376_source.html#l00048">CO_COBRA_Lang_Common\$cobra_error_code_instance_failed_to_initialize</a>, <a class="el" href="a00376_source.html#l00047">CO_COBRA_Lang_Common\$cobra_error_code_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00038">CO_COBRA_Lang\$cobra_error_desc_instance_failed_to_initialize</a>, <a class="el" href="a00391_source.html#l00036">CO_COBRA_Lang\$cobra_error_desc_user_not_authorized</a>, <a class="el" href="a00391_source.html#l00037">CO_COBRA_Lang\$cobra_error_name_instance_failed_to_initialize</a>, and <a class="el" href="a00391_source.html#l00034">CO_COBRA_Lang\$cobra_error_name_user_not_authorized</a>.</p>

<p class="reference">Referenced by <a class="el" href="a00110_source.html#l00353">get_user_from_login()</a>.</p>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="a00239_a7d6421cfa6abf3aa5885bfe694ee898d_icgraph.svg" width="100%" height="364"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
</div>

</div>
</div>
<a id="a2b4266d8dd4770fb9f938bf31d78d36f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b4266d8dd4770fb9f938bf31d78d36f">&#9670;&nbsp;</a></span>who_can_modify()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::who_can_modify </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_test_target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$non_managers_only</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test an item to see which logins can modify it.</p>
<p>This is security-limited.</p>
<dl class="section return"><dt>Returns</dt><dd>an array of instances of <a class="el" href="a00343.html">CO_Security_Login</a> (Security Database login) items that can modify the given item. If the write ID is 0 (open), then the function simply returns true. If nothing can modify the item, then false is returned. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_test_target</td><td>This is a subclass of <a class="el" href="a00311.html">A_CO_DB_Table_Base</a> (General Database Record). </td></tr>
    <tr><td class="paramname">$non_managers_only</td><td>Ignored if the target is not an instance (or subclass) of <a class="el" href="a00343.html">CO_Security_Login</a>. If true (default is false), then only login manager objects will be returned. If you supply a login object as the target, this is a quick way to see if any non-manager objects can modify it. In reality, there should be no non-manager objects that can modify a login, besides the login, itself. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00589">589</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                      {</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <span class="keywordflow">if</span> (isset($in_test_target) &amp;&amp; ($in_test_target instanceof <a class="code" href="a00311.html">A_CO_DB_Table_Base</a>)) {</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;            $id = intval($in_test_target-&gt;write_security_id);</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;            </div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;            <span class="keywordflow">if</span> (0 &lt; $id) {</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                $ret = $this-&gt;_chameleon_instance-&gt;get_all_login_objects_with_access($id, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                <span class="comment">// Check to see if any non-manager objects can modify the login (should never be).</span></div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <span class="keywordflow">if</span> (($in_test_target instanceof <a class="code" href="a00343.html">CO_Security_Login</a>) &amp;&amp; isset($ret) &amp;&amp; is_array($ret) &amp;&amp; $non_managers_only) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                    $ret_temp = Array();</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                    <span class="keywordflow">foreach</span> ($ret as $login) {</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                        <span class="keywordflow">if</span> (!($login instanceof <a class="code" href="a00235.html">CO_Login_Manager</a>)) {</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                            $ret_temp[] = $login;</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                        }</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                    }</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                    </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                    <span class="keywordflow">if</span> (count($ret_temp)) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;                        $ret = $ret_temp;</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;                    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;                    }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;                } elseif (!isset($ret) || !is_array($ret) || !count($ret)) {</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;                    $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                }</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            } elseif (0 == $id) {</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;                $ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            }</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        }</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        </div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d512174babde0bbbc827a6167378a85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d512174babde0bbbc827a6167378a85">&#9670;&nbsp;</a></span>who_can_see()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::who_can_see </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>$in_test_target</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Test an item to see which logins can access it.</p>
<p>This is security-limited.</p>
<dl class="section return"><dt>Returns</dt><dd>an array of instances of <a class="el" href="a00343.html">CO_Security_Login</a> (Security Database login) items that can read/see the given item. If the read ID is 0 (open), then the function simply returns true. If nothing can see the item, then false is returned. </dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">$in_test_target</td><td>This is a subclass of <a class="el" href="a00311.html">A_CO_DB_Table_Base</a> (General Database Record). </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00561">561</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>
<div class="fragment"><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;                                  {</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;        $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;        </div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;        <span class="keywordflow">if</span> (isset($in_test_target) &amp;&amp; ($in_test_target instanceof <a class="code" href="a00311.html">A_CO_DB_Table_Base</a>)) {</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;            $id = intval($in_test_target-&gt;read_security_id);</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;            </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;            <span class="keywordflow">if</span> (0 &lt; $id) {</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                $ret = $this-&gt;_chameleon_instance-&gt;get_all_login_objects_with_access($id);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                <span class="keywordflow">if</span> (!isset($ret) || !is_array($ret) || !count($ret)) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                    $ret = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                }</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;            } elseif (0 == $id) {</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                $ret = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;            }</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        }</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        </div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keywordflow">return</span> $ret;</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="afa3e1238e979c499e0a34a062aba723e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa3e1238e979c499e0a34a062aba723e">&#9670;&nbsp;</a></span>$_chameleon_instance</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::$_chameleon_instance = NULL</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This is the CHAMELEON instance that is associated with this COBRA instance. </p>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00047">47</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>

</div>
</div>
<a id="a440e46a27d2996eced258104b5dba0a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a440e46a27d2996eced258104b5dba0a2">&#9670;&nbsp;</a></span>$version</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">CO_Cobra::$version</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>The version indicator. </p>

<p class="definition">Definition at line <a class="el" href="a00110_source.html#l00049">49</a> of file <a class="el" href="a00110_source.html">co_cobra.class.php</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<div class="ttc" id="aa00299_html"><div class="ttname"><a href="a00299.html">CO_Chameleon</a></div><div class="ttdef"><b>Definition:</b> <a href="a00143_source.html#l00041">co_chameleon.class.php:41</a></div></div>
<div class="ttc" id="aa00243_html_a7ba5df9ae8f9bb34b7d7c57db5f8f094"><div class="ttname"><a href="a00243.html#a7ba5df9ae8f9bb34b7d7c57db5f8f094">CO_COBRA_Lang_Common\$cobra_error_code_invalid_chameleon</a></div><div class="ttdeci">static $cobra_error_code_invalid_chameleon</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00049">common.inc.php:49</a></div></div>
<div class="ttc" id="aa00247_html_a088b07d412fa2fd21493e2155b659e08"><div class="ttname"><a href="a00247.html#a088b07d412fa2fd21493e2155b659e08">CO_COBRA_Lang\$cobra_error_desc_user_not_authorized</a></div><div class="ttdeci">static $cobra_error_desc_user_not_authorized</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00036">en.php:36</a></div></div>
<div class="ttc" id="aa00239_html_a15371cf35e812615a00fc5f535320338"><div class="ttname"><a href="a00239.html#a15371cf35e812615a00fc5f535320338">CO_Cobra\_convert_login</a></div><div class="ttdeci">_convert_login( $in_login_id, $in_is_login_manager=false)</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00101">co_cobra.class.php:101</a></div></div>
<div class="ttc" id="aa00247_html_a6d4da4171ccf950183f300b88432d11d"><div class="ttname"><a href="a00247.html#a6d4da4171ccf950183f300b88432d11d">CO_COBRA_Lang\$cobra_error_desc_instance_failed_to_initialize</a></div><div class="ttdeci">static $cobra_error_desc_instance_failed_to_initialize</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00038">en.php:38</a></div></div>
<div class="ttc" id="aa00247_html_ac186ae3d3ea528b936e86a19616d325a"><div class="ttname"><a href="a00247.html#ac186ae3d3ea528b936e86a19616d325a">CO_COBRA_Lang\$cobra_error_desc_user_not_authorized_instance</a></div><div class="ttdeci">static $cobra_error_desc_user_not_authorized_instance</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00035">en.php:35</a></div></div>
<div class="ttc" id="aa00243_html_a54e9c93b40655017fa83b08d35a418b8"><div class="ttname"><a href="a00243.html#a54e9c93b40655017fa83b08d35a418b8">CO_COBRA_Lang_Common\$cobra_error_code_user_already_exists</a></div><div class="ttdeci">static $cobra_error_code_user_already_exists</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00050">common.inc.php:50</a></div></div>
<div class="ttc" id="aa00247_html_a67b324eaa2a58413c02abe83dba0bf3b"><div class="ttname"><a href="a00247.html#a67b324eaa2a58413c02abe83dba0bf3b">CO_COBRA_Lang\$cobra_error_name_password_too_short</a></div><div class="ttdeci">static $cobra_error_name_password_too_short</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00049">en.php:49</a></div></div>
<div class="ttc" id="aa00343_html_aac538e52310a1c332914682a9c2ec8d2"><div class="ttname"><a href="a00343.html#aac538e52310a1c332914682a9c2ec8d2">CO_Security_Login\is_god</a></div><div class="ttdeci">is_god()</div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00268">co_security_login.class.php:268</a></div></div>
<div class="ttc" id="aa00239_html_ad5bb2d69d9ca618b755ceb4eaba247e8"><div class="ttname"><a href="a00239.html#ad5bb2d69d9ca618b755ceb4eaba247e8">CO_Cobra\get_user_from_login</a></div><div class="ttdeci">get_user_from_login( $in_login_id=NULL, $in_make_user_if_necessary=false)</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00353">co_cobra.class.php:353</a></div></div>
<div class="ttc" id="aa00247_html_ada98be8653650cdc6148a8d50ba9e11d"><div class="ttname"><a href="a00247.html#ada98be8653650cdc6148a8d50ba9e11d">CO_COBRA_Lang\$cobra_error_name_invalid_chameleon</a></div><div class="ttdeci">static $cobra_error_name_invalid_chameleon</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00032">en.php:32</a></div></div>
<div class="ttc" id="aa00359_html"><div class="ttname"><a href="a00359.html">LGV_Error</a></div><div class="ttdoc">This class provides a general error report, with file, method and error information.</div><div class="ttdef"><b>Definition:</b> <a href="a00182_source.html#l00032">error.class.php:32</a></div></div>
<div class="ttc" id="aa00231_html"><div class="ttname"><a href="a00231.html">CO_Cobra_Login</a></div><div class="ttdef"><b>Definition:</b> <a href="a00104_source.html#l00034">co_cobra_login.class.php:34</a></div></div>
<div class="ttc" id="aa00243_html_a7be4b228c27554b6a963a7b90b63795f"><div class="ttname"><a href="a00243.html#a7be4b228c27554b6a963a7b90b63795f">CO_COBRA_Lang_Common\$cobra_error_code_token_id_not_set</a></div><div class="ttdeci">static $cobra_error_code_token_id_not_set</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00054">common.inc.php:54</a></div></div>
<div class="ttc" id="aa00247_html_a2213b01219a25b8bb0ed0c8d69d80c4c"><div class="ttname"><a href="a00247.html#a2213b01219a25b8bb0ed0c8d69d80c4c">CO_COBRA_Lang\$cobra_error_name_login_error</a></div><div class="ttdeci">static $cobra_error_name_login_error</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00043">en.php:43</a></div></div>
<div class="ttc" id="aa00311_html"><div class="ttname"><a href="a00311.html">A_CO_DB_Table_Base</a></div><div class="ttdef"><b>Definition:</b> <a href="a00152_source.html#l00043">a_co_db_table_base.class.php:43</a></div></div>
<div class="ttc" id="aa00247_html_aa7a75e5bd084382ea86f237af782156c"><div class="ttname"><a href="a00247.html#aa7a75e5bd084382ea86f237af782156c">CO_COBRA_Lang\$cobra_error_desc_user_already_exists</a></div><div class="ttdeci">static $cobra_error_desc_user_already_exists</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00040">en.php:40</a></div></div>
<div class="ttc" id="aa00247_html_a4d049cd2cad9b4281e57bc7d7a1a3796"><div class="ttname"><a href="a00247.html#a4d049cd2cad9b4281e57bc7d7a1a3796">CO_COBRA_Lang\$cobra_error_name_user_not_authorized</a></div><div class="ttdeci">static $cobra_error_name_user_not_authorized</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00034">en.php:34</a></div></div>
<div class="ttc" id="aa00247_html_a529fde78ff9700b8e06bb5d310907adc"><div class="ttname"><a href="a00247.html#a529fde78ff9700b8e06bb5d310907adc">CO_COBRA_Lang\$cobra_error_desc_invalid_chameleon</a></div><div class="ttdeci">static $cobra_error_desc_invalid_chameleon</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00033">en.php:33</a></div></div>
<div class="ttc" id="aa00239_html_a7d6421cfa6abf3aa5885bfe694ee898d"><div class="ttname"><a href="a00239.html#a7d6421cfa6abf3aa5885bfe694ee898d">CO_Cobra\make_standalone_user</a></div><div class="ttdeci">make_standalone_user()</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00290">co_cobra.class.php:290</a></div></div>
<div class="ttc" id="aa00239_html_a7710a3275a7b2dfdba8e00a8bd2c0f61"><div class="ttname"><a href="a00239.html#a7710a3275a7b2dfdba8e00a8bd2c0f61">CO_Cobra\_create_new_login</a></div><div class="ttdeci">_create_new_login( $in_login_id, $in_cleartext_password, $in_security_token_ids=NULL, $in_is_login_manager=false)</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00174">co_cobra.class.php:174</a></div></div>
<div class="ttc" id="aa00243_html_a928742e4e5adf5352f00970f61b0a93d"><div class="ttname"><a href="a00243.html#a928742e4e5adf5352f00970f61b0a93d">CO_COBRA_Lang_Common\$cobra_error_code_login_unavailable</a></div><div class="ttdeci">static $cobra_error_code_login_unavailable</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00051">common.inc.php:51</a></div></div>
<div class="ttc" id="aa00247_html_aa40a48df91f4802015c16f4f876ff2d4"><div class="ttname"><a href="a00247.html#aa40a48df91f4802015c16f4f876ff2d4">CO_COBRA_Lang\$cobra_error_name_instance_failed_to_initialize</a></div><div class="ttdeci">static $cobra_error_name_instance_failed_to_initialize</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00037">en.php:37</a></div></div>
<div class="ttc" id="aa00247_html_ae859a6eaaadaa1bfd3bdfb0e31b746cd"><div class="ttname"><a href="a00247.html#ae859a6eaaadaa1bfd3bdfb0e31b746cd">CO_COBRA_Lang\$cobra_error_desc_token_instance_failed_to_initialize</a></div><div class="ttdeci">static $cobra_error_desc_token_instance_failed_to_initialize</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00046">en.php:46</a></div></div>
<div class="ttc" id="aa00339_html"><div class="ttname"><a href="a00339.html">CO_Security_ID</a></div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00038">co_security_id.class.php:38</a></div></div>
<div class="ttc" id="aa00239_html"><div class="ttname"><a href="a00239.html">CO_Cobra</a></div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00046">co_cobra.class.php:46</a></div></div>
<div class="ttc" id="aa00243_html_ac55f07f911e50b2699b60258d7e5ab92"><div class="ttname"><a href="a00243.html#ac55f07f911e50b2699b60258d7e5ab92">CO_COBRA_Lang_Common\$cobra_error_code_instance_failed_to_initialize</a></div><div class="ttdeci">static $cobra_error_code_instance_failed_to_initialize</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00048">common.inc.php:48</a></div></div>
<div class="ttc" id="aa00239_html_a0815b59b59c157227c283e260ab2576f"><div class="ttname"><a href="a00239.html#a0815b59b59c157227c283e260ab2576f">CO_Cobra\get_security_ids</a></div><div class="ttdeci">get_security_ids()</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00280">co_cobra.class.php:280</a></div></div>
<div class="ttc" id="aa00239_html_a3eaa5ad2b11d99851df8f298bdbd6e47"><div class="ttname"><a href="a00239.html#a3eaa5ad2b11d99851df8f298bdbd6e47">CO_Cobra\get_login_instance</a></div><div class="ttdeci">get_login_instance( $in_login_id)</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00332">co_cobra.class.php:332</a></div></div>
<div class="ttc" id="aa00110_html_a276eb68c30701b62d24301edd4092fee"><div class="ttname"><a href="a00110.html#a276eb68c30701b62d24301edd4092fee">__COBRA_VERSION__</a></div><div class="ttdeci">const __COBRA_VERSION__</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00028">co_cobra.class.php:28</a></div></div>
<div class="ttc" id="aa00247_html_aa932d75f7f16afcc0ef046cf4d63035f"><div class="ttname"><a href="a00247.html#aa932d75f7f16afcc0ef046cf4d63035f">CO_COBRA_Lang\$cobra_error_desc_login_error</a></div><div class="ttdeci">static $cobra_error_desc_login_error</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00044">en.php:44</a></div></div>
<div class="ttc" id="aa00247_html_a559c3c3a57a7458a70c35f4c84e16488"><div class="ttname"><a href="a00247.html#a559c3c3a57a7458a70c35f4c84e16488">CO_COBRA_Lang\$cobra_error_name_token_id_not_set</a></div><div class="ttdeci">static $cobra_error_name_token_id_not_set</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00047">en.php:47</a></div></div>
<div class="ttc" id="aa00235_html"><div class="ttname"><a href="a00235.html">CO_Login_Manager</a></div><div class="ttdef"><b>Definition:</b> <a href="a00107_source.html#l00033">co_login_manager.class.php:33</a></div></div>
<div class="ttc" id="aa00247_html_ae0a11a0638aabf36798310fa0b21d7df"><div class="ttname"><a href="a00247.html#ae0a11a0638aabf36798310fa0b21d7df">CO_COBRA_Lang\$cobra_error_desc_token_id_not_set</a></div><div class="ttdeci">static $cobra_error_desc_token_id_not_set</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00048">en.php:48</a></div></div>
<div class="ttc" id="aa00247_html_a0d991fd802d6c792a783425bc12fb415"><div class="ttname"><a href="a00247.html#a0d991fd802d6c792a783425bc12fb415">CO_COBRA_Lang\$cobra_error_name_token_instance_failed_to_initialize</a></div><div class="ttdeci">static $cobra_error_name_token_instance_failed_to_initialize</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00045">en.php:45</a></div></div>
<div class="ttc" id="aa00110_html_a1dc9931250994a79280a8bd8b1ab5321"><div class="ttname"><a href="a00110.html#a1dc9931250994a79280a8bd8b1ab5321">if</a></div><div class="ttdeci">if(!defined( 'LGV_LANG_CATCHER'))</div><div class="ttdef"><b>Definition:</b> <a href="a00110_source.html#l00032">co_cobra.class.php:32</a></div></div>
<div class="ttc" id="aa00247_html_a77119b96f9c1a92b4cf8dec631b5fe15"><div class="ttname"><a href="a00247.html#a77119b96f9c1a92b4cf8dec631b5fe15">CO_COBRA_Lang\$cobra_error_name_login_unavailable</a></div><div class="ttdeci">static $cobra_error_name_login_unavailable</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00041">en.php:41</a></div></div>
<div class="ttc" id="aa00247_html_a86d692046e5d74ea8cd0cf4678b68691"><div class="ttname"><a href="a00247.html#a86d692046e5d74ea8cd0cf4678b68691">CO_COBRA_Lang\$cobra_error_desc_password_too_short</a></div><div class="ttdeci">static $cobra_error_desc_password_too_short</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00050">en.php:50</a></div></div>
<div class="ttc" id="aa00343_html"><div class="ttname"><a href="a00343.html">CO_Security_Login</a></div><div class="ttdef"><b>Definition:</b> <a href="a00176_source.html#l00038">co_security_login.class.php:38</a></div></div>
<div class="ttc" id="aa00243_html_ac7988855b4b3bb3030b091332324037e"><div class="ttname"><a href="a00243.html#ac7988855b4b3bb3030b091332324037e">CO_COBRA_Lang_Common\$cobra_error_code_password_too_short</a></div><div class="ttdeci">static $cobra_error_code_password_too_short</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00055">common.inc.php:55</a></div></div>
<div class="ttc" id="aa00243_html_ad9d2e4bdef5048c20dd19c888520bb9e"><div class="ttname"><a href="a00243.html#ad9d2e4bdef5048c20dd19c888520bb9e">CO_COBRA_Lang_Common\$cobra_error_code_token_instance_failed_to_initialize</a></div><div class="ttdeci">static $cobra_error_code_token_instance_failed_to_initialize</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00053">common.inc.php:53</a></div></div>
<div class="ttc" id="aa00243_html_a9c57b577094e5ab898a12bff9fbab562"><div class="ttname"><a href="a00243.html#a9c57b577094e5ab898a12bff9fbab562">CO_COBRA_Lang_Common\$cobra_error_code_login_error</a></div><div class="ttdeci">static $cobra_error_code_login_error</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00052">common.inc.php:52</a></div></div>
<div class="ttc" id="aa00243_html_ae1e7a56e3c7a62d1738c7f8cb4fed667"><div class="ttname"><a href="a00243.html#ae1e7a56e3c7a62d1738c7f8cb4fed667">CO_COBRA_Lang_Common\$cobra_error_code_user_not_authorized</a></div><div class="ttdeci">static $cobra_error_code_user_not_authorized</div><div class="ttdef"><b>Definition:</b> <a href="a00376_source.html#l00047">common.inc.php:47</a></div></div>
<div class="ttc" id="aa00247_html_a5d67fdf6a1f3dea95d6c1ecc17732f93"><div class="ttname"><a href="a00247.html#a5d67fdf6a1f3dea95d6c1ecc17732f93">CO_COBRA_Lang\$cobra_error_name_user_already_exists</a></div><div class="ttdeci">static $cobra_error_name_user_already_exists</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00039">en.php:39</a></div></div>
<div class="ttc" id="aa00247_html_a7cba01e9c902162db9f2473c39141b2e"><div class="ttname"><a href="a00247.html#a7cba01e9c902162db9f2473c39141b2e">CO_COBRA_Lang\$cobra_error_desc_login_unavailable</a></div><div class="ttdeci">static $cobra_error_desc_login_unavailable</div><div class="ttdef"><b>Definition:</b> <a href="a00391_source.html#l00042">en.php:42</a></div></div>
